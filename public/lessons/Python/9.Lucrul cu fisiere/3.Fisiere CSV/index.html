<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c15 doc-content">
    <h1 class="c1 c14">Fi»ôiere CSV.</h1>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c4">Unul dintre formatele de fi&#537;iere frecvent utilizate pentru stocarea
            informa&#539;iilor &icirc;ntr-un mod convenabil este formatul </span><span class="c12">CSV</span><span
            class="c3">. Fiecare linie dintr-un fi&#537;ier CSV reprezint&#259; o &icirc;nregistrare sau un r&acirc;nd
            separat, care const&#259; din coloane individuale, separate prin virgule. De aceea, formatul este numit
            Comma Separated Values. De&#537;i formatul CSV este un format de fi&#537;iere text, Python, pentru a
            facilita lucrul cu acesta, ofer&#259; un modul &icirc;ncorporat special numit csv.</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c3">S&#259; analiz&#259;m utilizarea acestui modul printr-un exemplu:</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <table class="c5">
        <tr class="c2">
            <td class="c13" colspan="1" rowspan="1">
                <p class="c10"><span class="c8">import</span><span class="c0">&nbsp;csv<br> <br>FILENAME = </span><span
                        class="c6">&quot;users.csv&quot;</span><span class="c0"><br> <br>users = [<br> &nbsp;
                        &nbsp;[</span><span class="c6">&quot;Tom&quot;</span><span class="c0">, </span><span
                        class="c11">28</span><span class="c0">],<br> &nbsp; &nbsp;[</span><span
                        class="c6">&quot;Alice&quot;</span><span class="c0">, </span><span class="c11">23</span><span
                        class="c0">],<br> &nbsp; &nbsp;[</span><span class="c6">&quot;Bob&quot;</span><span class="c0">,
                    </span><span class="c11">34</span><span class="c0">]<br>]<br> <br></span><span
                        class="c8">with</span><span class="c0">&nbsp;open(FILENAME, </span><span
                        class="c6">&quot;w&quot;</span><span class="c0">, newline=</span><span
                        class="c6">&quot;&quot;</span><span class="c0">) </span><span class="c8">as</span><span
                        class="c0">&nbsp;file:<br> &nbsp; &nbsp;writer = csv.writer(file)<br> &nbsp;
                        &nbsp;writer.writerows(users)<br> &nbsp; &nbsp; <br></span><span class="c8">with</span><span
                        class="c0">&nbsp;open(FILENAME, </span><span class="c6">&quot;a&quot;</span><span class="c0">,
                        newline=</span><span class="c6">&quot;&quot;</span><span class="c0">) </span><span
                        class="c8">as</span><span class="c0">&nbsp;file:<br> &nbsp; &nbsp;user = [</span><span
                        class="c6">&quot;Sam&quot;</span><span class="c0">, </span><span class="c11">31</span><span
                        class="c0">]<br> &nbsp; &nbsp;writer = csv.writer(file)<br> &nbsp;
                        &nbsp;writer.writerow(user)</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c3">&Icirc;n fi&#537;ier se &icirc;nregistreaz&#259; o list&#259; bidimensional&#259; -
            practic un tabel, unde fiecare r&acirc;nd reprezint&#259; un utilizator. Fiecare utilizator con&#539;ine
            dou&#259; c&acirc;mpuri: nume &#537;i v&acirc;rst&#259;. Deci, practic, avem un tabel format din trei
            r&acirc;nduri &#537;i dou&#259; coloane.</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c4">La deschiderea fi&#537;ierului pentru scriere, ca al treilea parametru, se
            specific&#259; valoarea</span><span class="c4 c7">&nbsp;newline=&quot;&quot;</span><span class="c3">&nbsp;-
            un &#537;ir gol care permite citirea corect&#259; a r&acirc;ndurilor din fi&#537;ier, indiferent de sistemul
            de operare.</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c4">Pentru a scrie, trebuie s&#259; ob&#539;inem un obiect </span><span
            class="c12">writer</span><span class="c4">, care este returnat de func&#539;ia </span><span
            class="c4 c7">csv.writer(file)</span><span class="c4">. &Icirc;n aceast&#259; func&#539;ie se transmite
            fi&#537;ierul deschis. Scrierea propriu-zis&#259; se face prin metoda</span><span
            class="c4 c7">&nbsp;writer.writerows(users)</span><span class="c3">. Aceast&#259; metod&#259; prime&#537;te
            un set de r&acirc;nduri. &Icirc;n cazul nostru, este vorba de o list&#259; bidimensional&#259;.</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c4">Dac&#259; trebuie s&#259; ad&#259;ug&#259;m un singur r&acirc;nd, care
            reprezint&#259; o list&#259; unidimensional&#259;, de exemplu,</span><span
            class="c4 c7">&nbsp;[&quot;Sam&quot;, 31]</span><span class="c4">, putem apela metoda </span><span
            class="c12">writer.writerow(user)</span><span class="c3">.</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c3">&Icirc;n final, dup&#259; rularea scriptului, &icirc;n acela&#537;i director va
            ap&#259;rea fi&#537;ierul users.csv, care va avea urm&#259;torul con&#539;inut:</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <table class="c5">
        <tr class="c2">
            <td class="c13" colspan="1" rowspan="1">
                <p class="c10"><span class="c0">Tom,</span><span class="c11">28</span><span
                        class="c0"><br>Alice,</span><span class="c11">23</span><span class="c0"><br>Bob,</span><span
                        class="c11">34</span><span class="c0"><br>Sam,</span><span class="c11">31</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Pentru citirea din fi&#537;ier, trebuie s&#259; cre&#259;m un obiect reader:</span>
    </p>
    <p class="c1 c9"><span class="c3"></span></p>
    <table class="c5">
        <tr class="c2">
            <td class="c13" colspan="1" rowspan="1">
                <p class="c10"><span class="c8">import</span><span class="c0">&nbsp;csv<br> <br>FILENAME = </span><span
                        class="c6">&quot;users.csv&quot;</span><span class="c0"><br> <br></span><span
                        class="c8">with</span><span class="c0">&nbsp;open(FILENAME, </span><span
                        class="c6">&quot;r&quot;</span><span class="c0">, newline=</span><span
                        class="c6">&quot;&quot;</span><span class="c0">) </span><span class="c8">as</span><span
                        class="c0">&nbsp;file:<br> &nbsp; &nbsp;reader = csv.reader(file)<br> &nbsp; &nbsp;</span><span
                        class="c8">for</span><span class="c0">&nbsp;row </span><span class="c8">in</span><span
                        class="c0">&nbsp;reader:<br> &nbsp; &nbsp; &nbsp; &nbsp;print(row[</span><span
                        class="c11">0</span><span class="c0">], </span><span class="c6">&quot; - &quot;</span><span
                        class="c0">, row[</span><span class="c11">1</span><span class="c0">])</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Dup&#259; ob&#539;inerea obiectului reader, putem itera prin toate r&acirc;ndurile
            sale:</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <table class="c5">
        <tr class="c2">
            <td class="c13" colspan="1" rowspan="1">
                <p class="c10"><span class="c0">Tom &nbsp;- &nbsp;</span><span class="c11">28</span><span
                        class="c0"><br>Alice &nbsp;- &nbsp;</span><span class="c11">23</span><span class="c0"><br>Bob
                        &nbsp;- &nbsp;</span><span class="c11">34</span><span class="c0"><br>Sam - </span><span
                        class="c11">31</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c17">Lucrul cu dic&#539;ionare.</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c4">&Icirc;n exemplul de mai sus, fiecare &icirc;nregistrare sau r&acirc;nd reprezenta o
            list&#259; separat&#259;, de exemplu,</span><span class="c4 c7">&nbsp;[&quot;Sam&quot;, 31]</span><span
            class="c4">. Cu toate acestea, modulul csv ofer&#259; func&#539;ionalit&#259;&#539;i suplimentare pentru
            lucrul cu dic&#539;ionare. &Icirc;n special, func&#539;ia </span><span class="c12">csv.DictWriter()
        </span><span class="c4">returneaz&#259; un obiect writer care permite scrierea &icirc;n fi&#537;ier, iar
            func&#539;ia </span><span class="c12">csv.DictReader() </span><span class="c3">returneaz&#259; un obiect
            reader pentru citirea din fi&#537;ier. De exemplu:</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <table class="c5">
        <tr class="c2">
            <td class="c13" colspan="1" rowspan="1">
                <p class="c10"><span class="c8">import</span><span class="c0">&nbsp;csv<br> <br>FILENAME = </span><span
                        class="c6">&quot;users2.csv&quot;</span><span class="c0"><br> <br>users = [<br> &nbsp;
                        &nbsp;{</span><span class="c6">&quot;name&quot;</span><span class="c0">: </span><span
                        class="c6">&quot;Tom&quot;</span><span class="c0">, </span><span
                        class="c6">&quot;age&quot;</span><span class="c0">: </span><span class="c11">28</span><span
                        class="c0">},<br> &nbsp; &nbsp;{</span><span class="c6">&quot;name&quot;</span><span
                        class="c0">: </span><span class="c6">&quot;Alice&quot;</span><span class="c0">, </span><span
                        class="c6">&quot;age&quot;</span><span class="c0">: </span><span class="c11">23</span><span
                        class="c0">},<br> &nbsp; &nbsp;{</span><span class="c6">&quot;name&quot;</span><span
                        class="c0">: </span><span class="c6">&quot;Bob&quot;</span><span class="c0">, </span><span
                        class="c6">&quot;age&quot;</span><span class="c0">: </span><span class="c11">34</span><span
                        class="c0">}<br>]<br> <br></span><span class="c8">with</span><span
                        class="c0">&nbsp;open(FILENAME, </span><span class="c6">&quot;w&quot;</span><span class="c0">,
                        newline=</span><span class="c6">&quot;&quot;</span><span class="c0">) </span><span
                        class="c8">as</span><span class="c0">&nbsp;file:<br> &nbsp; &nbsp;columns = [</span><span
                        class="c6">&quot;name&quot;</span><span class="c0">, </span><span
                        class="c6">&quot;age&quot;</span><span class="c0">]<br> &nbsp; &nbsp;writer =
                        csv.DictWriter(file, fieldnames=columns)<br> &nbsp; &nbsp;writer.writeheader()<br> &nbsp; &nbsp;
                        <br> &nbsp; &nbsp;</span><span class="c16"># scrierea mai multor r&acirc;nduri</span><span
                        class="c0"><br> &nbsp; &nbsp;writer.writerows(users)<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;user =
                        {</span><span class="c6">&quot;name&quot;</span><span class="c0">&nbsp;: </span><span
                        class="c6">&quot;Sam&quot;</span><span class="c0">, </span><span
                        class="c6">&quot;age&quot;</span><span class="c0">: </span><span class="c11">41</span><span
                        class="c0">}<br> &nbsp; &nbsp;</span><span class="c16"># scrierea unui singur
                        r&acirc;nd</span><span class="c0"><br> &nbsp; &nbsp;writer.writerow(user)<br> <br></span><span
                        class="c8">with</span><span class="c0">&nbsp;open(FILENAME, </span><span
                        class="c6">&quot;r&quot;</span><span class="c0">, newline=</span><span
                        class="c6">&quot;&quot;</span><span class="c0">) </span><span class="c8">as</span><span
                        class="c0">&nbsp;file:<br> &nbsp; &nbsp;reader = csv.DictReader(file)<br> &nbsp;
                        &nbsp;</span><span class="c8">for</span><span class="c0">&nbsp;row </span><span
                        class="c8">in</span><span class="c0">&nbsp;reader:<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;print(row[</span><span class="c6">&quot;name&quot;</span><span class="c0">], </span><span
                        class="c6">&quot;-&quot;</span><span class="c0">, row[</span><span
                        class="c6">&quot;age&quot;</span><span class="c0">])</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c4">Scrierea r&acirc;ndurilor se face tot prin metodele</span><span
            class="c12">&nbsp;writerow() </span><span class="c4">&#537;i </span><span
            class="c12">writerows()</span><span class="c4">. Dar acum, fiecare r&acirc;nd reprezint&#259; un
            dic&#539;ionar separat &#537;i, &icirc;n plus, se scriu &#537;i anteturile coloanelor cu ajutorul metodei
        </span><span class="c12">writeheader()</span><span class="c4">, iar &icirc;n metoda</span><span
            class="c4 c7">&nbsp;csv.DictWriter</span><span class="c3">&nbsp;se transmite ca al doilea parametru setul de
            coloane.</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
    <p class="c1"><span class="c4">La citirea r&acirc;ndurilor, folosind numele coloanelor, putem accesa valorile
            individuale dintr-un r&acirc;nd: </span><span class="c4 c7">row[&quot;name&quot;]</span><span
            class="c3">.</span></p>
    <p class="c1 c9"><span class="c3"></span></p>
</body>

</html>