<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c16 doc-content">
    <h1 class="c2 c17">Crearea și execuția firelor de execuție.</h1>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c11">Pentru a crea un nou fir de execu&#539;ie, putem crea o nou&#259; clas&#259; fie
            mo&#537;tenind-o de la clasa Thread, fie implement&acirc;nd &icirc;n clas&#259; interfa&#539;a </span><span
            class="c8">Runnable</span><span class="c0">.</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c13">Mo&#537;tenirea de la clasa Thread.</span></p>
    <p class="c2"><span class="c0">&nbsp;</span></p>
    <p class="c2"><span class="c0">S&#259; cre&#259;m propria clas&#259; pe baza clasei Thread:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">class</span><span class="c6">&nbsp;</span><span
                        class="c4">JThread</span><span class="c6">&nbsp;</span><span class="c1">extends</span><span
                        class="c6">&nbsp;</span><span class="c4">Thread</span><span class="c6">&nbsp;{<br> &nbsp; &nbsp;
                        &nbsp;<br> &nbsp; &nbsp;JThread(String name){<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c1">super</span><span class="c6">(name);<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp;<br>
                        &nbsp; &nbsp;</span><span class="c1">public</span><span class="c6">&nbsp;</span><span
                        class="c1">void</span><span class="c6">&nbsp;</span><span class="c4">run</span><span
                        class="c6">(){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.printf(</span><span class="c3">&quot;%s started... \n&quot;</span><span
                        class="c6">, Thread.currentThread().getName());<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c1">try</span><span class="c6">{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;Thread.sleep(</span><span class="c9">500</span><span class="c6">);<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">catch</span><span
                        class="c6">(InterruptedException e){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(</span><span class="c3">&quot;Thread has been
                        interrupted&quot;</span><span class="c6">);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;System.out.printf(</span><span class="c3">&quot;%s finished... \n&quot;</span><span
                        class="c6">, Thread.currentThread().getName());<br> &nbsp; &nbsp;}<br>}<br>
                        &nbsp;<br></span><span class="c1">public</span><span class="c6">&nbsp;</span><span
                        class="c1">class</span><span class="c6">&nbsp;</span><span class="c4">Program</span><span
                        class="c6">&nbsp;{<br> &nbsp;<br> &nbsp; &nbsp;</span><span class="c1">public</span><span
                        class="c6">&nbsp;</span><span class="c1">static</span><span class="c6">&nbsp;</span><span
                        class="c1">void</span><span class="c6">&nbsp;</span><span class="c4">main</span><span
                        class="c6">(String[] args) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(</span><span class="c3">&quot;Main thread started...&quot;</span><span
                        class="c6">);<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">new</span><span
                        class="c6">&nbsp;JThread(</span><span class="c3">&quot;JThread&quot;</span><span
                        class="c6">).start();<br> &nbsp; &nbsp; &nbsp; &nbsp;System.out.println(</span><span
                        class="c3">&quot;Main thread finished...&quot;</span><span class="c6">);<br> &nbsp;
                        &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Clasa firului de execu&#539;ie se nume&#537;te JThread. Se presupune c&#259; &icirc;n
            constructorul clasei se transmite numele firului, care apoi este transmis &icirc;n constructorul clasei de
            baz&#259;. &Icirc;n constructorul propriei clase de fir, putem transmite diverse date, dar principalul este
            s&#259; apel&#259;m constructorul clasei de baz&#259; Thread, &icirc;n care se transmite numele
            firului.</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c11">De asemenea, &icirc;n JThread se suprascrie metoda </span><span
            class="c8">run()</span><span class="c0">, al c&#259;rei cod va reprezenta codul ce se execut&#259; &icirc;n
            fir.</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c11">&Icirc;n metoda main, pentru a porni firul JThread, se apeleaz&#259; metoda
        </span><span class="c8">start()</span><span class="c0">, dup&#259; care &icirc;ncepe execu&#539;ia codului
            definit &icirc;n metoda run:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">new</span><span class="c6">&nbsp;JThread(</span><span
                        class="c3">&quot;JThread&quot;</span><span class="c6">).start();</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Ie&#537;irea &icirc;n consol&#259;:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c6">Main thread started...<br>Main thread finished...<br>JThread started...
                        <br>JThread finished...</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c11">Aici, &icirc;n metoda main, &icirc;n constructorul JThread se transmite un nume
            arbitrar al firului, iar apoi se apeleaz&#259; metoda</span><span class="c11 c15">&nbsp;start()</span><span
            class="c11">. Aceast&#259; metod&#259; invoc&#259; de fapt metoda suprascris&#259;</span><span
            class="c11 c15">&nbsp;run()</span><span class="c0">&nbsp;a clasei JThread.</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Observa&#539;i c&#259; firul principal &icirc;&#537;i termin&#259; execu&#539;ia mai
            devreme dec&acirc;t firul fiu JThread.</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Similar cu crearea unui fir, putem porni mai multe fire simultan:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">public</span><span class="c6">&nbsp;</span><span
                        class="c1">static</span><span class="c6">&nbsp;</span><span class="c1">void</span><span
                        class="c6">&nbsp;</span><span class="c4">main</span><span class="c6">(String[] args) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp;System.out.println(</span><span
                        class="c3">&quot;Main thread started...&quot;</span><span class="c6">);<br> &nbsp;
                        &nbsp;</span><span class="c1">for</span><span class="c6">(</span><span
                        class="c1">int</span><span class="c6">&nbsp;i=</span><span class="c9">1</span><span class="c6">;
                        i &lt; </span><span class="c9">6</span><span class="c6">; i++)<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c1">new</span><span class="c6">&nbsp;JThread(</span><span
                        class="c3">&quot;JThread &quot;</span><span class="c6">&nbsp;+ i).start();<br> &nbsp;
                        &nbsp;System.out.println(</span><span class="c3">&quot;Main thread finished...&quot;</span><span
                        class="c6">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Ie&#537;irea &icirc;n consol&#259;:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c6">Main thread started...<br>Main thread finished...<br>JThread
                    </span><span class="c9">2</span><span class="c6">&nbsp;started... <br>JThread </span><span
                        class="c9">5</span><span class="c6">&nbsp;started... <br>JThread </span><span
                        class="c9">4</span><span class="c6">&nbsp;started... <br>JThread </span><span
                        class="c9">1</span><span class="c6">&nbsp;started... <br>JThread </span><span
                        class="c9">3</span><span class="c6">&nbsp;started... <br>JThread </span><span
                        class="c9">1</span><span class="c6">&nbsp;finished... <br>JThread </span><span
                        class="c9">2</span><span class="c6">&nbsp;finished... <br>JThread </span><span
                        class="c9">5</span><span class="c6">&nbsp;finished... <br>JThread </span><span
                        class="c9">4</span><span class="c6">&nbsp;finished... <br>JThread </span><span
                        class="c9">3</span><span class="c6">&nbsp;finished...</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c13">A&#537;teptarea finaliz&#259;rii firului.</span></p>
    <p class="c2"><span class="c0">&nbsp; </span></p>
    <p class="c2"><span class="c11">&Icirc;n exemplele de mai sus, Main thread se termina &icirc;naintea firului fiu.
            &Icirc;n general, o situa&#539;ie mai comun&#259; este c&acirc;nd firul principal se termin&#259; ultimul.
            Pentru aceasta, trebuie s&#259; aplic&#259;m metoda </span><span class="c8">join()</span><span class="c0">.
            &Icirc;n acest caz, firul curent va a&#537;tepta finalizarea firului pentru care se apeleaz&#259; metoda
            join:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">public</span><span class="c6">&nbsp;</span><span
                        class="c1">static</span><span class="c6">&nbsp;</span><span class="c1">void</span><span
                        class="c6">&nbsp;</span><span class="c4">main</span><span class="c6">(String[] args) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp;System.out.println(</span><span
                        class="c3">&quot;Main thread started...&quot;</span><span class="c6">);<br> &nbsp; &nbsp;JThread
                        t = </span><span class="c1">new</span><span class="c6">&nbsp;JThread(</span><span
                        class="c3">&quot;JThread &quot;</span><span class="c6">);<br> &nbsp; &nbsp;t.start();<br> &nbsp;
                        &nbsp;</span><span class="c1">try</span><span class="c6">{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;t.join(); <br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c1">catch</span><span
                        class="c6">(InterruptedException e){<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.printf(</span><span class="c3">&quot;%s has been interrupted&quot;</span><span
                        class="c6">, t.getName());<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;System.out.println(</span><span
                        class="c3">&quot;Main thread finished...&quot;</span><span class="c6">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c11">Metoda</span><span class="c11 c15">&nbsp;join()</span><span class="c0">&nbsp;face ca
            firul care o apeleaz&#259; (&icirc;n acest caz, Main thread) s&#259; a&#537;tepte finalizarea firului pentru
            care se aplic&#259; join (&icirc;n acest caz, JThread).</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Ie&#537;irea &icirc;n consol&#259;:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c6">Main thread started...<br>JThread started... <br>JThread finished...
                        <br>Main thread finished...</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c11">Dac&#259; &icirc;n program sunt utilizate mai multe fire fiu, iar firul principal
            trebuie s&#259; se termine dup&#259; acestea, pentru fiecare fir fiu trebuie s&#259; apel&#259;m metoda
        </span><span class="c11 c15">join</span><span class="c0">.</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c13">Implementarea interfe&#539;ei Runnable.</span></p>
    <p class="c2"><span class="c0">&nbsp; </span></p>
    <p class="c2"><span class="c11">O alt&#259; modalitate de a defini un fir este prin implementarea interfe&#539;ei
        </span><span class="c8">Runnable</span><span class="c11">. Aceast&#259; interfa&#539;&#259; are o singur&#259;
            metod&#259; </span><span class="c8">run</span><span class="c0">:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">interface</span><span class="c6">&nbsp;</span><span
                        class="c4">Runnable</span><span class="c6">{<br> &nbsp; &nbsp;</span><span
                        class="c1">void</span><span class="c6">&nbsp;</span><span class="c4">run</span><span
                        class="c6">();<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c11">&Icirc;n metoda</span><span class="c11 c15">&nbsp;run()</span><span class="c0">, se
            define&#537;te de fapt codul care se execut&#259; la pornirea firului.</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Dup&#259; definirea obiectului Runnable, acesta este transmis unui constructor al
            clasei Thread:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c6">Thread(Runnable runnable, String threadName)</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Pentru implementarea interfe&#539;ei, s&#259; definim urm&#259;toarea clas&#259;
            MyThread:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">class</span><span class="c6">&nbsp;</span><span
                        class="c4">MyThread</span><span class="c6">&nbsp;</span><span class="c1">implements</span><span
                        class="c6">&nbsp;</span><span class="c4">Runnable</span><span class="c6">&nbsp;{<br> &nbsp;
                        &nbsp; &nbsp;<br> &nbsp; &nbsp;</span><span class="c1">public</span><span
                        class="c6">&nbsp;</span><span class="c1">void</span><span class="c6">&nbsp;</span><span
                        class="c4">run</span><span class="c6">(){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;System.out.printf(</span><span class="c3">&quot;%s started...
                        \n&quot;</span><span class="c6">, Thread.currentThread().getName());<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c1">try</span><span class="c6">{<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;Thread.sleep(</span><span class="c9">500</span><span class="c6">);<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">catch</span><span
                        class="c6">(InterruptedException e){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(</span><span class="c3">&quot;Thread has been
                        interrupted&quot;</span><span class="c6">);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;System.out.printf(</span><span class="c3">&quot;%s finished... \n&quot;</span><span
                        class="c6">, Thread.currentThread().getName());<br> &nbsp; &nbsp;}<br>} <br>
                        &nbsp;<br></span><span class="c1">public</span><span class="c6">&nbsp;</span><span
                        class="c1">class</span><span class="c6">&nbsp;</span><span class="c4">Program</span><span
                        class="c6">&nbsp;{<br> &nbsp;<br> &nbsp; &nbsp;</span><span class="c1">public</span><span
                        class="c6">&nbsp;</span><span class="c1">static</span><span class="c6">&nbsp;</span><span
                        class="c1">void</span><span class="c6">&nbsp;</span><span class="c4">main</span><span
                        class="c6">(String[] args) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(</span><span class="c3">&quot;Main thread started...&quot;</span><span
                        class="c6">);<br> &nbsp; &nbsp; &nbsp; &nbsp;Thread myThread = </span><span
                        class="c1">new</span><span class="c6">&nbsp;Thread(</span><span class="c1">new</span><span
                        class="c6">&nbsp;MyThread(),</span><span class="c3">&quot;MyThread&quot;</span><span
                        class="c6">);<br> &nbsp; &nbsp; &nbsp; &nbsp;myThread.start();<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(</span><span class="c3">&quot;Main thread finished...&quot;</span><span
                        class="c6">);<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Implementarea interfe&#539;ei Runnable este foarte asem&#259;n&#259;toare cu
            suprascrierea clasei Thread. De asemenea, &icirc;n metoda run se define&#537;te codul care suspend&#259;
            firul pentru 500 de milisecunde.</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c11">&Icirc;n metoda main se apeleaz&#259; constructorul Thread, c&#259;ruia i se
            transmite obiectul MyThread. &#536;i pentru a porni firul, se apeleaz&#259; metoda </span><span
            class="c11 c15">start()</span><span class="c0">. &Icirc;n final, consola va afi&#537;a ceva de genul:</span>
    </p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c6">Main thread started...<br>Main thread finished...<br>MyThread started...
                        <br>MyThread finished...</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Deoarece Runnable reprezint&#259; de fapt o interfa&#539;&#259;
            func&#539;ional&#259;, care define&#537;te o singur&#259; metod&#259;, obiectul acestei interfe&#539;e poate
            fi reprezentat sub forma unei expresii lambda:</span></p>
    <p class="c2 c7"><span class="c0"></span></p>
    <table class="c10">
        <tr class="c5">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">public</span><span class="c6">&nbsp;</span><span
                        class="c1">class</span><span class="c6">&nbsp;</span><span class="c4">Program</span><span
                        class="c6">&nbsp;{<br> &nbsp;<br> &nbsp; &nbsp;</span><span class="c1">public</span><span
                        class="c6">&nbsp;</span><span class="c1">static</span><span class="c6">&nbsp;</span><span
                        class="c1">void</span><span class="c6">&nbsp;</span><span class="c4">main</span><span
                        class="c6">(String[] args) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(</span><span class="c3">&quot;Main thread started...&quot;</span><span
                        class="c6">);<br> &nbsp; &nbsp; &nbsp; &nbsp;Runnable r = ()-&gt;{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;System.out.printf(</span><span class="c3">&quot;%s started...
                        \n&quot;</span><span class="c6">, Thread.currentThread().getName());<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c1">try</span><span class="c6">{<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Thread.sleep(</span><span class="c9">500</span><span
                        class="c6">);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c1">catch</span><span class="c6">(InterruptedException e){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.out.println(</span><span
                        class="c3">&quot;Thread has been interrupted&quot;</span><span class="c6">);<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.printf(</span><span class="c3">&quot;%s finished... \n&quot;</span><span
                        class="c6">, Thread.currentThread().getName());<br> &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;Thread myThread = </span><span class="c1">new</span><span
                        class="c6">&nbsp;Thread(r,</span><span class="c3">&quot;MyThread&quot;</span><span
                        class="c6">);<br> &nbsp; &nbsp; &nbsp; &nbsp;myThread.start();<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(</span><span class="c3">&quot;Main thread finished...&quot;</span><span
                        class="c6">);<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c7"><span class="c0"></span></p>
    <p class="c2 c7"><span class="c0"></span></p>
</body>

</html>