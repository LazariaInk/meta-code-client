<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c17 doc-content">
    <h1 class="c11 c10">Interfețele Comparable și Comparator. Sortare.</h1>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">&Icirc;n tema anterioar&#259; am discutat despre func&#539;ionarea colec&#539;iei
            TreeSet, tipizat&#259; cu obiecte de tip String. La ad&#259;ugarea de noi elemente, TreeSet sorteaz&#259;
            automat obiectele, plas&acirc;ndu-le &icirc;n ordinea corect&#259;. Cu &#537;iruri de caractere, acest lucru
            este simplu. Dar ce se &icirc;nt&acirc;mpl&#259; dac&#259; folosim propriile noastre clase, cum ar fi
            urm&#259;toarea clas&#259; Person?</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c1">class</span><span class="c0">&nbsp;</span><span
                        class="c3">Person</span><span class="c0">&nbsp;{<br> &nbsp; &nbsp; &nbsp;<br> &nbsp;
                        &nbsp;</span><span class="c1">private</span><span class="c0">&nbsp;String name;<br> &nbsp;
                        &nbsp;Person(String name){<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c1">this</span><span class="c0">.name = name;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;String
                    </span><span class="c3">getName</span><span class="c0">() {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c1">return</span><span class="c0">&nbsp;name;<br> &nbsp;
                        &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">Nu putem tipiza un obiect TreeSet cu aceast&#259; clas&#259;, deoarece, atunci
            c&acirc;nd ad&#259;ug&#259;m obiecte, TreeSet nu va &#537;ti cum s&#259; le compare, &#537;i urm&#259;torul
            cod nu va func&#539;iona:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c0">TreeSet&lt;Person&gt; people = </span><span class="c1">new</span><span
                        class="c0">&nbsp;TreeSet&lt;Person&gt;();<br>people.add(</span><span class="c1">new</span><span
                        class="c0">&nbsp;Person(</span><span class="c8">&quot;Tom&quot;</span><span
                        class="c0">));</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">La rularea acestui cod, vom &icirc;nt&acirc;lni o eroare care spune c&#259; obiectul
            Person nu poate fi convertit &icirc;n tipul java.lang.Comparable.</span></p>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c6">Pentru ca obiectele Person s&#259; poat&#259; fi comparate &#537;i sortate, ele
            trebuie s&#259; implementeze interfa&#539;a </span><span class="c16">Comparable&lt;E&gt;</span><span
            class="c4">. Aceasta va fi tipizat&#259; cu clasa curent&#259;. Aplic&#259;m interfa&#539;a clasei Person
            astfel:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c1">class</span><span class="c0">&nbsp;</span><span
                        class="c3">Person</span><span class="c0">&nbsp;</span><span class="c1">implements</span><span
                        class="c0">&nbsp;</span><span class="c3">Comparable</span><span class="c0">&lt;</span><span
                        class="c3">Person</span><span class="c0">&gt; {<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c1">private</span><span class="c0">&nbsp;String name;<br> &nbsp; &nbsp;Person(String
                        name) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">this</span><span class="c0">.name
                        = name;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;String </span><span class="c3">getName</span><span
                        class="c0">() {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">return</span><span
                        class="c0">&nbsp;name;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c1">public</span><span class="c0">&nbsp;</span><span class="c1">int</span><span
                        class="c0">&nbsp;</span><span class="c3">compareTo</span><span class="c0">(Person p) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">return</span><span
                        class="c0">&nbsp;name.compareTo(p.getName());<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c6">Interfa&#539;a Comparable con&#539;ine o singur&#259; metod&#259;</span><span
            class="c6 c13">: int compareTo(E item)</span><span class="c4">, care compar&#259; obiectul curent cu
            obiectul transmis ca parametru. Dac&#259; metoda returneaz&#259; un num&#259;r negativ, obiectul curent va
            fi plasat &icirc;naintea celui transmis. Dac&#259; returneaz&#259; un num&#259;r pozitiv, va fi plasat
            dup&#259; acesta. Dac&#259; returneaz&#259; zero, cele dou&#259; obiecte sunt considerate egale.</span></p>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">&Icirc;n acest caz, ne baz&#259;m pe mecanismul de comparare integrat al clasei
            String, dar putem defini propria logic&#259;, de exemplu, compar&acirc;nd &icirc;n func&#539;ie de lungimea
            numelui:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c1">public</span><span class="c0">&nbsp;</span><span
                        class="c1">int</span><span class="c0">&nbsp;</span><span class="c3">compareTo</span><span
                        class="c0">(Person p) {<br> &nbsp; &nbsp;</span><span class="c1">return</span><span
                        class="c0">&nbsp;name.length() - p.getName().length();<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">Acum putem tipiza TreeSet cu tipul Person &#537;i ad&#259;uga obiecte &icirc;n
            arbore:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c0">TreeSet&lt;Person&gt; people = </span><span class="c1">new</span><span
                        class="c0">&nbsp;TreeSet&lt;Person&gt;();<br>people.add(</span><span class="c1">new</span><span
                        class="c0">&nbsp;Person(</span><span class="c8">&quot;Tom&quot;</span><span
                        class="c0">));</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c14">Interfa&#539;a Comparator.</span></p>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">Problema apare atunci c&acirc;nd clasa pe care dorim s&#259; o folosim nu
            implementeaz&#259; interfa&#539;a Comparable, sau c&acirc;nd dorim s&#259; redefinim logica de comparare.
            &Icirc;n acest caz, putem folosi interfa&#539;a Comparator&lt;E&gt;, care este mai flexibil&#259;.</span>
    </p>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c6">Interfa&#539;a Comparator con&#539;ine metoda cheie </span><span
            class="c16">compare()</span><span class="c4">:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c1">public</span><span class="c0">&nbsp;</span><span
                        class="c1">interface</span><span class="c0">&nbsp;</span><span class="c3">Comparator</span><span
                        class="c0">&lt;</span><span class="c3">E</span><span class="c0">&gt; {<br> &nbsp;
                        &nbsp;</span><span class="c1">int</span><span class="c0">&nbsp;</span><span
                        class="c3">compare</span><span class="c0">(T a, T b);<br> &nbsp; &nbsp;</span><span
                        class="c18">// alte metode</span><span class="c0"><br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c6">Metoda </span><span class="c6 c13">compare()</span><span
            class="c4">&nbsp;returneaz&#259; un num&#259;r: negativ dac&#259; obiectul a precede b, pozitiv dac&#259;
            &icirc;l urmeaz&#259;, iar zero dac&#259; sunt egale. Pentru a aplica aceast&#259; interfa&#539;&#259;,
            cre&#259;m o clas&#259; care implementeaz&#259; Comparator:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15"></tr>
    </table>
    <p class="c9 c19"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c1">class</span><span class="c0">&nbsp;</span><span
                        class="c3">PersonComparator</span><span class="c0">&nbsp;</span><span
                        class="c1">implements</span><span class="c0">&nbsp;</span><span
                        class="c3">Comparator</span><span class="c0">&lt;</span><span class="c3">Person</span><span
                        class="c0">&gt; {<br> &nbsp; &nbsp;</span><span class="c1">public</span><span
                        class="c0">&nbsp;</span><span class="c1">int</span><span class="c0">&nbsp;</span><span
                        class="c3">compare</span><span class="c0">(Person a, Person b) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c1">return</span><span
                        class="c0">&nbsp;a.getName().compareTo(b.getName());<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">Apoi, folosim clasa comparator pentru a crea un TreeSet:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c0">PersonComparator pcomp = </span><span class="c1">new</span><span
                        class="c0">&nbsp;PersonComparator();<br>TreeSet&lt;Person&gt; people = </span><span
                        class="c1">new</span><span
                        class="c0">&nbsp;TreeSet&lt;Person&gt;(pcomp);<br>people.add(</span><span
                        class="c1">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Tom&quot;</span><span class="c0">));<br>people.add(</span><span
                        class="c1">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Nick&quot;</span><span class="c0">));<br>people.add(</span><span
                        class="c1">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Alice&quot;</span><span class="c0">));<br>people.add(</span><span
                        class="c1">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Bill&quot;</span><span class="c0">));<br><br></span><span
                        class="c1">for</span><span class="c0">&nbsp;(Person p : people) {<br> &nbsp;
                        &nbsp;System.out.println(p.getName());<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">&Icirc;n acest caz, constructorul TreeSet prime&#537;te comparatorul ca parametru.
            Astfel, indiferent dac&#259; Person implementeaz&#259; sau nu interfa&#539;a Comparable, logica de comparare
            definit&#259; &icirc;n PersonComparator va fi utilizat&#259;.</span></p>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c14">Sortare dup&#259; mai multe criterii.</span></p>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">&Icirc;ncep&acirc;nd cu JDK 8, au fost introduse &icirc;mbun&#259;t&#259;&#539;iri
            &icirc;n mecanismul de func&#539;ionare al comparatorilor. De exemplu, acum putem aplica mai mul&#539;i
            comparatori &icirc;n lan&#539;. S&#259; modific&#259;m clasa Person pentru a include &#537;i
            v&acirc;rsta:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c1">class</span><span class="c0">&nbsp;</span><span
                        class="c3">Person</span><span class="c0">&nbsp;{<br> &nbsp; &nbsp; &nbsp;<br> &nbsp;
                        &nbsp;</span><span class="c1">private</span><span class="c0">&nbsp;String name;<br> &nbsp;
                        &nbsp;</span><span class="c1">private</span><span class="c0">&nbsp;</span><span
                        class="c1">int</span><span class="c0">&nbsp;age;<br> &nbsp; &nbsp;</span><span
                        class="c1">public</span><span class="c0">&nbsp;</span><span class="c3">Person</span><span
                        class="c0">(String n, </span><span class="c1">int</span><span class="c0">&nbsp;a) {<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;name = n;<br> &nbsp; &nbsp; &nbsp; &nbsp;age = a;<br> &nbsp; &nbsp;}<br>
                        &nbsp; &nbsp;String </span><span class="c3">getName</span><span class="c0">() {<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c1">return</span><span class="c0">&nbsp;name;<br> &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp;</span><span class="c1">int</span><span class="c0">&nbsp;</span><span
                        class="c3">getAge</span><span class="c0">() {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c1">return</span><span class="c0">&nbsp;age;<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">Vom defini doi comparatori: unul pentru nume &#537;i unul pentru
            v&acirc;rst&#259;:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c1">class</span><span class="c0">&nbsp;</span><span
                        class="c3">PersonNameComparator</span><span class="c0">&nbsp;</span><span
                        class="c1">implements</span><span class="c0">&nbsp;</span><span
                        class="c3">Comparator</span><span class="c0">&lt;</span><span class="c3">Person</span><span
                        class="c0">&gt; {<br> &nbsp; &nbsp;</span><span class="c1">public</span><span
                        class="c0">&nbsp;</span><span class="c1">int</span><span class="c0">&nbsp;</span><span
                        class="c3">compare</span><span class="c0">(Person a, Person b) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c1">return</span><span
                        class="c0">&nbsp;a.getName().compareTo(b.getName());<br> &nbsp; &nbsp;}<br>}<br><br></span><span
                        class="c1">class</span><span class="c0">&nbsp;</span><span
                        class="c3">PersonAgeComparator</span><span class="c0">&nbsp;</span><span
                        class="c1">implements</span><span class="c0">&nbsp;</span><span
                        class="c3">Comparator</span><span class="c0">&lt;</span><span class="c3">Person</span><span
                        class="c0">&gt; {<br> &nbsp; &nbsp;</span><span class="c1">public</span><span
                        class="c0">&nbsp;</span><span class="c1">int</span><span class="c0">&nbsp;</span><span
                        class="c3">compare</span><span class="c0">(Person a, Person b) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c1">if</span><span class="c0">&nbsp;(a.getAge() &gt; b.getAge()) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">return</span><span
                        class="c0">&nbsp;</span><span class="c2">1</span><span class="c0">;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;} </span><span class="c1">else</span><span class="c0">&nbsp;</span><span
                        class="c1">if</span><span class="c0">&nbsp;(a.getAge() &lt; b.getAge()) {<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">return</span><span
                        class="c0">&nbsp;-</span><span class="c2">1</span><span class="c0">;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;} </span><span class="c1">else</span><span class="c0">&nbsp;{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c1">return</span><span class="c0">&nbsp;</span><span
                        class="c2">0</span><span class="c0">;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c6">Interfa&#539;a comparator are o metod&#259; special&#259; </span><span
            class="c16">thenComparing</span><span class="c4">, care permite utilizarea mai multor comparatori &icirc;n
            lan&#539;:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c0">Comparator&lt;Person&gt; pcomp = </span><span class="c1">new</span><span
                        class="c0">&nbsp;PersonNameComparator().thenComparing(</span><span class="c1">new</span><span
                        class="c0">&nbsp;PersonAgeComparator());<br>TreeSet&lt;Person&gt; people = </span><span
                        class="c1">new</span><span class="c0">&nbsp;TreeSet(pcomp);<br>people.add(</span><span
                        class="c1">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Tom&quot;</span><span class="c0">, </span><span class="c2">23</span><span
                        class="c0">));<br>people.add(</span><span class="c1">new</span><span
                        class="c0">&nbsp;Person(</span><span class="c8">&quot;Nick&quot;</span><span class="c0">,
                    </span><span class="c2">34</span><span class="c0">));<br>people.add(</span><span
                        class="c1">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Tom&quot;</span><span class="c0">, </span><span class="c2">10</span><span
                        class="c0">));<br>people.add(</span><span class="c1">new</span><span
                        class="c0">&nbsp;Person(</span><span class="c8">&quot;Bill&quot;</span><span class="c0">,
                    </span><span class="c2">14</span><span class="c0">));<br><br></span><span class="c1">for</span><span
                        class="c0">&nbsp;(Person p : people) {<br> &nbsp; &nbsp;System.out.println(p.getName() +
                    </span><span class="c8">&quot; &quot;</span><span class="c0">&nbsp;+ p.getAge());<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">Rezultatul afi&#537;at &icirc;n consol&#259; va fi:</span></p>
    <p class="c5"><span class="c4"></span></p>
    <table class="c12">
        <tr class="c15">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c9"><span class="c0">Bill </span><span class="c2">14</span><span class="c0">&nbsp; <br>Nick
                    </span><span class="c2">34</span><span class="c0">&nbsp; <br>Tom </span><span
                        class="c2">10</span><span class="c0">&nbsp; <br>Tom </span><span class="c2">23</span></p>
            </td>
        </tr>
    </table>
    <p class="c5"><span class="c4"></span></p>
    <p class="c11"><span class="c4">&Icirc;n acest exemplu, mai &icirc;nt&acirc;i se aplic&#259; sortarea dup&#259;
            nume, iar apoi dup&#259; v&acirc;rst&#259;, dac&#259; numele sunt identice.</span></p>
    <p class="c5"><span class="c4"></span></p>
</body>

</html>