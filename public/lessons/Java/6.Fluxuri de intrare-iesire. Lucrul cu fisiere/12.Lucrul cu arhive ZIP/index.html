<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c16 doc-content">
    <h1 class="c6 c17">Lucrul cu arhive ZIP.</h1>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c2">Pe l&acirc;ng&#259; func&#539;ionalitatea general&#259; pentru lucrul cu
            fi&#537;iere, Java ofer&#259; func&#539;ionalit&#259;&#539;i pentru lucrul cu fi&#537;iere de tip
            zip-arhive. Pentru aceasta, &icirc;n pachetul java.util.zip sunt definite dou&#259; clase: </span><span
            class="c14">ZipInputStream </span><span class="c2">&#537;i </span><span
            class="c14">ZipOutputStream</span><span class="c0">.</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c13">ZipOutputStream. Scrierea arhivelor.</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c0">Pentru a crea o arhiv&#259;, se utilizeaz&#259; clasa ZipOutputStream. Pentru a crea
            un obiect ZipOutputStream, &icirc;n constructorul s&#259;u se transmite un flux de ie&#537;ire:</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <table class="c7">
        <tr class="c9">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c15"><span class="c4">ZipOutputStream(OutputStream out)</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c2">Pentru a scrie fi&#537;iere &icirc;n arhiv&#259;, pentru fiecare fi&#537;ier se
            creeaz&#259; un obiect </span><span class="c2 c10">ZipEntry</span><span class="c2">, &icirc;n constructorul
            c&#259;ruia se transmite numele fi&#537;ierului arhivat. Iar pentru a ad&#259;uga fiecare obiect ZipEntry
            &icirc;n arhiv&#259;, se folose&#537;te metoda </span><span class="c14">putNextEntry()</span><span
            class="c0">.</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c0">Iat&#259; un exemplu de creare a unei arhive:</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <table class="c7">
        <tr class="c9">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c15"><span class="c1">import</span><span class="c4">&nbsp;java.io.*;<br></span><span
                        class="c1">import</span><span class="c4">&nbsp;java.util.zip.*;<br> &nbsp;<br></span><span
                        class="c1">public</span><span class="c4">&nbsp;</span><span class="c1">class</span><span
                        class="c4">&nbsp;</span><span class="c3">Program</span><span class="c4">&nbsp;{<br> &nbsp;<br>
                        &nbsp; &nbsp;</span><span class="c1">public</span><span class="c4">&nbsp;</span><span
                        class="c1">static</span><span class="c4">&nbsp;</span><span class="c1">void</span><span
                        class="c4">&nbsp;</span><span class="c3">main</span><span class="c4">(String[] args) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp;String filename = </span><span
                        class="c12">&quot;notes.txt&quot;</span><span class="c4">;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c1">try</span><span class="c4">(ZipOutputStream zout = </span><span
                        class="c1">new</span><span class="c4">&nbsp;ZipOutputStream(</span><span
                        class="c1">new</span><span class="c4">&nbsp;FileOutputStream(</span><span
                        class="c12">&quot;output.zip&quot;</span><span class="c4">));<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;FileInputStream fis = </span><span class="c1">new</span><span
                        class="c4">&nbsp;FileInputStream(filename);)<br> &nbsp; &nbsp; &nbsp; &nbsp;{<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;ZipEntry entry1 = </span><span class="c1">new</span><span
                        class="c4">&nbsp;ZipEntry(</span><span class="c12">&quot;notes.txt&quot;</span><span
                        class="c4">);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;zout.putNextEntry(entry1);<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// citim con&#539;inutul
                        fi&#537;ierului &icirc;ntr-un array de bytes</span><span class="c4"><br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c1">byte</span><span class="c4">[] buffer = </span><span
                        class="c1">new</span><span class="c4">&nbsp;</span><span class="c1">byte</span><span
                        class="c4">[fis.available()];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fis.read(buffer);<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// ad&#259;ug&#259;m
                        con&#539;inutul &icirc;n arhiv&#259;</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;zout.write(buffer);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c5">// &icirc;nchidem &icirc;nregistrarea curent&#259; pentru o nou&#259;
                        &icirc;nregistrare</span><span class="c4"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;zout.closeEntry();<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c1">catch</span><span class="c4">(Exception ex){<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(ex.getMessage());<br> &nbsp; &nbsp; &nbsp; &nbsp;} <br> &nbsp; &nbsp;}
                        <br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c2">Dup&#259; ad&#259;ugarea obiectului ZipEntry &icirc;n flux, trebuie s&#259;
            ad&#259;ug&#259;m &#537;i con&#539;inutul fi&#537;ierului. Pentru aceasta, se folose&#537;te metoda write,
            care scrie &icirc;n flux un array de bytes: </span><span class="c2 c10">zout.write(buffer);</span><span
            class="c2">. La final, trebuie s&#259; &icirc;nchidem ZipEntry folosind metoda </span><span
            class="c2 c10">closeEntry()</span><span class="c0">. Dup&#259; aceasta, putem ad&#259;uga noi fi&#537;iere
            &icirc;n arhiv&#259;, repet&acirc;nd acelea&#537;i ac&#539;iuni pentru fiecare fi&#537;ier nou.</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c13">Citirea arhivelor. ZipInputStream.</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c2">Pentru citirea arhivelor se folose&#537;te clasa </span><span
            class="c14">ZipInputStream</span><span class="c0">. &Icirc;n constructor, aceasta prime&#537;te un flux care
            indic&#259; c&#259;tre arhiva zip:</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <table class="c7">
        <tr class="c9">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c15"><span class="c4">ZipInputStream(InputStream in)</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c2">Pentru a citi fi&#537;ierele din arhiv&#259;, ZipInputStream folose&#537;te metoda
        </span><span class="c14">getNextEntry()</span><span class="c2">, care returneaz&#259; un obiect </span><span
            class="c14">ZipEntry</span><span class="c0">. Obiectul ZipEntry reprezint&#259; o &icirc;nregistrare
            separat&#259; &icirc;ntr-o arhiv&#259; zip. De exemplu, s&#259; citim o arhiv&#259;:</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <table class="c7">
        <tr class="c9">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c15"><span class="c1">import</span><span class="c4">&nbsp;java.io.*;<br></span><span
                        class="c1">import</span><span class="c4">&nbsp;java.util.zip.*;<br> &nbsp;<br></span><span
                        class="c1">public</span><span class="c4">&nbsp;</span><span class="c1">class</span><span
                        class="c4">&nbsp;</span><span class="c3">Program</span><span class="c4">&nbsp;{<br> &nbsp;<br>
                        &nbsp; &nbsp;</span><span class="c1">public</span><span class="c4">&nbsp;</span><span
                        class="c1">static</span><span class="c4">&nbsp;</span><span class="c1">void</span><span
                        class="c4">&nbsp;</span><span class="c3">main</span><span class="c4">(String[] args) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c1">try</span><span class="c4">(ZipInputStream zin = </span><span
                        class="c1">new</span><span class="c4">&nbsp;ZipInputStream(</span><span
                        class="c1">new</span><span class="c4">&nbsp;FileInputStream(</span><span
                        class="c12">&quot;output.zip&quot;</span><span class="c4">)))<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ZipEntry entry;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;String name;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c1">while</span><span class="c4">((entry = zin.getNextEntry()) != </span><span
                        class="c1">null</span><span class="c4">){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name = entry.getName();
                    </span><span class="c5">// ob&#539;inem numele fi&#537;ierului</span><span class="c4"><br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.out.printf(</span><span
                        class="c12">&quot;File name: %s \n&quot;</span><span class="c4">, name);<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// dezarhivare</span><span class="c4"><br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FileOutputStream fout = </span><span
                        class="c1">new</span><span class="c4">&nbsp;FileOutputStream(</span><span
                        class="c12">&quot;new&quot;</span><span class="c4">&nbsp;+ name);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">for</span><span
                        class="c4">&nbsp;(</span><span class="c1">int</span><span class="c4">&nbsp;c = zin.read(); c !=
                        -</span><span class="c18">1</span><span class="c4">; c = zin.read()) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fout.write(c);<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;fout.flush();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;zin.closeEntry();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;fout.close();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c1">catch</span><span
                        class="c4">(Exception ex){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System.out.println(ex.getMessage());<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;} <br> &nbsp; &nbsp;} <br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c0">ZipInputStream prime&#537;te &icirc;n constructor o referin&#539;&#259; la un flux de
            intrare. Apoi, &icirc;ntr-un ciclu, sunt afi&#537;ate toate fi&#537;ierele &#537;i dimensiunile lor &icirc;n
            bytes, care se afl&#259; &icirc;n arhiva respectiv&#259;.</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
    <p class="c6"><span class="c0">Dup&#259; aceea, datele sunt extrase din arhiv&#259; &#537;i salvate &icirc;n
            fi&#537;iere noi, care se afl&#259; &icirc;n acela&#537;i director &#537;i care &icirc;ncep cu prefixul
            &quot;new&quot;.</span></p>
    <p class="c6 c8"><span class="c0"></span></p>
</body>

</html>