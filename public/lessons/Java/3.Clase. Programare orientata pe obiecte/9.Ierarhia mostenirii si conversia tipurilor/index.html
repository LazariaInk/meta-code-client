<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c18 doc-content">
    <h1 class="c12 c16">Ierarhia moștenirii și conversia tipurilor.</h1>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">&Icirc;n capitolul anterior s-a discutat despre conversia obiectelor de tipuri
            simple. Cu toate acestea, cu obiectele claselor lucrurile stau pu&#539;in diferit. S&#259; presupunem
            c&#259; avem urm&#259;toarea ierarhie de clase: &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c2">class</span><span class="c0">&nbsp;</span><span class="c3">Program</span><span
                        class="c0">{<br> &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp;</span><span
                        class="c2">public</span><span class="c0">&nbsp;</span><span class="c2">static</span><span
                        class="c0">&nbsp;</span><span class="c2">void</span><span class="c0">&nbsp;</span><span
                        class="c3">main</span><span class="c0">(String[] args) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp;Person tom = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Person(</span><span class="c4">&quot;Tom&quot;</span><span class="c0">);<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;tom.display();<br> &nbsp; &nbsp; &nbsp; &nbsp;Person sam =
                    </span><span class="c2">new</span><span class="c0">&nbsp;Employee(</span><span
                        class="c4">&quot;Sam&quot;</span><span class="c0">, </span><span
                        class="c4">&quot;Oracle&quot;</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;sam.display();<br> &nbsp; &nbsp; &nbsp; &nbsp;Person bob = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Client(</span><span
                        class="c4">&quot;Bob&quot;</span><span class="c0">, </span><span
                        class="c4">&quot;DeutscheBank&quot;</span><span class="c0">, </span><span
                        class="c13">3000</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp; &nbsp;bob.display();<br>
                        &nbsp; &nbsp;}<br>}<br></span><span class="c6">// clasa persoan&#259;</span><span
                        class="c0"><br></span><span class="c2">class</span><span class="c0">&nbsp;</span><span
                        class="c3">Person</span><span class="c0">&nbsp;{<br> &nbsp; &nbsp; <br> &nbsp;
                        &nbsp;</span><span class="c2">private</span><span class="c0">&nbsp;String name;<br> &nbsp;
                        &nbsp; <br> &nbsp; &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;String
                    </span><span class="c3">getName</span><span class="c0">() { </span><span
                        class="c2">return</span><span class="c0">&nbsp;name; }<br> &nbsp; &nbsp;<br> &nbsp;
                        &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c3">Person</span><span class="c0">(String name){<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c2">this</span><span class="c0">.name=name;<br> &nbsp;
                        &nbsp;}<br> &nbsp;<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">void</span><span class="c0">&nbsp;</span><span
                        class="c3">display</span><span class="c0">(){<br> &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp;
                        &nbsp; &nbsp;System.out.printf(</span><span class="c4">&quot;Person %s \n&quot;</span><span
                        class="c0">, name);<br> &nbsp; &nbsp;}<br>}<br></span><span class="c6">// angajat al unei
                        companii</span><span class="c0"><br></span><span class="c2">class</span><span
                        class="c0">&nbsp;</span><span class="c3">Employee</span><span class="c0">&nbsp;</span><span
                        class="c2">extends</span><span class="c0">&nbsp;</span><span class="c3">Person</span><span
                        class="c0">{<br> <br> &nbsp; &nbsp;</span><span class="c2">private</span><span
                        class="c0">&nbsp;String company;<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c2">public</span><span class="c0">&nbsp;</span><span class="c3">Employee</span><span
                        class="c0">(String name, String company) {<br> &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c2">super</span><span class="c0">(name);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c2">this</span><span class="c0">.company = company;<br> &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;String
                    </span><span class="c3">getCompany</span><span class="c0">(){ </span><span
                        class="c2">return</span><span class="c0">&nbsp;company; }<br> &nbsp; &nbsp; <br> &nbsp;
                        &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c2">void</span><span class="c0">&nbsp;</span><span class="c3">display</span><span
                        class="c0">(){<br> &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.printf(</span><span class="c4">&quot;Employee %s works in %s
                        \n&quot;</span><span class="c0">, </span><span class="c2">super</span><span
                        class="c0">.getName(), company);<br> &nbsp; &nbsp;}<br>}<br></span><span class="c6">// clasa
                        clientului unei b&#259;nci</span><span class="c0"><br></span><span class="c2">class</span><span
                        class="c0">&nbsp;</span><span class="c3">Client</span><span class="c0">&nbsp;</span><span
                        class="c2">extends</span><span class="c0">&nbsp;</span><span class="c3">Person</span><span
                        class="c0">{<br> &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c2">private</span><span class="c0">&nbsp;</span><span class="c2">int</span><span
                        class="c0">&nbsp;sum; </span><span class="c6">// Variabil&#259; pentru a stoca suma din
                        cont</span><span class="c0"><br> &nbsp; &nbsp;</span><span class="c2">private</span><span
                        class="c0">&nbsp;String bank;<br> &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c2">public</span><span class="c0">&nbsp;</span><span class="c3">Client</span><span
                        class="c0">(String name, String bank, </span><span class="c2">int</span><span
                        class="c0">&nbsp;sum) {<br> &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c2">super</span><span class="c0">(name);<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c2">this</span><span class="c0">.bank=bank;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c2">this</span><span class="c0">.sum=sum;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp;
                        <br> &nbsp; &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c2">void</span><span class="c0">&nbsp;</span><span class="c3">display</span><span
                        class="c0">(){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.printf(</span><span class="c4">&quot;Client %s has account in %s
                        \n&quot;</span><span class="c0">, </span><span class="c2">super</span><span
                        class="c0">.getName(), bank);<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; <br> &nbsp;
                        &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;String </span><span
                        class="c3">getBank</span><span class="c0">(){ </span><span class="c2">return</span><span
                        class="c0">&nbsp;bank; }<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">int</span><span class="c0">&nbsp;</span><span
                        class="c3">getSum</span><span class="c0">(){ </span><span class="c2">return</span><span
                        class="c0">&nbsp;sum; }<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">&Icirc;n aceast&#259; ierarhie de clase putem urm&#259;ri urm&#259;torul lan&#539;
            de mo&#537;tenire: Object (toate clasele mo&#537;tenesc implicit de la tipul Object) -&gt; Person -&gt;
            Employee|Client. &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 341.00px;"><img
                alt="" src="images/image1.png"
                style="width: 624.00px; height: 341.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Superclasele sunt de obicei plasate deasupra subclaselor, astfel &icirc;nc&acirc;t
            &icirc;n v&acirc;rful mo&#537;tenirii se afl&#259; clasa Object, iar la baz&#259; Employee &#537;i Client.
            &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Un obiect al subclasei reprezint&#259;, de asemenea, un obiect al superclasei. De
            aceea, &icirc;n program putem scrie astfel: &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">Object tom = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Person(</span><span class="c4">&quot;Tom&quot;</span><span
                        class="c0">);<br>Object sam = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Employee(</span><span class="c4">&quot;Sam&quot;</span><span class="c0">,
                    </span><span class="c4">&quot;Oracle&quot;</span><span class="c0">);<br>Object kate = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Client(</span><span
                        class="c4">&quot;Kate&quot;</span><span class="c0">, </span><span
                        class="c4">&quot;DeutscheBank&quot;</span><span class="c0">, </span><span
                        class="c13">2000</span><span class="c0">);<br>Person bob = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Client(</span><span
                        class="c4">&quot;Bob&quot;</span><span class="c0">, </span><span
                        class="c4">&quot;DeutscheBank&quot;</span><span class="c0">, </span><span
                        class="c13">3000</span><span class="c0">);<br>Person alice = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Employee(</span><span
                        class="c4">&quot;Alice&quot;</span><span class="c0">, </span><span
                        class="c4">&quot;Google&quot;</span><span class="c0">);</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Aceasta este a&#537;a-numita conversie ascendent&#259; (de la subclas&#259; &icirc;n
            jos la superclas&#259; &icirc;n sus &icirc;n ierarhie) sau upcasting. O astfel de conversie este
            realizat&#259; automat. &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Inversul nu este &icirc;ntotdeauna adev&#259;rat. De exemplu, un obiect de tip
            Person nu este &icirc;ntotdeauna un obiect de tip Employee sau Client. De aceea, conversia descendent&#259;
            sau downcasting de la superclas&#259; la subclas&#259; nu este realizat&#259; automat. &Icirc;n acest caz,
            trebuie s&#259; utiliz&#259;m opera&#539;ia de conversie a tipurilor. &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">Object sam = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Employee(</span><span class="c4">&quot;Sam&quot;</span><span class="c0">,
                    </span><span class="c4">&quot;Oracle&quot;</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        <br></span><span class="c6">// conversia descendent&#259; de la Object la tipul
                        Employee</span><span class="c0"><br>Employee emp =
                        (Employee)sam;<br>emp.display();<br>System.out.println(emp.getCompany());</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">&Icirc;n acest caz, variabila sam este convertit&#259; la tipul Employee. &#536;i
            apoi, prin obiectul emp, putem accesa func&#539;ionalit&#259;&#539;ile obiectului Employee. &nbsp;</span>
    </p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Putem converti obiectul Employee pe toat&#259; linia dreapt&#259; de mo&#537;tenire,
            de la Object la Employee. &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Exemple de conversii descendente: &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">Object kate = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Client(</span><span class="c4">&quot;Kate&quot;</span><span class="c0">,
                    </span><span class="c4">&quot;DeutscheBank&quot;</span><span class="c0">, </span><span
                        class="c13">2000</span><span class="c0">);<br>((Person)kate).display();<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; <br>Object sam = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Employee(</span><span class="c4">&quot;Sam&quot;</span><span class="c0">,
                    </span><span class="c4">&quot;Oracle&quot;</span><span
                        class="c0">);<br>((Employee)sam).display();</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Dar s&#259; lu&#259;m &icirc;n considerare o alt&#259; situa&#539;ie: &nbsp;</span>
    </p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">Object kate = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Client(</span><span class="c4">&quot;Kate&quot;</span><span class="c0">,
                    </span><span class="c4">&quot;DeutscheBank&quot;</span><span class="c0">, </span><span
                        class="c13">2000</span><span class="c0">);<br>Employee emp = (Employee)
                        kate;<br>emp.display();<br> &nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="c6">// sau
                        astfel</span><span class="c0"><br>((Employee)kate).display();</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">&Icirc;n acest caz, variabila de tip Object con&#539;ine o referin&#539;&#259; la un
            obiect de tip Client. Putem f&#259;r&#259; erori s&#259; convertim acest obiect la tipurile Person sau
            Client. Dar &icirc;ncerc&acirc;nd s&#259; &icirc;l convertim la tipul Employee, vom ob&#539;ine o eroare la
            rulare. Acest lucru se &icirc;nt&acirc;mpl&#259; deoarece kate nu reprezint&#259; un obiect de tip Employee.
            &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c15">Operatorul instanceof.</span></p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c10">&Icirc;n exemplul de mai sus vedem clar c&#259; variabila kate este o
            referin&#539;&#259; la un obiect de tip Client, nu Employee. Cu toate acestea, adesea datele vin din
            exterior &#537;i s-ar putea s&#259; nu &#537;tim exact ce tip de obiect reprezint&#259; aceste date. Astfel,
            exist&#259; o probabilitate mare de a &icirc;nt&acirc;mpina o eroare. &#536;i &icirc;nainte de a efectua
            conversia tipurilor, putem verifica dac&#259; putem face conversia folosind operatorul </span><span
            class="c17">instanceof</span><span class="c1">: &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">Object kate = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Client(</span><span class="c4">&quot;Kate&quot;</span><span class="c0">,
                    </span><span class="c4">&quot;DeutscheBank&quot;</span><span class="c0">, </span><span
                        class="c13">2000</span><span class="c0">);<br></span><span class="c2">if</span><span
                        class="c0">(kate </span><span class="c2">instanceof</span><span class="c0">&nbsp;Employee){<br>
                        &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp;Employee employeeKate = (Employee) kate;<br> &nbsp;
                        &nbsp;employeeKate.display();<br>}<br></span><span class="c2">else</span><span class="c0">{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp;
                        &nbsp;System.out.println(</span><span class="c4">&quot;Conversion is invalid&quot;</span><span
                        class="c0">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c10">Expresia</span><span class="c9">&nbsp;kate instanceof Employee </span><span
            class="c10">verific&#259; dac&#259; variabila kate este un obiect de tip Employee. Dar, deoarece &icirc;n
            acest caz evident nu este, aceast&#259; verificare va returna </span><span class="c9">false</span><span
            class="c1">, iar conversia nu va avea succes. &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c10">Expresia </span><span class="c9">kate instanceof Client</span><span
            class="c10">&nbsp;ar returna </span><span class="c9">true</span><span class="c1">: &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">Object kate = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Client(</span><span class="c4">&quot;Kate&quot;</span><span class="c0">,
                    </span><span class="c4">&quot;DeutscheBank&quot;</span><span class="c0">, </span><span
                        class="c13">2000</span><span class="c0">);<br></span><span class="c2">if</span><span
                        class="c0">(kate </span><span class="c2">instanceof</span><span class="c0">&nbsp;Client){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp;Client clientKate = (Client)
                        kate;<br> &nbsp; &nbsp;clientKate.display();<br>}<br></span><span class="c2">else</span><span
                        class="c0">{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;<br> &nbsp; &nbsp;System.out.println(</span><span class="c4">&quot;Conversion is
                        invalid&quot;</span><span class="c0">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Trebuie men&#539;ionat c&#259;, &icirc;ncep&acirc;nd cu versiunea Java 16, putem
            simplifica conversia tipurilor &icirc;n felul urm&#259;tor: &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">Object kate = </span><span class="c2">new</span><span
                        class="c0">&nbsp;Client(</span><span class="c4">&quot;Kate&quot;</span><span class="c0">,
                    </span><span class="c4">&quot;DeutscheBank&quot;</span><span class="c0">, </span><span
                        class="c13">2000</span><span class="c0">);<br></span><span class="c2">if</span><span
                        class="c0">(kate </span><span class="c2">instanceof</span><span class="c0">&nbsp;Client
                        clientKate){<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;clientKate.display();<br>}<br></span><span
                        class="c2">else</span><span class="c0">{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp;System.out.println(</span><span
                        class="c4">&quot;Conversion is invalid&quot;</span><span class="c0">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c1">Expresia &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
    <table class="c14">
        <tr class="c11">
            <td class="c8" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">kate </span><span class="c2">instanceof</span><span
                        class="c0">&nbsp;Client clientKate</span></p>
            </td>
        </tr>
    </table>
    <p class="c7"><span class="c1"></span></p>
    <p class="c12"><span class="c10">Verific&#259; dac&#259; variabila </span><span class="c9">kate </span><span
            class="c10">reprezint&#259; clasa </span><span class="c9">Client</span><span class="c10">, iar dac&#259;
            reprezint&#259; (adic&#259; operatorul </span><span class="c9">instanceof </span><span
            class="c10">returneaz&#259; </span><span class="c9">true</span><span class="c10">), atunci creeaz&#259; o
            variabil&#259; </span><span class="c9">clientKate </span><span class="c10">de tip </span><span
            class="c9">Client</span><span class="c1">. &#536;i ulterior putem utiliza aceast&#259; variabil&#259;
            clientKate &#537;i s&#259; efectu&#259;m diverse opera&#539;ii cu ea. &nbsp;</span></p>
    <p class="c7"><span class="c1"></span></p>
</body>

</html>