<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c15 doc-content">
    <h1 class="c1 c16">Tipurile de referință și copierea obiectelor.</h1>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">&Icirc;n Java, trebuie s&#259; fim con&#537;tien&#539;i c&#259; toate obiectele
            claselor reprezint&#259; tipuri de referin&#539;&#259;, ceea ce &icirc;nseamn&#259; c&#259; indic&#259; un
            obiect situat &icirc;n memorie. Pentru a &icirc;n&#539;elege posibilele dificult&#259;&#539;i, s&#259;
            analiz&#259;m urm&#259;torul exemplu:</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <table class="c11">
        <tr class="c9">
            <td class="c10" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">public</span><span class="c2">&nbsp;</span><span
                        class="c4">class</span><span class="c2">&nbsp;</span><span class="c0">Program</span><span
                        class="c2">{<br> &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp;</span><span
                        class="c4">public</span><span class="c2">&nbsp;</span><span class="c4">static</span><span
                        class="c2">&nbsp;</span><span class="c4">void</span><span class="c2">&nbsp;</span><span
                        class="c0">main</span><span class="c2">(String[] args) {<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;Person tom = </span><span class="c4">new</span><span
                        class="c2">&nbsp;Person(</span><span class="c7">&quot;Tom&quot;</span><span class="c2">,
                    </span><span class="c12">23</span><span class="c2">);<br> &nbsp; &nbsp; &nbsp; &nbsp;tom.display();
                        &nbsp; &nbsp; &nbsp;</span><span class="c5">// Person Tom</span><span class="c2"><br> &nbsp;
                        &nbsp; &nbsp; &nbsp;Person bob = tom;<br> &nbsp; &nbsp; &nbsp; &nbsp;bob.setName(</span><span
                        class="c7">&quot;Bob&quot;</span><span class="c2">);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;tom.display(); &nbsp; &nbsp; &nbsp;</span><span class="c5">// Person Bob</span><span
                        class="c2"><br> &nbsp; &nbsp;}<br>}<br></span><span class="c4">class</span><span
                        class="c2">&nbsp;</span><span class="c0">Person</span><span class="c2">{<br> &nbsp;
                        &nbsp;</span><span class="c4">private</span><span class="c2">&nbsp;String name;<br> &nbsp;
                        &nbsp;</span><span class="c4">private</span><span class="c2">&nbsp;</span><span
                        class="c4">int</span><span class="c2">&nbsp;age;<br> &nbsp; &nbsp; <br> &nbsp;
                        &nbsp;Person(String name, </span><span class="c4">int</span><span class="c2">&nbsp;age){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">this</span><span class="c2">.name = name;<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">this</span><span class="c2">.age = age;<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c4">void</span><span
                        class="c2">&nbsp;</span><span class="c0">setName</span><span class="c2">(String name){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">this</span><span class="c2">.name = name;<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c4">void</span><span
                        class="c2">&nbsp;</span><span class="c0">setAge</span><span class="c2">(</span><span
                        class="c4">int</span><span class="c2">&nbsp;age){<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">this</span><span class="c2">.age = age;<br> &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;</span><span class="c4">void</span><span class="c2">&nbsp;</span><span
                        class="c0">display</span><span class="c2">(){<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.printf(</span><span class="c7">&quot;Person Name: %s \n&quot;</span><span
                        class="c2">, name);<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Aici cre&#259;m dou&#259; obiecte Person, dar le atribuim unul celuilalt. De&#537;i
            schimb&#259;m doar obiectul bob, &#537;i tom se modific&#259;. Aceasta se &icirc;nt&acirc;mpl&#259;
            deoarece, dup&#259; atribuirea bob = tom, ambele variabile indic&#259; aceea&#537;i zon&#259; de memorie,
            unde sunt stocate datele obiectului Person.</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 558.00px; height: 250.00px;"><img
                alt="" src="images/image1.png"
                style="width: 558.00px; height: 250.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c6">Pentru a evita aceast&#259; problem&#259;, trebuie s&#259; cre&#259;m un obiect
            separat pentru variabila bob, de exemplu, folosind metoda </span><span class="c14">clone</span><span
            class="c3">:</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <table class="c11">
        <tr class="c9">
            <td class="c10" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">class</span><span class="c2">&nbsp;</span><span
                        class="c0">Person</span><span class="c2">&nbsp;</span><span class="c4">implements</span><span
                        class="c2">&nbsp;</span><span class="c0">Cloneable</span><span class="c2">&nbsp;{<br> &nbsp;
                        &nbsp;</span><span class="c4">private</span><span class="c2">&nbsp;String name;<br> &nbsp;
                        &nbsp;</span><span class="c4">private</span><span class="c2">&nbsp;</span><span
                        class="c4">int</span><span class="c2">&nbsp;age;<br> &nbsp; &nbsp; <br> &nbsp;
                        &nbsp;Person(String name, </span><span class="c4">int</span><span class="c2">&nbsp;age){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">this</span><span class="c2">.name = name;<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">this</span><span class="c2">.age = age;<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c4">void</span><span
                        class="c2">&nbsp;</span><span class="c0">setName</span><span class="c2">(String name){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">this</span><span class="c2">.name = name;<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c4">void</span><span
                        class="c2">&nbsp;</span><span class="c0">setAge</span><span class="c2">(</span><span
                        class="c4">int</span><span class="c2">&nbsp;age){<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">this</span><span class="c2">.age = age;<br> &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;</span><span class="c4">void</span><span class="c2">&nbsp;</span><span
                        class="c0">display</span><span class="c2">(){<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.printf(</span><span class="c7">&quot;Person %s \n&quot;</span><span
                        class="c2">, name);<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c4">public</span><span class="c2">&nbsp;Person </span><span class="c0">clone</span><span
                        class="c2">() </span><span class="c4">throws</span><span
                        class="c2">&nbsp;CloneNotSupportedException {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">return</span><span class="c2">&nbsp;(Person) </span><span
                        class="c4">super</span><span class="c2">.clone();<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c6">Pentru a implementa clonarea, clasa Person trebuie s&#259; implementeze
            interfa&#539;a </span><span class="c14">Cloneable</span><span class="c6">, care define&#537;te metoda
        </span><span class="c6 c17">clone</span><span class="c6">. Implementarea acestei metode returneaz&#259; apelul
            metodei </span><span class="c6 c17">clone </span><span class="c3">din clasa p&#259;rinte, Object, cu
            conversia la tipul Person.</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c6">De asemenea, pentru cazul &icirc;n care clasa nu accept&#259; clonarea, metoda ar
            trebui s&#259; arunce o excep&#539;ie </span><span class="c14">CloneNotSupportedException</span><span
            class="c6">, folosind operatorul </span><span class="c14">throws</span><span class="c3">.</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Apoi, putem copia obiectul utiliz&acirc;nd aceast&#259; metod&#259;:</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <table class="c11">
        <tr class="c9">
            <td class="c10" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">try</span><span class="c2">&nbsp;{<br> &nbsp; &nbsp;Person tom =
                    </span><span class="c4">new</span><span class="c2">&nbsp;Person(</span><span
                        class="c7">&quot;Tom&quot;</span><span class="c2">, </span><span class="c12">23</span><span
                        class="c2">);<br> &nbsp; &nbsp;Person bob = tom.clone();<br> &nbsp;
                        &nbsp;bob.setName(</span><span class="c7">&quot;Bob&quot;</span><span class="c2">);<br> &nbsp;
                        &nbsp;tom.display(); &nbsp; &nbsp; &nbsp;</span><span class="c5">// Person Tom</span><span
                        class="c2"><br>} </span><span class="c4">catch</span><span
                        class="c2">&nbsp;(CloneNotSupportedException ex) {<br> &nbsp;
                        &nbsp;System.out.println(</span><span class="c7">&quot;Cloneable not
                        implemented&quot;</span><span class="c2">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Cu toate acestea, aceast&#259; metod&#259; realizeaz&#259; o copiere
            superficial&#259; &#537;i este adecvat&#259; dac&#259; obiectul clonat nu con&#539;ine obiecte complexe. De
            exemplu, dac&#259; avem clasa Book definit&#259; astfel:</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <table class="c11">
        <tr class="c9">
            <td class="c10" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">class</span><span class="c2">&nbsp;</span><span
                        class="c0">Book</span><span class="c2">&nbsp;</span><span class="c4">implements</span><span
                        class="c2">&nbsp;</span><span class="c0">Cloneable</span><span class="c2">&nbsp;{<br> &nbsp;
                        &nbsp;</span><span class="c4">private</span><span class="c2">&nbsp;String name;<br> &nbsp;
                        &nbsp;</span><span class="c4">private</span><span class="c2">&nbsp;Author author;<br> &nbsp;
                        &nbsp; <br> &nbsp; &nbsp;</span><span class="c4">public</span><span
                        class="c2">&nbsp;</span><span class="c4">void</span><span class="c2">&nbsp;</span><span
                        class="c0">setName</span><span class="c2">(String n){ name = n; }<br> &nbsp; &nbsp;</span><span
                        class="c4">public</span><span class="c2">&nbsp;String </span><span
                        class="c0">getName</span><span class="c2">(){ </span><span class="c4">return</span><span
                        class="c2">&nbsp;name; }<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c4">public</span><span class="c2">&nbsp;</span><span class="c4">void</span><span
                        class="c2">&nbsp;</span><span class="c0">setAuthor</span><span class="c2">(String n){
                        author.setName(n); }<br> &nbsp; &nbsp;</span><span class="c4">public</span><span
                        class="c2">&nbsp;String </span><span class="c0">getAuthor</span><span class="c2">(){
                    </span><span class="c4">return</span><span class="c2">&nbsp;author.getName(); }<br> <br> &nbsp;
                        &nbsp;Book(String name, String author) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">this</span><span class="c2">.name = name;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">this</span><span class="c2">.author = </span><span class="c4">new</span><span
                        class="c2">&nbsp;Author(author);<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; <br> &nbsp;
                        &nbsp;</span><span class="c4">public</span><span class="c2">&nbsp;String </span><span
                        class="c0">toString</span><span class="c2">() {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">return</span><span class="c2">&nbsp;</span><span class="c7">&quot;Cartea
                        &#39;&quot;</span><span class="c2">&nbsp;+ name + </span><span class="c7">&quot;&#39; (autor
                        &quot;</span><span class="c2">&nbsp;+ &nbsp;author + </span><span
                        class="c7">&quot;)&quot;</span><span class="c2">;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; <br>
                        &nbsp; &nbsp;</span><span class="c4">public</span><span class="c2">&nbsp;Book </span><span
                        class="c0">clone</span><span class="c2">() </span><span class="c4">throws</span><span
                        class="c2">&nbsp;CloneNotSupportedException {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">return</span><span class="c2">&nbsp;(Book) </span><span class="c4">super</span><span
                        class="c2">.clone();<br> &nbsp; &nbsp;}<br>}<br> <br></span><span class="c4">class</span><span
                        class="c2">&nbsp;</span><span class="c0">Author</span><span class="c2">&nbsp;{<br> &nbsp;
                        &nbsp;</span><span class="c4">private</span><span class="c2">&nbsp;String name;<br> &nbsp;
                        &nbsp; <br> &nbsp; &nbsp;</span><span class="c4">public</span><span
                        class="c2">&nbsp;</span><span class="c4">void</span><span class="c2">&nbsp;</span><span
                        class="c0">setName</span><span class="c2">(String n){ name = n; }<br> &nbsp; &nbsp;</span><span
                        class="c4">public</span><span class="c2">&nbsp;String </span><span
                        class="c0">getName</span><span class="c2">(){ </span><span class="c4">return</span><span
                        class="c2">&nbsp;name; }<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c4">public</span><span class="c2">&nbsp;</span><span class="c0">Author</span><span
                        class="c2">(String name) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">this</span><span class="c2">.name = name;<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Dac&#259; &icirc;ncerc&#259;m s&#259; schimb&#259;m autorul c&#259;r&#539;ii, ne vom
            confrunta cu o problem&#259;:</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <table class="c11">
        <tr class="c9">
            <td class="c10" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">try</span><span class="c2">&nbsp;{<br> &nbsp; &nbsp;Book book =
                    </span><span class="c4">new</span><span class="c2">&nbsp;Book(</span><span class="c7">&quot;War and
                        Peace&quot;</span><span class="c2">, </span><span class="c7">&quot;Leo Tolstoy&quot;</span><span
                        class="c2">);<br> &nbsp; &nbsp;Book book2 = book.clone();<br> &nbsp;
                        &nbsp;book2.setAuthor(</span><span class="c7">&quot;Ivan Turgenev&quot;</span><span
                        class="c2">);<br> &nbsp; &nbsp;System.out.println(book.getAuthor());<br>} </span><span
                        class="c4">catch</span><span class="c2">&nbsp;(CloneNotSupportedException ex) {<br> &nbsp;
                        &nbsp;System.out.println(</span><span class="c7">&quot;Cloneable not
                        implemented&quot;</span><span class="c2">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">&Icirc;n acest caz, de&#537;i variabilele book &#537;i book2 vor indica obiecte
            diferite &icirc;n memorie, aceste obiecte vor indica acela&#537;i obiect Author.</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 570.00px; height: 317.00px;"><img
                alt="" src="images/image2.png"
                style="width: 570.00px; height: 317.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">&Icirc;n acest caz, trebuie s&#259; realiz&#259;m o copiere complet&#259; (deep
            copy). Pentru aceasta, trebuie s&#259; definim metoda clone &icirc;n clasa Author:</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <table class="c11">
        <tr class="c9">
            <td class="c10" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">class</span><span class="c2">&nbsp;</span><span
                        class="c0">Author</span><span class="c2">&nbsp;</span><span class="c4">implements</span><span
                        class="c2">&nbsp;</span><span class="c0">Cloneable</span><span class="c2">&nbsp;{<br> &nbsp;
                        &nbsp;</span><span class="c5">// restul codului clasei</span><span class="c2"><br> &nbsp;
                        &nbsp;<br> &nbsp; &nbsp;</span><span class="c4">public</span><span class="c2">&nbsp;Author
                    </span><span class="c0">clone</span><span class="c2">() </span><span class="c4">throws</span><span
                        class="c2">&nbsp;CloneNotSupportedException {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c4">return</span><span class="c2">&nbsp;(Author) </span><span
                        class="c4">super</span><span class="c2">.clone();<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Apoi, vom modifica metoda clone &icirc;n clasa Book astfel:</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
    <table class="c11">
        <tr class="c9">
            <td class="c10" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">public</span><span class="c2">&nbsp;Book </span><span
                        class="c0">clone</span><span class="c2">() </span><span class="c4">throws</span><span
                        class="c2">&nbsp;CloneNotSupportedException {<br> &nbsp; &nbsp;Book newBook = (Book)
                    </span><span class="c4">super</span><span class="c2">.clone();<br> &nbsp; &nbsp;newBook.author =
                        (Author) author.clone();<br> &nbsp; &nbsp;</span><span class="c4">return</span><span
                        class="c2">&nbsp;newBook;<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c8"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Acum, metoda clone din clasa Book creeaz&#259; o copie complet&#259;,
            asigur&acirc;ndu-se c&#259; &#537;i obiectul Author este copiat &icirc;n mod corespunz&#259;tor.</span></p>
    <p class="c1 c8"><span class="c3"></span></p>
</body>

</html>