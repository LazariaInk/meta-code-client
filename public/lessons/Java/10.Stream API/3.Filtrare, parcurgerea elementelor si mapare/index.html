<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c17 doc-content">
    <h1 class="c5 c16">Filtrare, parcurgerea elementelor È™i mapare.</h1>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c12">Parcurgerea elementelor. Metoda forEach.</span></p>
    <p class="c5"><span class="c2">&nbsp;</span></p>
    <p class="c5"><span class="c6">Pentru parcurgerea elementelor unui flux se utilizeaz&#259; metoda</span><span
            class="c13">&nbsp;forEach()</span><span class="c6">, care reprezint&#259; o opera&#539;ie terminal&#259;. Ca
            parametru, aceasta accept&#259; un obiect de tip </span><span class="c13">Consumer&lt;? super
            String&gt;</span><span class="c2">, care define&#537;te ac&#539;iunea ce va fi efectuat&#259; pentru fiecare
            element din set. De exemplu:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">Stream&lt;String&gt; citiesStream = Stream.of(</span><span
                        class="c9">&quot;Paris&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Londra&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Madrid&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Berlin&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Bruxelles&quot;</span><span class="c1">);<br>citiesStream.forEach(s -&gt;
                        System.out.println(s));</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">Aceasta va fi echivalent&#259; cu parcurgerea tuturor elementelor &icirc;ntr-un ciclu
            for &#537;i executarea ac&#539;iunii pentru fiecare element, adic&#259; afi&#537;area la consol&#259;.
            Rezultatul afi&#537;at pe consol&#259; va fi:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">Paris &nbsp;<br>Londra &nbsp;<br>Madrid &nbsp;<br>Berlin
                        &nbsp;<br>Bruxelles &nbsp;</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">Putem simplifica utilizarea metodei forEach astfel:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">Stream&lt;String&gt; citiesStream = Stream.of(</span><span
                        class="c9">&quot;Paris&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Londra&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Madrid&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Berlin&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Bruxelles&quot;</span><span
                        class="c1">);<br>citiesStream.forEach(System.out::println);</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">&Icirc;n acest caz, se transmite o referin&#539;&#259; la metoda static&#259; care
            afi&#537;eaz&#259; &#537;irul la consol&#259;.</span></p>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c12">Filtrarea. Metoda filter.</span></p>
    <p class="c5"><span class="c2">&nbsp; </span></p>
    <p class="c5"><span class="c6">Pentru filtrarea elementelor din flux se folose&#537;te metoda </span><span
            class="c13">filter()</span><span class="c6">, care reprezint&#259; o opera&#539;ie intermediar&#259;.
            Aceasta accept&#259; ca parametru o condi&#539;ie sub forma unui obiect </span><span
            class="c6 c11">Predicate&lt;T&gt;</span><span class="c2">&nbsp;&#537;i returneaz&#259; un flux nou cu
            elementele care &icirc;ndeplinesc aceast&#259; condi&#539;ie:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">Stream&lt;String&gt; citiesStream = Stream.of(</span><span
                        class="c9">&quot;Paris&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Londra&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Madrid&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Berlin&quot;</span><span class="c1">, </span><span
                        class="c9">&quot;Bruxelles&quot;</span><span class="c1">);<br>citiesStream.filter(s -&gt;
                        s.length() == </span><span class="c10">6</span><span class="c1">).forEach(s -&gt;
                        System.out.println(s));</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c6">Condi&#539;ia </span><span class="c6 c11">s.length() == 6 </span><span
            class="c2">returneaz&#259; true pentru elementele a c&#259;ror lungime este de 6 caractere. Astfel,
            rezultatul afi&#537;at va fi:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">Londra &nbsp;<br>Madrid &nbsp;<br>Berlin &nbsp;</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">S&#259; analiz&#259;m un alt exemplu de filtrare cu date mai complexe. S&#259;
            presupunem c&#259; avem urm&#259;toarea clas&#259; Phone:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c7">class</span><span class="c1">&nbsp;</span><span
                        class="c15">Phone</span><span class="c1">{<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c7">private</span><span class="c1">&nbsp;String name;<br> &nbsp; &nbsp;</span><span
                        class="c7">private</span><span class="c1">&nbsp;</span><span class="c7">int</span><span
                        class="c1">&nbsp;price;<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c7">public</span><span class="c1">&nbsp;</span><span class="c15">Phone</span><span
                        class="c1">(String name, </span><span class="c7">int</span><span class="c1">&nbsp;price){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">this</span><span class="c1">.name=name;<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">this</span><span class="c1">.price=price;<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span class="c7">public</span><span
                        class="c1">&nbsp;String </span><span class="c15">getName</span><span class="c1">() {<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c7">return</span><span class="c1">&nbsp;name;<br> &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span class="c7">public</span><span
                        class="c1">&nbsp;</span><span class="c7">void</span><span class="c1">&nbsp;</span><span
                        class="c15">setName</span><span class="c1">(String name) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c7">this</span><span class="c1">.name = name;<br> &nbsp; &nbsp;}<br>
                        &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span class="c7">public</span><span
                        class="c1">&nbsp;</span><span class="c7">int</span><span class="c1">&nbsp;</span><span
                        class="c15">getPrice</span><span class="c1">() {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c7">return</span><span class="c1">&nbsp;price;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; <br>
                        &nbsp; &nbsp;</span><span class="c7">public</span><span class="c1">&nbsp;</span><span
                        class="c7">void</span><span class="c1">&nbsp;</span><span class="c15">setPrice</span><span
                        class="c1">(</span><span class="c7">int</span><span class="c1">&nbsp;price) {<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c7">this</span><span class="c1">.price = price;<br> &nbsp;
                        &nbsp;}<br>}<br></span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">Filtr&#259;m setul de telefoane &icirc;n func&#539;ie de pre&#539;:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">Stream&lt;Phone&gt; phoneStream = Stream.of(</span><span
                        class="c7">new</span><span class="c1">&nbsp;Phone(</span><span class="c9">&quot;iPhone 6
                        S&quot;</span><span class="c1">, </span><span class="c10">54000</span><span class="c1">),
                    </span><span class="c7">new</span><span class="c1">&nbsp;Phone(</span><span class="c9">&quot;Lumia
                        950&quot;</span><span class="c1">, </span><span class="c10">45000</span><span class="c1">),<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">new</span><span
                        class="c1">&nbsp;Phone(</span><span class="c9">&quot;Samsung Galaxy S 6&quot;</span><span
                        class="c1">, </span><span class="c10">40000</span><span
                        class="c1">));<br><br>phoneStream.filter(p -&gt; p.getPrice() &lt; </span><span
                        class="c10">50000</span><span class="c1">).forEach(p -&gt;
                        System.out.println(p.getName()));</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c12">Mapare. Metoda map.</span></p>
    <p class="c5"><span class="c2">&nbsp;</span></p>
    <p class="c5"><span class="c6">Maparea sau transformarea permite definirea unei func&#539;ii de conversie a unui
            obiect &icirc;ntr-altul, adic&#259; ob&#539;inerea unui element de un alt tip din elementul existent. Pentru
            mapare se folose&#537;te metoda </span><span class="c6 c11">map()</span><span class="c2">, care are
            urm&#259;toarea defini&#539;ie:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">&lt;R&gt; Stream&lt;R&gt; </span><span class="c15">map</span><span
                        class="c1">(Function&lt;? </span><span class="c7">super</span><span class="c1">&nbsp;T, ?
                        extends R&gt; mapper)</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">Func&#539;ia transmis&#259; &icirc;n metoda map define&#537;te transformarea
            obiectelor de tip T &icirc;n obiecte de tip R. &Icirc;n rezultat, se returneaz&#259; un flux nou cu
            obiectele transformate.</span></p>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">S&#259; folosim clasa Phone definit&#259; anterior &#537;i s&#259; efectu&#259;m o
            transformare de la tipul Phone la tipul String:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">Stream&lt;Phone&gt; phoneStream = Stream.of(</span><span
                        class="c7">new</span><span class="c1">&nbsp;Phone(</span><span class="c9">&quot;iPhone 6
                        S&quot;</span><span class="c1">, </span><span class="c10">54000</span><span class="c1">),
                    </span><span class="c7">new</span><span class="c1">&nbsp;Phone(</span><span class="c9">&quot;Lumia
                        950&quot;</span><span class="c1">, </span><span class="c10">45000</span><span class="c1">),<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">new</span><span
                        class="c1">&nbsp;Phone(</span><span class="c9">&quot;Samsung Galaxy S 6&quot;</span><span
                        class="c1">, </span><span class="c10">40000</span><span class="c1">));<br><br>phoneStream<br>
                        &nbsp; &nbsp;.map(p -&gt; p.getName()) </span><span class="c19">// introducem &icirc;n flux doar
                        numele telefoanelor</span><span class="c1"><br> &nbsp; &nbsp;.forEach(s -&gt;
                        System.out.println(s));</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c6">Opera&#539;ia</span><span class="c6 c11">&nbsp;map(p -&gt; p.getName()) </span><span
            class="c2">introduce &icirc;n noul flux doar numele telefoanelor. Pe consol&#259; vor fi afi&#537;ate doar
            numele:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">iPhone </span><span class="c10">6</span><span class="c1">&nbsp;S
                        &nbsp;<br>Lumia </span><span class="c10">950</span><span class="c1">&nbsp; <br>Samsung Galaxy S
                    </span><span class="c10">6</span><span class="c1">&nbsp; </span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">S&#259; efectu&#259;m alte transform&#259;ri:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">phoneStream<br> &nbsp; &nbsp;.map(p -&gt; </span><span
                        class="c9">&quot;nume: &quot;</span><span class="c1">&nbsp;+ p.getName() + </span><span
                        class="c9">&quot; pre&#539;: &quot;</span><span class="c1">&nbsp;+ p.getPrice())<br> &nbsp;
                        &nbsp;.forEach(s -&gt; System.out.println(s));</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">&Icirc;n acest caz, fluxul rezultat con&#539;ine doar &#537;iruri de caractere, iar
            numele sunt combinate cu pre&#539;urile.</span></p>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c6">Pentru transformarea obiectelor &icirc;n tipuri Integer, Long, Double sunt definite
            metode speciale: </span><span class="c13">mapToInt()</span><span class="c6">, </span><span
            class="c13">mapToLong() </span><span class="c6">&#537;i </span><span class="c13">mapToDouble()</span><span
            class="c2">.</span></p>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c12">Mapare plat&#259;. Metoda flatMap.</span></p>
    <p class="c5"><span class="c2">&nbsp; </span></p>
    <p class="c5"><span class="c6">Maparea plat&#259; se efectueaz&#259; atunci c&acirc;nd dintr-un element trebuie
            s&#259; ob&#539;inem mai multe. Aceast&#259; opera&#539;iune este realizat&#259; de metoda</span><span
            class="c13">&nbsp;flatMap()</span><span class="c2">:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">&lt;R&gt; Stream&lt;R&gt; </span><span class="c15">flatMap</span><span
                        class="c1">(Function&lt;? </span><span class="c7">super</span><span class="c1">&nbsp;T, ?
                        extends Stream&lt;? extends R&gt;&gt; mapper)</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">De exemplu, &icirc;n exemplul anterior afi&#537;&#259;m numele telefonului &#537;i
            pre&#539;ul acestuia. Dar dac&#259; dorim s&#259; stabilim pentru fiecare telefon un pre&#539;
            f&#259;r&#259; reducere &#537;i unul cu reducere? Adic&#259; dintr-un obiect Phone s&#259; ob&#539;inem
            dou&#259; obiecte cu informa&#539;ii, de exemplu, sub form&#259; de &#537;iruri de caractere. Pentru
            aceasta, utiliz&#259;m flatMap():</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">Stream&lt;Phone&gt; phoneStream = Stream.of(</span><span
                        class="c7">new</span><span class="c1">&nbsp;Phone(</span><span class="c9">&quot;iPhone 6
                        S&quot;</span><span class="c1">, </span><span class="c10">54000</span><span class="c1">),
                    </span><span class="c7">new</span><span class="c1">&nbsp;Phone(</span><span class="c9">&quot;Lumia
                        950&quot;</span><span class="c1">, </span><span class="c10">45000</span><span class="c1">),<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">new</span><span
                        class="c1">&nbsp;Phone(</span><span class="c9">&quot;Samsung Galaxy S 6&quot;</span><span
                        class="c1">, </span><span class="c10">40000</span><span class="c1">));<br><br>phoneStream<br>
                        &nbsp; &nbsp;.flatMap(p -&gt; Stream.of(<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;String.format(</span><span class="c9">&quot;nume: %s pre&#539; f&#259;r&#259; reducere:
                        %d&quot;</span><span class="c1">, p.getName(), p.getPrice()),<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;String.format(</span><span class="c9">&quot;nume: %s pre&#539; cu reducere:
                        %d&quot;</span><span class="c1">, p.getName(), p.getPrice() - (</span><span
                        class="c7">int</span><span class="c1">)(p.getPrice() * </span><span class="c10">0.1</span><span
                        class="c1">))<br> &nbsp; &nbsp;))<br> &nbsp; &nbsp;.forEach(s -&gt;
                        System.out.println(s));</span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
    <p class="c5"><span class="c2">Rezultatul programului va fi:</span></p>
    <p class="c4"><span class="c2"></span></p>
    <table class="c3">
        <tr class="c8">
            <td class="c0" colspan="1" rowspan="1">
                <p class="c14"><span class="c1">nume: iPhone </span><span class="c10">6</span><span class="c1">&nbsp;S
                        pre&#539; f&#259;r&#259; reducere: </span><span class="c10">54000</span><span class="c1">&nbsp;
                        <br>nume: iPhone </span><span class="c10">6</span><span class="c1">&nbsp;S pre&#539; cu
                        reducere: </span><span class="c10">48600</span><span class="c1">&nbsp; <br>nume: Lumia
                    </span><span class="c10">950</span><span class="c1">&nbsp;pre&#539; f&#259;r&#259; reducere:
                    </span><span class="c10">45000</span><span class="c1">&nbsp; <br>nume: Lumia </span><span
                        class="c10">950</span><span class="c1">&nbsp;pre&#539; cu reducere: </span><span
                        class="c10">40500</span><span class="c1">&nbsp; <br>nume: Samsung Galaxy S </span><span
                        class="c10">6</span><span class="c1">&nbsp;pre&#539; f&#259;r&#259; reducere: </span><span
                        class="c10">40000</span><span class="c1">&nbsp; <br>nume: Samsung Galaxy S </span><span
                        class="c10">6</span><span class="c1">&nbsp;pre&#539; cu reducere: </span><span
                        class="c10">36000</span><span class="c1">&nbsp; </span></p>
            </td>
        </tr>
    </table>
    <p class="c4"><span class="c2"></span></p>
</body>

</html>