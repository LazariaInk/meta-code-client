<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c10 doc-content">
    <h1 class="c9 c16 c18">Metoda reduce.</h1>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c5">Metoda </span><span class="c13">reduce </span><span class="c1">efectueaz&#259;
            opera&#539;ii terminale de reducere, return&acirc;nd o valoare care reprezint&#259; rezultatul
            opera&#539;iei. Are urm&#259;toarele forme:</span></p>
    <p class="c0"><span class="c1"></span></p>
    <table class="c4">
        <tr class="c11">
            <td class="c15" colspan="1" rowspan="1">
                <p class="c2"><span class="c3">Optional&lt;T&gt; </span><span class="c14">reduce</span><span
                        class="c3">(BinaryOperator&lt;T&gt; accumulator)<br>T </span><span
                        class="c14">reduce</span><span class="c3">(T identity, BinaryOperator&lt;T&gt;
                        accumulator)<br>&lt;U&gt; U </span><span class="c14">reduce</span><span class="c3">(U identity,
                        BiFunction&lt;U, ? </span><span class="c8">super</span><span class="c3">&nbsp;T, U&gt;
                        accumulator, BinaryOperator&lt;U&gt; combiner)</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c5">Prima form&#259; returneaz&#259; rezultatul sub form&#259; de </span><span
            class="c13">Optional&lt;T&gt;</span><span class="c1">. De exemplu, s&#259; calcul&#259;m produsul unui set
            de numere:</span></p>
    <p class="c0"><span class="c1"></span></p>
    <table class="c4">
        <tr class="c11">
            <td class="c15" colspan="1" rowspan="1">
                <p class="c2"><span class="c8">import</span><span
                        class="c3">&nbsp;java.util.stream.Stream;<br></span><span class="c8">import</span><span
                        class="c3">&nbsp;java.util.Optional;<br><br></span><span class="c8">public</span><span
                        class="c3">&nbsp;</span><span class="c8">class</span><span class="c3">&nbsp;</span><span
                        class="c14">Program</span><span class="c3">&nbsp;{<br><br> &nbsp; &nbsp;</span><span
                        class="c8">public</span><span class="c3">&nbsp;</span><span class="c8">static</span><span
                        class="c3">&nbsp;</span><span class="c8">void</span><span class="c3">&nbsp;</span><span
                        class="c14">main</span><span class="c3">(String[] args) {<br><br> &nbsp; &nbsp; &nbsp;
                        &nbsp;Stream&lt;Integer&gt; numbersStream = Stream.of(</span><span class="c6">1</span><span
                        class="c3">, </span><span class="c6">2</span><span class="c3">, </span><span
                        class="c6">3</span><span class="c3">, </span><span class="c6">4</span><span class="c3">,
                    </span><span class="c6">5</span><span class="c3">, </span><span class="c6">6</span><span
                        class="c3">);<br> &nbsp; &nbsp; &nbsp; &nbsp;Optional&lt;Integer&gt; result =
                        numbersStream.reduce((x, y) -&gt; x * y);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(result.get()); </span><span class="c17">// 720</span><span
                        class="c3"><br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c5">Obiectul </span><span class="c5 c12">BinaryOperator&lt;T&gt; </span><span
            class="c5">reprezint&#259; o func&#539;ie care accept&#259; dou&#259; elemente &#537;i efectueaz&#259; o
            anumit&#259; opera&#539;ie asupra lor, return&acirc;nd rezultatul. &Icirc;n acest context, metoda
        </span><span class="c5 c12">reduce </span><span class="c5">p&#259;streaz&#259; rezultatul &#537;i aplic&#259;
            din nou asupra acestuia &#537;i asupra urm&#259;torului element din set opera&#539;ia binar&#259;. De fapt,
            &icirc;n acest caz, vom ob&#539;ine un rezultat care va fi egal cu: </span><span class="c5 c12">n1 op n2 op
            n3 op n4 op n5 op n6</span><span class="c1">, unde op este opera&#539;ia (&icirc;n acest caz,
            &icirc;nmul&#539;irea), iar n1, n2, ... sunt elemente din flux.</span></p>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c5">Apoi, cu ajutorul metodei </span><span class="c5 c12">get()</span><span class="c5">,
            putem ob&#539;ine rezultatul propriu-zis al calculului: </span><span class="c5 c12">result.get()</span><span
            class="c1">.</span></p>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c1">Un alt exemplu - unirea cuvintelor &icirc;ntr-o propozi&#539;ie:</span></p>
    <p class="c0"><span class="c1"></span></p>
    <table class="c4">
        <tr class="c11">
            <td class="c15" colspan="1" rowspan="1">
                <p class="c2"><span class="c3">Stream&lt;String&gt; wordsStream = Stream.of(</span><span
                        class="c7">&quot;mama&quot;</span><span class="c3">, </span><span
                        class="c7">&quot;sp&#259;la&quot;</span><span class="c3">, </span><span
                        class="c7">&quot;rama&quot;</span><span class="c3">);<br>Optional&lt;String&gt; sentence =
                        wordsStream.reduce((x, y) -&gt; x + </span><span class="c7">&quot; &quot;</span><span
                        class="c3">&nbsp;+ y);<br>System.out.println(sentence.get());</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c5">A doua versiune a metodei</span><span class="c5 c12">&nbsp;reduce()</span><span
            class="c1">&nbsp;accept&#259; doi parametri:</span></p>
    <p class="c0"><span class="c1"></span></p>
    <table class="c4">
        <tr class="c11">
            <td class="c15" colspan="1" rowspan="1">
                <p class="c2"><span class="c3">T </span><span class="c14">reduce</span><span class="c3">(T identity,
                        BinaryOperator&lt;T&gt; accumulator)</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c5">Primul parametru - </span><span class="c5 c12">T identity</span><span
            class="c1">&nbsp;- este elementul care ofer&#259; valoarea ini&#539;ial&#259; pentru func&#539;ia din al
            doilea parametru &#537;i, de asemenea, ofer&#259; o valoare implicit&#259; dac&#259; fluxul nu are
            elemente.</span></p>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c5">Al doilea parametru -</span><span class="c5 c12">&nbsp;BinaryOperator&lt;T&gt;
            accumulator</span><span class="c5">, la fel ca prima form&#259; a metodei </span><span
            class="c5 c12">reduce</span><span class="c1">, reprezint&#259; o func&#539;ie asociativ&#259; care se
            execut&#259; pentru fiecare element din flux &#537;i accept&#259; doi parametri. Primul parametru
            reprezint&#259; rezultatul intermediar al func&#539;iei, iar al doilea parametru - urm&#259;torul element
            din flux. Practic, codul acestei metode va fi echivalent cu urm&#259;toarea &icirc;nregistrare:</span></p>
    <p class="c0"><span class="c1"></span></p>
    <table class="c4">
        <tr class="c11">
            <td class="c15" colspan="1" rowspan="1">
                <p class="c2"><span class="c3">T result = identity;<br></span><span class="c8">for</span><span
                        class="c3">&nbsp;(T element : </span><span class="c8">this</span><span
                        class="c3">&nbsp;stream)<br> &nbsp; &nbsp;result = accumulator.apply(result,
                        element)<br></span><span class="c8">return</span><span class="c3">&nbsp;result;</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c1">Adic&#259;, la prima apelare, func&#539;ia accumulator prime&#537;te ca prim
            parametru valoarea identity &#537;i ca al doilea parametru - primul element din flux. La a doua apelare,
            primul parametru este rezultatul primei apel&#259;ri a func&#539;iei accumulator, iar al doilea parametru
            este al doilea element din flux &#537;i a&#537;a mai departe. De exemplu:</span></p>
    <p class="c0"><span class="c1"></span></p>
    <table class="c4">
        <tr class="c11">
            <td class="c15" colspan="1" rowspan="1">
                <p class="c2"><span class="c3">Stream&lt;Integer&gt; numberStream = Stream.of(-</span><span
                        class="c6">4</span><span class="c3">, </span><span class="c6">3</span><span class="c3">,
                        -</span><span class="c6">2</span><span class="c3">, </span><span class="c6">1</span><span
                        class="c3">);<br></span><span class="c8">int</span><span class="c3">&nbsp;identity =
                    </span><span class="c6">1</span><span class="c3">;<br></span><span class="c8">int</span><span
                        class="c3">&nbsp;result = numberStream.reduce(identity, (x, y) -&gt; x *
                        y);<br>System.out.println(result); &nbsp;</span><span class="c17">// 24</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c5">De fapt, aici se execut&#259; urm&#259;torul lan&#539; de opera&#539;ii: identity
        </span><span class="c5 c12 c16">op n1 op n2 op n3 op n4...</span></p>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c1">&Icirc;n exemplele anterioare, tipul obiectelor returnate coincide cu tipul
            elementelor care intr&#259; &icirc;n flux. Totu&#537;i, acest lucru nu este &icirc;ntotdeauna convenabil.
            Este posibil s&#259; dorim s&#259; return&#259;m un rezultat al c&#259;rui tip difer&#259; de tipul
            obiectelor din flux. De exemplu, s&#259; presupunem c&#259; avem urm&#259;toarea clas&#259; Phone, care
            reprezint&#259; un telefon:</span></p>
    <p class="c0"><span class="c1"></span></p>
    <table class="c4">
        <tr class="c11">
            <td class="c15" colspan="1" rowspan="1">
                <p class="c2"><span class="c8">class</span><span class="c3">&nbsp;</span><span
                        class="c14">Phone</span><span class="c3">&nbsp;{<br><br> &nbsp; &nbsp;</span><span
                        class="c8">private</span><span class="c3">&nbsp;String name;<br> &nbsp; &nbsp;</span><span
                        class="c8">private</span><span class="c3">&nbsp;</span><span class="c8">int</span><span
                        class="c3">&nbsp;price;<br><br> &nbsp; &nbsp;</span><span class="c8">public</span><span
                        class="c3">&nbsp;</span><span class="c14">Phone</span><span class="c3">(String name,
                    </span><span class="c8">int</span><span class="c3">&nbsp;price){<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c8">this</span><span class="c3">.name = name;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c8">this</span><span class="c3">.price = price;<br> &nbsp;
                        &nbsp;}<br><br> &nbsp; &nbsp;</span><span class="c8">public</span><span class="c3">&nbsp;String
                    </span><span class="c14">getName</span><span class="c3">() {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c8">return</span><span class="c3">&nbsp;name;<br> &nbsp;
                        &nbsp;}<br><br> &nbsp; &nbsp;</span><span class="c8">public</span><span
                        class="c3">&nbsp;</span><span class="c8">int</span><span class="c3">&nbsp;</span><span
                        class="c14">getPrice</span><span class="c3">() {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c8">return</span><span class="c3">&nbsp;price;<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c1">&#536;i dorim s&#259; g&#259;sim suma pre&#539;urilor telefoanelor al c&#259;ror
            pre&#539; este mai mic dec&acirc;t o anumit&#259; valoare. Pentru aceasta folosim a treia versiune a metodei
            reduce:</span></p>
    <p class="c0"><span class="c1"></span></p>
    <table class="c4">
        <tr class="c11">
            <td class="c15" colspan="1" rowspan="1">
                <p class="c2"><span class="c3">Stream&lt;Phone&gt; phoneStream = Stream.of(</span><span
                        class="c8">new</span><span class="c3">&nbsp;Phone(</span><span class="c7">&quot;iPhone 6
                        S&quot;</span><span class="c3">, </span><span class="c6">54000</span><span class="c3">),<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">new</span><span
                        class="c3">&nbsp;Phone(</span><span class="c7">&quot;Lumia 950&quot;</span><span class="c3">,
                    </span><span class="c6">45000</span><span class="c3">),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c8">new</span><span class="c3">&nbsp;Phone(</span><span
                        class="c7">&quot;Samsung Galaxy S 6&quot;</span><span class="c3">, </span><span
                        class="c6">40000</span><span class="c3">),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c8">new</span><span class="c3">&nbsp;Phone(</span><span
                        class="c7">&quot;LG G 4&quot;</span><span class="c3">, </span><span class="c6">32000</span><span
                        class="c3">));<br><br></span><span class="c8">int</span><span class="c3">&nbsp;sum =
                        phoneStream.reduce(</span><span class="c6">0</span><span class="c3">, <br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;(x, y) -&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c8">if</span><span class="c3">(y.getPrice() &lt; </span><span
                        class="c6">50000</span><span class="c3">)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c8">return</span><span class="c3">&nbsp;x
                        + y.getPrice();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c8">else</span><span class="c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c8">return</span><span class="c3">&nbsp;x + </span><span class="c6">0</span><span
                        class="c3">;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, <br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;(x, y) -&gt; x + y);<br><br>System.out.println(sum); </span><span class="c17">//
                        117000</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c1"></span></p>
    <p class="c9"><span class="c1">&#536;i aici, primul parametru este valoarea implicit&#259; - 0. Al doilea parametru
            efectueaz&#259; o opera&#539;ie binar&#259;, care prime&#537;te valoarea intermediar&#259; - pre&#539;ul
            total al telefonului curent &#537;i al celui anterior. Al treilea parametru reprezint&#259; o opera&#539;ie
            binar&#259; care &icirc;nsumeaz&#259; toate calculele intermediare.</span></p>
    <p class="c0"><span class="c1"></span></p>
</body>

</html>