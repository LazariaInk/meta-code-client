<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c18 doc-content">
    <h1 class="c15 c12">Opera»õii paralele pe array-uri.</h1>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c6">&Icirc;n JDK 8, clasei </span><span class="c17">Arrays </span><span class="c5">i-au
            fost ad&#259;ugate o serie de metode care permit procesarea elementelor unui array &icirc;n mod paralel.
            De&#537;i aceste metode nu fac formal parte din Stream API, ele implementeaz&#259;
            func&#539;ionalit&#259;&#539;i similare cu fluxurile paralele:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <ul class="c7 lst-kix_26yk3rgauhgh-0 start">
        <li class="c15 c19 li-bullet-0"><span class="c17">parallelPrefix()</span><span class="c5">: calculeaz&#259; o
                valoare pe baza elementelor unui array (de exemplu, suma elementelor)</span></li>
    </ul>
    <p class="c0"><span class="c5"></span></p>
    <ul class="c7 lst-kix_26yk3rgauhgh-0">
        <li class="c15 c19 li-bullet-0"><span class="c17">parallelSetAll()</span><span class="c5">: seteaz&#259;
                elementele unui array folosind o expresie lambda</span></li>
    </ul>
    <p class="c0"><span class="c5"></span></p>
    <ul class="c7 lst-kix_26yk3rgauhgh-0">
        <li class="c15 c19 li-bullet-0"><span class="c17">parallelSort()</span><span class="c5">: sorteaz&#259;
                array-ul</span></li>
    </ul>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c6">S&#259; folosim metoda</span><span class="c6 c14">&nbsp;parallelSetAll()
        </span><span class="c5">pentru a seta elementele unui array:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c9">import</span><span class="c4">&nbsp;java.util.Arrays;<br></span><span
                        class="c9">public</span><span class="c4">&nbsp;</span><span class="c9">class</span><span
                        class="c4">&nbsp;</span><span class="c10">Program</span><span class="c4">&nbsp;{<br><br> &nbsp;
                        &nbsp;</span><span class="c9">public</span><span class="c4">&nbsp;</span><span
                        class="c9">static</span><span class="c4">&nbsp;</span><span class="c9">void</span><span
                        class="c4">&nbsp;</span><span class="c10">main</span><span class="c4">(String[] args) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">int</span><span class="c4">[] numbers =
                        initializeArray(</span><span class="c3">6</span><span class="c4">);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c9">for</span><span class="c4">(</span><span
                        class="c9">int</span><span class="c4">&nbsp;i: numbers)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(i);<br> &nbsp; &nbsp;} <br><br> &nbsp; &nbsp;</span><span
                        class="c9">public</span><span class="c4">&nbsp;</span><span class="c9">static</span><span
                        class="c4">&nbsp;</span><span class="c9">int</span><span class="c4">[]
                        initializeArray(</span><span class="c9">int</span><span class="c4">&nbsp;size) {<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c9">int</span><span class="c4">[] values = </span><span
                        class="c9">new</span><span class="c4">&nbsp;</span><span class="c9">int</span><span
                        class="c4">[size];<br> &nbsp; &nbsp; &nbsp; &nbsp;Arrays.parallelSetAll(values, i -&gt; i *
                    </span><span class="c3">10</span><span class="c4">);<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c9">return</span><span class="c4">&nbsp;values;<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c6">&Icirc;n metoda</span><span class="c6 c14">&nbsp;Arrays.parallelSetAll </span><span
            class="c6">se trec doi parametri: array-ul care va fi modificat &#537;i o func&#539;ie care seteaz&#259;
            elementele acestuia. Aceast&#259; func&#539;ie parcurge toate elementele &#537;i prime&#537;te indexul
            elementului curent procesat. Expresia </span><span class="c6 c14">i -&gt; i * 10 </span><span
            class="c6">&icirc;nseamn&#259; c&#259; la fiecare index din array va fi stocat&#259; valoarea</span><span
            class="c6 c14">&nbsp;i * 10</span><span class="c5">. Rezultatul va fi:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c3">0</span><span class="c4"><br></span><span class="c3">10</span><span
                        class="c4"><br></span><span class="c3">20</span><span class="c4"><br></span><span
                        class="c3">30</span><span class="c4"><br></span><span class="c3">40</span><span
                        class="c4"><br></span><span class="c3">50</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c5">S&#259; vedem un exemplu mai complex cu un obiect Phone:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c9">class</span><span class="c4">&nbsp;</span><span
                        class="c10">Phone</span><span class="c4">{<br> &nbsp; &nbsp;</span><span
                        class="c9">private</span><span class="c4">&nbsp;String name;<br> &nbsp; &nbsp;</span><span
                        class="c9">private</span><span class="c4">&nbsp;</span><span class="c9">int</span><span
                        class="c4">&nbsp;price;<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c9">public</span><span class="c4">&nbsp;</span><span class="c10">Phone</span><span
                        class="c4">(String name, </span><span class="c9">int</span><span class="c4">&nbsp;price){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">this</span><span class="c4">.name = name;<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">this</span><span class="c4">.price =
                        price;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp; <br> &nbsp; &nbsp;</span><span
                        class="c9">public</span><span class="c4">&nbsp;String </span><span
                        class="c10">getName</span><span class="c4">() {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c9">return</span><span class="c4">&nbsp;name;<br> &nbsp; &nbsp;}<br><br> &nbsp;
                        &nbsp;</span><span class="c9">public</span><span class="c4">&nbsp;</span><span
                        class="c9">void</span><span class="c4">&nbsp;</span><span class="c10">setName</span><span
                        class="c4">(String val) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c9">this</span><span class="c4">.name = val;<br> &nbsp; &nbsp;}<br><br> &nbsp;
                        &nbsp;</span><span class="c9">public</span><span class="c4">&nbsp;</span><span
                        class="c9">int</span><span class="c4">&nbsp;</span><span class="c10">getPrice</span><span
                        class="c4">() {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">return</span><span
                        class="c4">&nbsp;price;<br> &nbsp; &nbsp;}<br><br> &nbsp; &nbsp;</span><span
                        class="c9">public</span><span class="c4">&nbsp;</span><span class="c9">void</span><span
                        class="c4">&nbsp;</span><span class="c10">setPrice</span><span class="c4">(</span><span
                        class="c9">int</span><span class="c4">&nbsp;val) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c9">this</span><span class="c4">.price = val;<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c5">Acum s&#259; aplic&#259;m metode pe un array de obiecte Phone:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">Phone[] phones = </span><span class="c9">new</span><span
                        class="c4">&nbsp;Phone[]{</span><span class="c9">new</span><span
                        class="c4">&nbsp;Phone(</span><span class="c1">&quot;iPhone 8&quot;</span><span class="c4">,
                    </span><span class="c3">54000</span><span class="c4">), <br> &nbsp; &nbsp;</span><span
                        class="c9">new</span><span class="c4">&nbsp;Phone(</span><span class="c1">&quot;Pixel
                        2&quot;</span><span class="c4">, </span><span class="c3">45000</span><span class="c4">),<br>
                        &nbsp; &nbsp;</span><span class="c9">new</span><span class="c4">&nbsp;Phone(</span><span
                        class="c1">&quot;Samsung Galaxy S9&quot;</span><span class="c4">, </span><span
                        class="c3">40000</span><span class="c4">),<br> &nbsp; &nbsp;</span><span
                        class="c9">new</span><span class="c4">&nbsp;Phone(</span><span class="c1">&quot;Nokia
                        9&quot;</span><span class="c4">, </span><span class="c3">32000</span><span
                        class="c4">)};<br><br>Arrays.parallelSetAll(phones, i -&gt; {<br> &nbsp;
                        &nbsp;phones[i].setPrice(phones[i].getPrice() - </span><span class="c3">10000</span><span
                        class="c4">); <br> &nbsp; &nbsp;</span><span class="c9">return</span><span
                        class="c4">&nbsp;phones[i];<br>});<br><br></span><span class="c9">for</span><span
                        class="c4">(Phone p: phones)<br> &nbsp; &nbsp;System.out.printf(</span><span class="c1">&quot;%s
                        - %d \n&quot;</span><span class="c4">, p.getName(), p.getPrice());</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c6">Acum, expresia lambda din metoda</span><span class="c6 c14">&nbsp;</span><span
            class="c6 c14">Arrays.parallelSetAll</span><span class="c6 c14">&nbsp;</span><span
            class="c6">reprezint&#259; un bloc de cod. &#536;i, deoarece expresia lambda trebuie s&#259; returneze un
            obiect, trebuie s&#259; folosim explicit operatorul </span><span class="c17">return</span><span class="c5">.
            &Icirc;n aceast&#259; expresie lambda, func&#539;ia prime&#537;te din nou indicii elementelor parcurse,
            &#537;i pe baza acestor indici putem accesa &#537;i modifica elementele array-ului. &Icirc;n acest caz
            specific, are loc o reducere a pre&#539;ului smartphone-urilor cu 10.000 de unit&#259;&#539;i. &Icirc;n
            final, vom ob&#539;ine urm&#259;torul rezultat &icirc;n consol&#259;:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">iPhone </span><span class="c3">8</span><span class="c4">&nbsp;-
                    </span><span class="c3">44000</span><span class="c4"><br>Pixel </span><span class="c3">2</span><span
                        class="c4">&nbsp;- </span><span class="c3">35000</span><span class="c4"><br>Samsung Galaxy S9 -
                    </span><span class="c3">30000</span><span class="c4"><br>Nokia </span><span class="c3">9</span><span
                        class="c4">&nbsp;- </span><span class="c3">22000</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c16">Sortare.</span></p>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c5">S&#259; sort&#259;m un array de numere &icirc;n mod paralel:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c9">int</span><span class="c4">[] nums = {</span><span
                        class="c3">30</span><span class="c4">, -</span><span class="c3">4</span><span class="c4">,
                    </span><span class="c3">5</span><span class="c4">, </span><span class="c3">29</span><span
                        class="c4">, </span><span class="c3">7</span><span class="c4">, -</span><span
                        class="c3">8</span><span class="c4">};<br>Arrays.parallelSort(nums);<br></span><span
                        class="c9">for</span><span class="c4">(</span><span class="c9">int</span><span
                        class="c4">&nbsp;i: nums)<br> &nbsp; &nbsp;System.out.println(i);</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c5">Rezultatul va fi:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c4">-</span><span class="c3">8</span><span class="c4"><br>-</span><span
                        class="c3">4</span><span class="c4"><br></span><span class="c3">5</span><span
                        class="c4"><br></span><span class="c3">7</span><span class="c4"><br></span><span
                        class="c3">29</span><span class="c4"><br></span><span class="c3">30</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c6">Dac&#259; dorim s&#259; sort&#259;m dup&#259; un alt criteriu, cum ar fi dup&#259;
            valoarea absolut&#259; sau folosind obiecte mai complexe, putem crea un comparator &#537;i &icirc;l putem
            transmite ca al doilea parametru &icirc;n</span><span class="c6 c14">&nbsp;Arrays.parallelSort()</span><span
            class="c5">. De exemplu, pentru clasa Phone, putem crea un comparator personalizat:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c9">import</span><span class="c4">&nbsp;java.util.Arrays;<br></span><span
                        class="c9">import</span><span class="c4">&nbsp;java.util.Comparator;<br><br></span><span
                        class="c9">public</span><span class="c4">&nbsp;</span><span class="c9">class</span><span
                        class="c4">&nbsp;</span><span class="c10">Program</span><span class="c4">&nbsp;{<br> &nbsp;
                        &nbsp;</span><span class="c9">public</span><span class="c4">&nbsp;</span><span
                        class="c9">static</span><span class="c4">&nbsp;</span><span class="c9">void</span><span
                        class="c4">&nbsp;</span><span class="c10">main</span><span class="c4">(String[] args) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;Phone[] phones = </span><span class="c9">new</span><span
                        class="c4">&nbsp;Phone[]{</span><span class="c9">new</span><span
                        class="c4">&nbsp;Phone(</span><span class="c1">&quot;iPhone 8&quot;</span><span class="c4">,
                    </span><span class="c3">54000</span><span class="c4">), <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c9">new</span><span class="c4">&nbsp;Phone(</span><span
                        class="c1">&quot;Pixel 2&quot;</span><span class="c4">, </span><span
                        class="c3">45000</span><span class="c4">),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c9">new</span><span class="c4">&nbsp;Phone(</span><span
                        class="c1">&quot;Samsung Galaxy S9&quot;</span><span class="c4">, </span><span
                        class="c3">40000</span><span class="c4">),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c9">new</span><span class="c4">&nbsp;Phone(</span><span
                        class="c1">&quot;Nokia 9&quot;</span><span class="c4">, </span><span
                        class="c3">32000</span><span class="c4">)};<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;Arrays.parallelSort(phones, </span><span class="c9">new</span><span
                        class="c4">&nbsp;PhoneComparator());<br><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c9">for</span><span class="c4">(Phone p: phones)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;System.out.println(p.getName());<br> &nbsp; &nbsp;}<br>}<br><br></span><span
                        class="c9">class</span><span class="c4">&nbsp;</span><span
                        class="c10">PhoneComparator</span><span class="c4">&nbsp;</span><span
                        class="c9">implements</span><span class="c4">&nbsp;</span><span
                        class="c10">Comparator</span><span class="c4">&lt;</span><span class="c10">Phone</span><span
                        class="c4">&gt; {<br> &nbsp; &nbsp;</span><span class="c9">public</span><span
                        class="c4">&nbsp;</span><span class="c9">int</span><span class="c4">&nbsp;</span><span
                        class="c10">compare</span><span class="c4">(Phone a, Phone b) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c9">return</span><span
                        class="c4">&nbsp;a.getName().toUpperCase().compareTo(b.getName().toUpperCase());<br> &nbsp;
                        &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c16">Metoda parallelPrefix.</span></p>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c6">Metoda </span><span class="c6 c14">parallelPrefix()</span><span
            class="c5">&nbsp;este util&#259; atunci c&acirc;nd trebuie s&#259; ob&#539;inem un element al array-ului
            care posed&#259; anumite propriet&#259;&#539;i, cum ar fi produsul elementelor:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c9">int</span><span class="c4">[] numbers = {</span><span
                        class="c3">1</span><span class="c4">, </span><span class="c3">2</span><span class="c4">,
                    </span><span class="c3">3</span><span class="c4">, </span><span class="c3">4</span><span
                        class="c4">, </span><span class="c3">5</span><span class="c4">, </span><span
                        class="c3">6</span><span class="c4">};<br>Arrays.parallelPrefix(numbers, (x, y) -&gt; x *
                        y);<br><br></span><span class="c9">for</span><span class="c4">(</span><span
                        class="c9">int</span><span class="c4">&nbsp;i: numbers)<br> &nbsp;
                        &nbsp;System.out.println(i);</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c5">Rezultatul va fi:</span></p>
    <p class="c0"><span class="c5"></span></p>
    <table class="c8">
        <tr class="c11">
            <td class="c2" colspan="1" rowspan="1">
                <p class="c13"><span class="c3">1</span><span class="c4"><br></span><span class="c3">2</span><span
                        class="c4"><br></span><span class="c3">6</span><span class="c4"><br></span><span
                        class="c3">24</span><span class="c4"><br></span><span class="c3">120</span><span
                        class="c4"><br></span><span class="c3">720</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c5"></span></p>
    <p class="c15"><span class="c6">Expresia lambda &icirc;n</span><span class="c6 c14">&nbsp;Arrays.parallelPrefix
        </span><span class="c5">reprezint&#259; o func&#539;ie binar&#259; care prime&#537;te doi parametri &#537;i
            efectueaz&#259; o opera&#539;ie asupra lor. Rezultatul opera&#539;iei este stocat &#537;i transmis
            c&#259;tre urm&#259;torul apel al func&#539;iei binare.</span></p>
    <p class="c0"><span class="c5"></span></p>
</body>

</html>