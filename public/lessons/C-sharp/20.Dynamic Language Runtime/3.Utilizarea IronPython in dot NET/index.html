<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=chteh0fSOiSrmusp8u43YLibRAUGyvCIyNwOfYj8c_aH4gUIUjZTH34PuvJkbTJT);ol{margin:0;padding:0}table td,table th{padding:0}.c15{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#333333;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Open Sans";font-style:normal}.c13{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:27pt;font-family:"Open Sans";font-style:normal}.c17{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Open Sans";font-style:normal}.c10{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c8{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#ffffff;font-weight:400}.c4{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#888888;font-weight:400}.c2{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#fcc28c;font-weight:400}.c18{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#ffffaa;font-weight:400}.c0{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#a2fca2;font-weight:400}.c9{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#d36363;font-weight:400}.c3{border-spacing:0;border-collapse:collapse;margin-right:auto}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c12{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c14{font-size:12pt;font-family:"Open Sans";font-weight:400}.c11{font-size:12pt;font-family:"Open Sans";font-weight:700}.c16{font-style:italic}.c7{height:0pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c12 doc-content"><p class="c10"><span class="c13">Utilizarea IronPython &icirc;n .NET.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Unul dintre principalele avantaje ale mediului DLR este suportul pentru limbaje dinamice precum </span><span class="c11">IronPython </span><span class="c14">&#537;i </span><span class="c11">IronRuby</span><span class="c6">. S-ar putea s&#259; ne &icirc;ntreb&#259;m de ce avem nevoie de alte limbaje, mai ales de cele care sunt utilizate &icirc;n contextul unui alt limbaj, C#.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">De fapt, limbajele dinamice, de&#537;i poate nu sunt utilizate frecvent, au domenii &icirc;n care utilizarea lor este justificat&#259;. De exemplu, scrierea de scripturi client. Este posibil ca utilizatorul programului nostru s&#259; doreasc&#259; s&#259; adauge un comportament suplimentar &icirc;n program &#537;i pentru aceasta poate fi utilizat IronPython. Se poate chiar spune c&#259; crearea de scripturi client este larg r&#259;sp&acirc;ndit&#259; &icirc;n zilele noastre, multe programe &#537;i chiar jocuri suport&acirc;nd ad&#259;ugarea de scripturi client scrise &icirc;n diverse limbaje.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">&Icirc;n plus, este posibil s&#259; existe biblioteci &icirc;n Python, a c&#259;ror func&#539;ionalitate poate lipsi &icirc;n .NET. &#536;i &icirc;n acest caz, IronPython ne poate ajuta din nou.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">S&#259; analiz&#259;m un exemplu de utilizare a IronPython. Dar, mai &icirc;nt&acirc;i, trebuie s&#259; ad&#259;ug&#259;m &icirc;n proiect c&acirc;teva pachete prin intermediul managerului de pachete </span><span class="c11">NuGet</span><span class="c14">. Pentru aceasta, facem clic dreapta pe nodul </span><span class="c11">Dependencies </span><span class="c14">din fereastra proiectului &#537;i select&#259;m op&#539;iunea </span><span class="c11">Manage NuGet Packages... </span><span class="c6">(Gestionarea pachetelor NuGet) din lista care apare:</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 383.00px; height: 390.00px;"><img alt="" src="images/image1.png" style="width: 383.00px; height: 390.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Se va deschide fereastra managerului de pachete. Pentru a g&#259;si pachetul necesar, introducem &icirc;n c&acirc;mpul de c&#259;utare &quot;DLR&quot;, iar managerul va afi&#537;a o serie de rezultate, dintre care al doilea - pachetul </span><span class="c11">DynamicLanguageRuntime </span><span class="c6">trebuie instalat.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 388.00px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 388.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Dup&#259; aceasta, &icirc;n proiect, &icirc;n nodul Dependencies, se adaug&#259; biblioteca </span><span class="c11">Microsoft.Scripting</span><span class="c6">.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Acum trebuie s&#259; ad&#259;ug&#259;m &#537;i pachetul </span><span class="c11">IronPython</span><span class="c6">. Pentru aceasta, introducem &icirc;n c&acirc;mpul de c&#259;utare &quot;IronPython&quot; &#537;i apoi instal&#259;m pachetul cu acela&#537;i nume:</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 386.67px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 386.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">Dup&#259; instalarea pachetului, &icirc;n nodul Dependencies se adaug&#259; biblioteca IronPython.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">Acum s&#259; scriem un program simplu:</span></p><p class="c5"><span class="c6"></span></p><a id="t.1d3ff81a6f2dea691d4d1602b101d1343cd1c62f"></a><a id="t.0"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c2">using</span><span class="c8">&nbsp;IronPython.Hosting;<br></span><span class="c2">using</span><span class="c8">&nbsp;Microsoft.Scripting.Hosting;<br> <br>ScriptEngine engine = Python.CreateEngine();<br>engine.Execute(</span><span class="c0">&quot;print(&#39;hello, world&#39;)&quot;</span><span class="c8">);</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">Output &icirc;n consol&#259;:</span></p><p class="c5"><span class="c6"></span></p><a id="t.459c90374c3c1ba7e3737b260790c912d76d643a"></a><a id="t.1"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c8">hello, world</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Aici este utilizat&#259; expresia </span><span class="c14 c16">print(&#39;hello, world&#39;)</span><span class="c14">&nbsp;din limbajul Python, care afi&#537;eaz&#259; &icirc;n consol&#259; un &#537;ir de caractere. Pentru a crea motorul care execut&#259; scriptul, se folose&#537;te clasa </span><span class="c11">ScriptEngine</span><span class="c14">, iar metoda sa </span><span class="c14 c16">Execute() </span><span class="c6">execut&#259; scriptul.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">De asemenea, am putea defini un fi&#537;ier </span><span class="c11">hello.py</span><span class="c6">, adic&#259; un fi&#537;ier text simplu cu cod &icirc;n limbajul Python, cu urm&#259;torul con&#539;inut:</span></p><p class="c5"><span class="c6"></span></p><a id="t.a0b939972e11136e8e930f7adc4cb0edcc846f66"></a><a id="t.2"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c8">print(</span><span class="c0">&quot;hello, fdc.com&quot;</span><span class="c8">)</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">&#536;i s&#259;-l rul&#259;m &icirc;n program:</span></p><p class="c5"><span class="c6"></span></p><a id="t.0f8b24d508714e106c9e076caebb4b1d5576a07f"></a><a id="t.3"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c8">using IronPython.Hosting;<br>using Microsoft.Scripting.Hosting;<br> <br>ScriptEngine engine = Python.CreateEngine();<br>engine.ExecuteFile(</span><span class="c0">&quot;hello.py&quot;</span><span class="c8">);</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">&Icirc;n acest caz, se presupune c&#259; scriptul se afl&#259; &icirc;n proiect:</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 250.50px; height: 129.85px;"><img alt="" src="images/image3.png" style="width: 250.50px; height: 129.85px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">De asemenea, putem utiliza c&#259;i absolute, de exemplu, dac&#259; scriptul se afl&#259; pe calea &quot;D://hello.py&quot;:</span></p><p class="c5"><span class="c6"></span></p><a id="t.0db76482e88d280860407d475dc11478c7e32a87"></a><a id="t.4"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c8">ScriptEngine engine = Python.CreateEngine();<br>engine.ExecuteFile(</span><span class="c0">&quot;D://hello.py&quot;</span><span class="c8">);</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c17">ScriptScope.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Obiectul ScriptScope permite interac&#539;iunea cu scriptul, ob&#539;in&acirc;nd sau set&acirc;nd variabilele sale, ob&#539;in&acirc;nd referin&#539;e la func&#539;ii. De exemplu, s&#259; scriem un script simplu </span><span class="c11">hello2.py</span><span class="c6">, care utilizeaz&#259; variabile:</span></p><p class="c5"><span class="c6"></span></p><a id="t.056e7cd64171c95895346e3eeab8a45e6d9af062"></a><a id="t.5"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c8">x = </span><span class="c9">10</span><span class="c8"><br>z = x + y<br>print(z)</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">Acum s&#259; scriem un program care s&#259; interac&#539;ioneze cu scriptul:</span></p><p class="c5"><span class="c6"></span></p><a id="t.ed7614a28cd47eae6b481f732380f75743ad684c"></a><a id="t.6"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c2">using</span><span class="c8">&nbsp;IronPython.Hosting;<br></span><span class="c2">using</span><span class="c8">&nbsp;Microsoft.Scripting.Hosting;<br> <br></span><span class="c2">int</span><span class="c8">&nbsp;y = </span><span class="c9">22</span><span class="c8">;<br> <br>ScriptEngine engine = Python.CreateEngine();<br>ScriptScope scope = engine.CreateScope();<br>scope.SetVariable(</span><span class="c0">&quot;y&quot;</span><span class="c8">, y);<br>engine.ExecuteFile(</span><span class="c0">&quot;hello.py&quot;</span><span class="c8">, scope);<br></span><span class="c2">dynamic</span><span class="c8">&nbsp;x = scope.GetVariable(</span><span class="c0">&quot;x&quot;</span><span class="c8">);<br></span><span class="c2">dynamic</span><span class="c8">&nbsp;z = scope.GetVariable(</span><span class="c0">&quot;z&quot;</span><span class="c8">);<br>Console.WriteLine(</span><span class="c0">$&quot;{x} + {y} = {z}&quot;</span><span class="c8">);</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Obiectul ScriptScope permite setarea variabilelor &icirc;n script prin metoda </span><span class="c14 c16">SetVariable</span><span class="c14">, iar cu ajutorul metodei </span><span class="c14 c16">GetVariable()</span><span class="c6">&nbsp;le putem ob&#539;ine.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">Output &icirc;n consol&#259;:</span></p><p class="c5"><span class="c6"></span></p><a id="t.97346361c5644a43dea281c0e5b61f13cfcb93c6"></a><a id="t.7"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c9">32</span><span class="c8"><br></span><span class="c9">10</span><span class="c8">&nbsp;+ </span><span class="c9">22</span><span class="c8">&nbsp;= </span><span class="c9">32</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c17">Apelarea func&#539;iilor din IronPython.</span></p><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Definim &icirc;n fi&#537;ierul</span><span class="c11">&nbsp;hello.py</span><span class="c6">&nbsp;o func&#539;ie pentru calcularea p&#259;tratului unui num&#259;r:</span></p><p class="c5"><span class="c6"></span></p><a id="t.84cc5b4b2bf6f5838769548b13c767bc17854105"></a><a id="t.8"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c8">def </span><span class="c18">square</span><span class="c8">(n):<br> &nbsp; return n * n</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c6">Acum s&#259; apel&#259;m aceast&#259; func&#539;ie &icirc;n codul C#:</span></p><p class="c5"><span class="c6"></span></p><a id="t.c0a28ef23de00cb3115d113c73f930af54f248d1"></a><a id="t.9"></a><table class="c3"><tr class="c7"><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c2">using</span><span class="c8">&nbsp;IronPython.Hosting;<br></span><span class="c2">using</span><span class="c8">&nbsp;Microsoft.Scripting.Hosting;<br> <br></span><span class="c2">int</span><span class="c8">&nbsp;number = </span><span class="c9">5</span><span class="c8">;<br> <br>ScriptEngine engine = Python.CreateEngine();<br>ScriptScope scope = engine.CreateScope();<br> <br>engine.ExecuteFile(</span><span class="c0">&quot;hello.py&quot;</span><span class="c8">, scope);<br></span><span class="c2">dynamic</span><span class="c8">&nbsp;square = scope.GetVariable(</span><span class="c0">&quot;square&quot;</span><span class="c8">);<br></span><span class="c4">// apel&#259;m func&#539;ia &#537;i ob&#539;inem rezultatul</span><span class="c8"><br></span><span class="c2">dynamic</span><span class="c8">&nbsp;result = square(number);<br>Console.WriteLine(result); &nbsp;</span><span class="c4">// 25</span></p></td></tr></table><p class="c5"><span class="c6"></span></p><p class="c10"><span class="c14">Putem ob&#539;ine obiectul func&#539;iei la fel ca &#537;i o variabil&#259;: </span><span class="c14 c16">scope.GetVariable(&quot;square&quot;);</span><span class="c6">. Apoi, lucr&#259;m cu acest obiect la fel ca &#537;i cu orice alt&#259; metod&#259;. &Icirc;n final, c&acirc;nd transmitem num&#259;rul 5 func&#539;iei square, rezultatul va fi 25.</span></p><p class="c5"><span class="c6"></span></p></body></html>