<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><link rel="stylesheet" type="text/css" href="/lessons/styles.css"></head><body class="c10 doc-content"><p class="c6"><span class="c12">Native AOT.</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c5">&Icirc;n mod implicit, un program C# este compilat &icirc;ntr-un cod intermediar MSIL. Pentru a rula un astfel de program, este necesar ca pe computer s&#259; fie instalat framework-ul .NET. Cu toate acestea, .NET SDK permite de asemenea compilarea unui proiect C# &icirc;ntr-o aplica&#539;ie nativ&#259;, care nu utilizeaz&#259; compilarea JIT &#537;i poate fi rulat&#259; pe un computer f&#259;r&#259; .NET instalat. Acest model se nume&#537;te</span><span class="c14">&nbsp;Native AOT</span><span class="c0">&nbsp;&#537;i este disponibil &icirc;ncep&acirc;nd cu .NET 7 (pentru proiecte console). Suportul pentru ASP.NET Core &#537;i MacOS a fost ad&#259;ugat &icirc;n .NET 8.0.</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c5">Pentru a utiliza </span><span class="c14">Native AOT</span><span class="c5">, este necesar&#259; instalarea unor instrumente suplimentare. Pe Windows, prin instalatorul Visual Studio, trebuie instalat&#259; &icirc;nc&#259;rc&#259;tura </span><span class="c14">&quot;Desktop development with C++&quot; (Dezvoltarea aplica&#539;iilor clasice pe C++)</span><span class="c0">.</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 313.33px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 313.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c4"><span class="c0"></span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c5">Pentru a specifica faptul c&#259; proiectul va folosi modelul de publicare </span><span class="c14">Native AOT</span><span class="c5">, &icirc;n fi&#537;ierul proiectului, &icirc;n elementul </span><span class="c5 c9">PropertyGroup</span><span class="c5">, trebuie ad&#259;ugat elementul </span><span class="c5 c9">&lt;PublishAot&gt;true&lt;/PublishAot&gt;</span><span class="c0">:</span></p><p class="c4"><span class="c0"></span></p><a id="t.55856f5d429fb74a144e9a49a6d0331619887384"></a><a id="t.0"></a><table class="c15"><tr class="c11"><td class="c2" colspan="1" rowspan="1"><p class="c3"><span class="c1">&lt;PropertyGroup&gt;<br> &nbsp; &nbsp;&lt;PublishAot&gt;</span><span class="c8">true</span><span class="c1">&lt;/PublishAot&gt;<br>&lt;/PropertyGroup&gt;</span></p></td></tr></table><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Pentru compilarea folosind .NET CLI se folose&#537;te urm&#259;toarea comand&#259;:</span></p><p class="c4"><span class="c0"></span></p><a id="t.66bc25b2050e83731b7e903233908bd6c1a01fd7"></a><a id="t.1"></a><table class="c15"><tr class="c11"><td class="c2" colspan="1" rowspan="1"><p class="c3"><span class="c1">dotnet publish -r &lt;RID&gt;</span></p></td></tr></table><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">&Icirc;n particular, c&acirc;&#539;iva identificatori comuni sunt:</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Pentru Windows:</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">- win-x64</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">- win-x86</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">- win-arm64</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Pentru Linux:</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">- linux-x64</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">- linux-arm64</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Pentru MacOS:</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">- osx-x64</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">- osx-arm64</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Lista complet&#259; a identificatorilor poate fi g&#259;sit&#259; la adresa: </span></p><p class="c6"><span class="c5 c7"><a class="c16" href="https://www.google.com/url?q=https://github.com/dotnet/runtime/blob/main/src/libraries/Microsoft.NETCore.Platforms/src/runtime.json&amp;sa=D&amp;source=editors&amp;ust=1723473701617671&amp;usg=AOvVaw0PRJ-qa4Goad8-VEUv7YXO">https://github.com/dotnet/runtime/blob/main/src/libraries/Microsoft.NETCore.Platforms/src/runtime.json</a></span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">De exemplu, pentru compilarea unei aplica&#539;ii pentru Windows pe 64 de bi&#539;i, se utilizeaz&#259; comanda:</span></p><p class="c4"><span class="c0"></span></p><a id="t.ae06de3846868c78da9680c83463d4e2eed3e21d"></a><a id="t.2"></a><table class="c15"><tr class="c11"><td class="c2" colspan="1" rowspan="1"><p class="c3"><span class="c1">dotnet publish -r win-x64 -c Release</span></p></td></tr></table><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">S&#259; lu&#259;m, de exemplu, un proiect simplu de aplica&#539;ie console. Mai &icirc;nt&acirc;i, ad&#259;ug&#259;m &icirc;n fi&#537;ierul proiectului csproj parametrii:</span></p><p class="c4"><span class="c0"></span></p><a id="t.d78714f950a2618b8cc73f82827b60698995aba1"></a><a id="t.3"></a><table class="c15"><tr class="c11"><td class="c2" colspan="1" rowspan="1"><p class="c3"><span class="c1">&lt;PublishAot&gt;</span><span class="c8">true</span><span class="c1">&lt;/PublishAot&gt;</span></p></td></tr></table><p class="c4"><span class="c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 403.00px; height: 265.00px;"><img alt="" src="images/image2.png" style="width: 403.00px; height: 265.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Acces&#259;m &icirc;n consola folderul proiectului. S&#259; presupunem c&#259; trebuie s&#259; compil&#259;m aplica&#539;ia pentru Windows pe 64 de bi&#539;i. Pentru aceasta, execut&#259;m comanda:</span></p><p class="c4"><span class="c0"></span></p><a id="t.ae06de3846868c78da9680c83463d4e2eed3e21d"></a><a id="t.4"></a><table class="c15"><tr class="c11"><td class="c2" colspan="1" rowspan="1"><p class="c3"><span class="c1">dotnet publish -r win-x64 -c Release</span></p></td></tr></table><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Ca rezultat, vom ob&#539;ine urm&#259;torul output &icirc;n consol&#259;:</span></p><p class="c4"><span class="c0"></span></p><a id="t.44da5e4c76234c1ef4a02d50b3744224459bad64"></a><a id="t.5"></a><table class="c15"><tr class="c11"><td class="c2" colspan="1" rowspan="1"><p class="c3"><span class="c1">C:\Users\Petrea\source\repos&gt;cd C:\Users\Petrea\source\repos\FDCApp\FDCApp<br><br>C:\Users\Petrea\source\repos\FDCApp\FDCApp&gt;dotnet publish -r win-x64 -c Release<br> &nbsp;Determining projects to restore...<br> &nbsp;All projects are up-to-date </span><span class="c8">for</span><span class="c1">&nbsp;restore.<br> &nbsp;FDCApp -&gt; C:\Users\Petrea\source\repos\FDCApp\FDCApp\bin\Release\net8</span><span class="c13">.0</span><span class="c1">\win-x64\FDCApp.dll<br> &nbsp;FDCApp -&gt; C:\Users\Petrea\source\repos\FDCApp\FDCApp\bin\Release\net8</span><span class="c13">.0</span><span class="c1">\win-x64\publish\<br>C:\Users\Petrea\source\repos\FDCApp\FDCApp&gt;</span></p></td></tr></table><p class="c4"><span class="c0"></span></p><p class="c4"><span class="c0"></span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Dup&#259; aceasta, &icirc;n proiect, &icirc;n folderul bin\Release\netX.X\win-x64\publish\ se poate g&#259;si aplica&#539;ia compilat&#259;.</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 112.00px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 112.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">&Icirc;n final, fi&#537;ierul executabil (exe) compilat poate fi rulat pe sisteme Windows pe 64 de bi&#539;i, chiar &#537;i acolo unde .NET nu este instalat.</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Unul dintre principalele dezavantaje ale compil&#259;rii &icirc;ntr-o aplica&#539;ie nativ&#259; este dimensiunea acesteia. De exemplu, a&#537;a cum se vede &icirc;n captura de ecran, la compilarea cu .NET 8.0 Preview, o simpl&#259; aplica&#539;ie console, care afi&#537;eaz&#259; o linie &icirc;n consol&#259;, ocup&#259; 1793 KB. Cu toate acestea, merit&#259; men&#539;ionat c&#259;, comparativ cu .NET 7.0, &icirc;n .NET 8.0 dimensiunea aplica&#539;iei native a fost semnificativ redus&#259;, iar echipa de dezvoltare .NET continu&#259; s&#259; lucreze la acest aspect, astfel &icirc;nc&acirc;t dimensiunea aplica&#539;iei ar putea sc&#259;dea semnificativ &icirc;n viitor. &Icirc;n plus, se pot aplica diferite optimiz&#259;ri. Cea mai simpl&#259; este utilizarea modului invariant pentru parametrii de globalizare, pentru care trebuie ad&#259;ugat&#259; &icirc;n fi&#537;ierul proiectului urm&#259;toarea setare:</span></p><a id="t.7084d3d8833ad322e133da7657043641db215a81"></a><a id="t.6"></a><table class="c15"><tr class="c11"><td class="c2" colspan="1" rowspan="1"><p class="c3"><span class="c1">&lt;InvariantGlobalization&gt;</span><span class="c8">true</span><span class="c1">&lt;/InvariantGlobalization&gt;</span></p></td></tr></table><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">Astfel, doar aceast&#259; setare a permis &icirc;n cazul meu reducerea dimensiunii aplica&#539;iei de la 1793 KB la 1567 KB.</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">&Icirc;n plus fa&#539;&#259; de dimensiunea mai mare, merit&#259; men&#539;ionat &#537;i alte dezavantaje ale acestui model de publicare. &Icirc;n primul r&acirc;nd, nu este disponibil pentru toate tipurile de proiecte, biblioteci &#537;i medii. De exemplu, suportul pentru aplica&#539;iile console a fost ad&#259;ugat de la &icirc;nceput, &icirc;n .NET 7.0. Pentru ASP.NET Core, acest model este disponibil doar &icirc;ncep&acirc;nd cu .NET 8.0.</span></p><p class="c4"><span class="c0"></span></p><p class="c6"><span class="c0">De asemenea, pentru astfel de aplica&#539;ii native, &icirc;nc&#259;rcarea dinamic&#259; a bibliotecilor (de exemplu, folosind metoda Assembly.LoadFile) nu este disponibil&#259;.</span></p><p class="c4"><span class="c0"></span></p></body></html>