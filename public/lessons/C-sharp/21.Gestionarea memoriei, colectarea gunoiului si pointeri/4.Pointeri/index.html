<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=chteh0fSOiSrmusp8u43YLibRAUGyvCIyNwOfYj8c_aH4gUIUjZTH34PuvJkbTJT);ol{margin:0;padding:0}table td,table th{padding:0}.c13{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#333333;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c15{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:27pt;font-family:"Open Sans";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.c12{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Open Sans";font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Open Sans";font-style:normal}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c4{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#ffffaa;font-weight:400}.c5{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#ffffff;font-weight:400}.c18{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#a2fca2;font-weight:400}.c9{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#fcc28c;font-weight:400}.c6{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#d36363;font-weight:400}.c7{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#888888;font-weight:400}.c10{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c16{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c1{border-spacing:0;border-collapse:collapse;margin-right:auto}.c14{font-size:12pt;font-family:"Open Sans";font-weight:400}.c17{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c11{font-size:12pt;font-family:"Open Sans";font-weight:700}.c2{height:0pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c17 doc-content"><p class="c8"><span class="c15">Pointeri.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c14">Dac&#259; a&#539;i programat &icirc;n C/C++, este posibil s&#259; fi&#539;i familiarizat cu conceptul de </span><span class="c11">pointeri</span><span class="c3">. Pointerii permit accesul la o anumit&#259; loca&#539;ie din memorie &#537;i efectuarea unor opera&#539;iuni asupra valorii stocate &icirc;n acea loca&#539;ie.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">&Icirc;n limbajul C#, pointerii sunt folosi&#539;i rar, dar &icirc;n anumite cazuri pot fi utiliza&#539;i pentru optimizarea aplica&#539;iilor. Codul care folose&#537;te pointeri este numit cod nesigur (unsafe). Totu&#537;i, acest lucru nu &icirc;nseamn&#259; c&#259; prezint&#259; un pericol. Pur &#537;i simplu, atunci c&acirc;nd lucr&#259;m cu acest tip de cod, toate ac&#539;iunile legate de utilizarea memoriei, inclusiv eliberarea ei, revin &icirc;n totalitate programatorului, nu mediului CLR. Din punctul de vedere al CLR, acest cod nu este sigur, deoarece mediul nu poate verifica acest cod, ceea ce cre&#537;te probabilitatea de erori de diverse tipuri.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c14">Pentru a utiliza cod nesigur &icirc;n C#, trebuie s&#259; specific&#259;m proiectului c&#259; va lucra cu cod nesigur. Pentru aceasta, trebuie s&#259; activ&#259;m setarea corespunz&#259;toare &icirc;n set&#259;rile proiectului - din meniul Project (Proiect) select&#259;m Properties (Propriet&#259;&#539;i). Apoi, &icirc;n meniul Build, bif&#259;m caseta </span><span class="c11">Unsafe code</span><span class="c3">&nbsp;(Cod nesigur):</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 385.33px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 385.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c12">Cuv&acirc;ntul cheie unsafe.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c14">Un bloc de cod sau o metod&#259; care utilizeaz&#259; pointeri este marcat&#259; cu cuv&acirc;ntul cheie </span><span class="c11">unsafe</span><span class="c3">:</span></p><p class="c0"><span class="c3"></span></p><a id="t.ce3cd8cbe74c713b1db98a090525abf2f2672367"></a><a id="t.0"></a><table class="c1"><tr class="c2"><td class="c13" colspan="1" rowspan="1"><p class="c10"><span class="c7">// bloc de cod care utilizeaz&#259; pointeri</span><span class="c5"><br></span><span class="c9">unsafe</span><span class="c5"><br>{<br> &nbsp; &nbsp; <br>}</span></p></td></tr></table><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">Metod&#259; care folose&#537;te pointeri:</span></p><p class="c0"><span class="c3"></span></p><a id="t.4905fc76e303faf52083447f56caeca1824d1760"></a><a id="t.1"></a><table class="c1"><tr class="c2"><td class="c13" colspan="1" rowspan="1"><p class="c10"><span class="c9">unsafe</span><span class="c5">&nbsp;</span><span class="c9">void</span><span class="c5">&nbsp;</span><span class="c4">Test</span><span class="c5">()<br>{<br> <br>}</span></p></td></tr></table><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">De asemenea, cu ajutorul unsafe putem declara structuri &#537;i clase:</span></p><p class="c0"><span class="c3"></span></p><a id="t.2b921b317ec0361c89fda996271cc4b0c43e6632"></a><a id="t.2"></a><table class="c1"><tr class="c2"><td class="c13" colspan="1" rowspan="1"><p class="c10"><span class="c9">unsafe</span><span class="c5">&nbsp;</span><span class="c9">struct</span><span class="c5">&nbsp;State<br>{ <br> <br>}<br> <br></span><span class="c9">unsafe</span><span class="c5">&nbsp;</span><span class="c9">class</span><span class="c5">&nbsp;</span><span class="c4">Person</span><span class="c5"><br>{<br> <br>}</span></p></td></tr></table><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c12">Opera&#539;iile * &#537;i &amp;.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c14">Opera&#539;ia central&#259; &icirc;n lucrul cu pointerii este opera&#539;ia *, numit&#259; &#537;i opera&#539;ie de dereferen&#539;iere. Opera&#539;ia de dereferen&#539;iere permite ob&#539;inerea sau setarea valorii la adresa indicat&#259; de pointer. Pentru a ob&#539;ine adresa unei variabile, se folose&#537;te opera&#539;ia </span><span class="c11 c16">&amp;:</span></p><p class="c0"><span class="c3"></span></p><a id="t.1c48fd69ae325dba27b72d0dcf57023bdeacfcfe"></a><a id="t.3"></a><table class="c1"><tr class="c2"><td class="c13" colspan="1" rowspan="1"><p class="c10"><span class="c9">unsafe</span><span class="c5"><br>{<br> &nbsp; &nbsp;</span><span class="c9">int</span><span class="c5">* x; </span><span class="c7">// definirea unui pointer</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c9">int</span><span class="c5">&nbsp;y = </span><span class="c6">10</span><span class="c5">; </span><span class="c7">// definim o variabil&#259;</span><span class="c5"><br> <br> &nbsp; &nbsp;x = &amp;y; </span><span class="c7">// pointerul x acum indic&#259; adresa variabilei y</span><span class="c5"><br> &nbsp; &nbsp;Console.WriteLine(*x); </span><span class="c7">// 10</span><span class="c5"><br> <br> &nbsp; &nbsp;y = y + </span><span class="c6">20</span><span class="c5">; &nbsp; &nbsp; </span><span class="c7">// schimb&#259;m valoarea</span><span class="c5"><br> &nbsp; &nbsp;Console.WriteLine(*x); </span><span class="c7">// 30</span><span class="c5"><br> <br> &nbsp; &nbsp;*x = </span><span class="c6">50</span><span class="c5">;<br> &nbsp; &nbsp;Console.WriteLine(y); </span><span class="c7">// variabila y=50</span><span class="c5"><br>}</span></p></td></tr></table><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">La declararea unui pointer, indic&#259;m tipul: int* x; - &icirc;n acest caz, se declar&#259; un pointer c&#259;tre un num&#259;r &icirc;ntreg. Dar, pe l&acirc;ng&#259; tipul int, se pot folosi &#537;i altele: sbyte, byte, short, ushort, int, uint, long, ulong, char, float, double, decimal sau bool. De asemenea, se pot declara pointeri c&#259;tre tipuri enum, structuri &#537;i al&#539;i pointeri.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">Expresia x = &amp;y; ne permite s&#259; ob&#539;inem adresa variabilei y &#537;i s&#259; set&#259;m pointerul x la acea adres&#259;. &Icirc;nainte de aceasta, pointerul x nu indica nimic.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">Dup&#259; aceasta, toate opera&#539;iile asupra lui y vor afecta valoarea ob&#539;inut&#259; prin pointerul x &#537;i invers, deoarece ambele indic&#259; aceea&#537;i zon&#259; din memorie.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">Pentru a ob&#539;ine valoarea stocat&#259; &icirc;n zona de memorie la care indic&#259; pointerul x, se folose&#537;te expresia *x.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c12">Ob&#539;inerea adresei.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">Folosind conversia pointerului &icirc;ntr-un tip numeric &icirc;ntreg, putem ob&#539;ine adresa din memorie la care indic&#259; pointerul:</span></p><p class="c0"><span class="c3"></span></p><a id="t.630c8dd03fda555333ebfebf1c855f647200e9bb"></a><a id="t.4"></a><table class="c1"><tr class="c2"><td class="c13" colspan="1" rowspan="1"><p class="c10"><span class="c9">int</span><span class="c5">* x; </span><span class="c7">// definirea unui pointer</span><span class="c5"><br></span><span class="c9">int</span><span class="c5">&nbsp;y = </span><span class="c6">10</span><span class="c5">; </span><span class="c7">// definim o variabil&#259;</span><span class="c5"><br> <br>x = &amp;y; </span><span class="c7">// pointerul x acum indic&#259; adresa variabilei y</span><span class="c5"><br> <br></span><span class="c7">// ob&#539;inem adresa variabilei y</span><span class="c5"><br></span><span class="c9">ulong</span><span class="c5">&nbsp;addr = (</span><span class="c9">ulong</span><span class="c5">)x;<br>Console.WriteLine(</span><span class="c18">$&quot;Adresa variabilei y: {addr}&quot;</span><span class="c5">);</span></p></td></tr></table><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">Pentru a ob&#539;ine adresa, se folose&#537;te conversia &icirc;ntr-un tip uint, long sau ulong. Deoarece valoarea unei adrese este un num&#259;r &icirc;ntreg, iar pe sistemele pe 32 de bi&#539;i, intervalul de adrese este de la 0 la 4.000.000.000, adresa poate fi stocat&#259; &icirc;ntr-o variabil&#259; de tip uint/int. Pe sistemele pe 64 de bi&#539;i, intervalul adreselor disponibile este mult mai mare, deci &icirc;n acest caz este mai bine s&#259; se foloseasc&#259; ulong pentru a evita eroarea de dep&#259;&#537;ire.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c12">Pointer c&#259;tre alt pointer.</span></p><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">Declara&#539;ia &#537;i utilizarea unui pointer c&#259;tre alt pointer:</span></p><p class="c0"><span class="c3"></span></p><a id="t.71093c1df1a0c0074453264ea2efd90d460ab23f"></a><a id="t.5"></a><table class="c1"><tr class="c2"><td class="c13" colspan="1" rowspan="1"><p class="c10"><span class="c9">unsafe</span><span class="c5"><br>{<br> &nbsp; &nbsp;</span><span class="c9">int</span><span class="c5">* x; </span><span class="c7">// definirea unui pointer</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c9">int</span><span class="c5">&nbsp;y = </span><span class="c6">10</span><span class="c5">; </span><span class="c7">// definim o variabil&#259;</span><span class="c5"><br> <br> &nbsp; &nbsp;x = &amp;y; </span><span class="c7">// pointerul x acum indic&#259; adresa variabilei y</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c9">int</span><span class="c5">&nbsp;z = &amp;x; </span><span class="c7">// pointerul z acum indic&#259; adresa pointerului x</span><span class="c5"><br> &nbsp; &nbsp;z = z + </span><span class="c6">40</span><span class="c5">; </span><span class="c7">// schimbarea pointerului z va duce la schimbarea variabilei y</span><span class="c5"><br> &nbsp; &nbsp;Console.WriteLine(y); </span><span class="c7">// variabila y=50</span><span class="c5"><br> &nbsp; &nbsp;Console.WriteLine(z); </span><span class="c7">// variabila z=50</span><span class="c5"><br>}</span></p></td></tr></table><p class="c0"><span class="c3"></span></p><p class="c8"><span class="c3">Acest cod ilustreaz&#259; cum pointerul z, care indic&#259; adresa pointerului x, poate fi folosit pentru a modifica valoarea la care indic&#259; x, afect&acirc;nd astfel &#537;i valoarea variabilei y.</span></p><p class="c0"><span class="c3"></span></p></body></html>