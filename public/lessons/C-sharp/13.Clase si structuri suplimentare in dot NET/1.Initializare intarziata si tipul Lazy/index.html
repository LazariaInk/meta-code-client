<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><link rel="stylesheet" type="text/css" href="/lessons/styles.css"></head><body class="c13 doc-content"><p class="c0"><span class="c16">Ini&#539;ializare &icirc;nt&acirc;rziat&#259; &#537;i tipul Lazy.</span></p><p class="c0 c7"><span class="c4"></span></p><p class="c0"><span class="c4">O aplica&#539;ie poate folosi numeroase clase &#537;i obiecte. Totu&#537;i, exist&#259; posibilitatea ca nu toate obiectele create s&#259; fie utilizate, mai ales &icirc;n cazul aplica&#539;iilor mari. De exemplu:</span></p><p class="c0 c7"><span class="c4"></span></p><a id="t.46f933e6df40d42f1aa3e29842c11241cc606a52"></a><a id="t.0"></a><table class="c10"><tr class="c9"><td class="c12" colspan="1" rowspan="1"><p class="c3"><span class="c6">class</span><span class="c1">&nbsp;</span><span class="c11">Reader</span><span class="c1"><br>{<br> &nbsp; &nbsp;Library library = </span><span class="c6">new</span><span class="c1">&nbsp;Library();<br> &nbsp; &nbsp;</span><span class="c6">public</span><span class="c1">&nbsp;</span><span class="c6">void</span><span class="c1">&nbsp;</span><span class="c11">ReadBook</span><span class="c1">()<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;library.GetBook();<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(</span><span class="c2">&quot;Citim o carte tip&#259;rit&#259;&quot;</span><span class="c1">);<br> &nbsp; &nbsp;}<br><br> &nbsp; &nbsp;</span><span class="c6">public</span><span class="c1">&nbsp;</span><span class="c6">void</span><span class="c1">&nbsp;</span><span class="c11">ReadEbook</span><span class="c1">()<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(</span><span class="c2">&quot;Citim o carte pe computer&quot;</span><span class="c1">);<br> &nbsp; &nbsp;}<br>}<br><br></span><span class="c6">class</span><span class="c1">&nbsp;</span><span class="c11">Library</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span class="c6">private</span><span class="c1">&nbsp;</span><span class="c6">string</span><span class="c1">[] books = </span><span class="c6">new</span><span class="c1">&nbsp;</span><span class="c6">string</span><span class="c1">[</span><span class="c14">99</span><span class="c1">];<br><br> &nbsp; &nbsp;</span><span class="c6">public</span><span class="c1">&nbsp;</span><span class="c6">void</span><span class="c1">&nbsp;</span><span class="c11">GetBook</span><span class="c1">()<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(</span><span class="c2">&quot;D&#259;m o carte cititorului&quot;</span><span class="c1">);<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></table><p class="c0 c7"><span class="c4"></span></p><p class="c0"><span class="c4">Exist&#259; o clas&#259; Library, care reprezint&#259; o bibliotec&#259; &#537;i stocheaz&#259; un anumit set de c&#259;r&#539;i sub form&#259; de matrice. Exist&#259; &#537;i o clas&#259; Reader, care stocheaz&#259; o referin&#539;&#259; la un obiect de tip bibliotec&#259;, &icirc;n care este &icirc;nregistrat. Cititorul are definite dou&#259; metode: una pentru citirea unei c&#259;r&#539;i electronice &#537;i alta pentru citirea unei c&#259;r&#539;i obi&#537;nuite. Pentru a citi o carte obi&#537;nuit&#259;, este necesar s&#259; apel&#259;m metoda clasei Library pentru a ob&#539;ine acea carte.</span></p><p class="c0 c7"><span class="c4"></span></p><p class="c0"><span class="c4">Dar ce se &icirc;nt&acirc;mpl&#259; dac&#259; cititorul nu va trebui s&#259; citeasc&#259; deloc o carte obi&#537;nuit&#259;, ci doar c&#259;r&#539;i electronice, de exemplu, &icirc;n urm&#259;torul caz:</span></p><p class="c0 c7"><span class="c4"></span></p><a id="t.734ef2ba811731eeb61d5c103f8830545d6c78c9"></a><a id="t.1"></a><table class="c10"><tr class="c9"><td class="c12" colspan="1" rowspan="1"><p class="c3"><span class="c1">Reader reader = </span><span class="c6">new</span><span class="c1">&nbsp;Reader();<br>reader.ReadEbook();</span></p></td></tr></table><p class="c0 c7"><span class="c4"></span></p><p class="c0"><span class="c4">&Icirc;n acest caz, obiectul library din clasa cititor nu va fi folosit deloc &#537;i va ocupa doar spa&#539;iu &icirc;n memorie, de&#537;i nu este necesar.</span></p><p class="c0 c7"><span class="c4"></span></p><p class="c0"><span class="c5">Pentru astfel de cazuri &icirc;n .NET este definit&#259; clasa special&#259;</span><span class="c15">&nbsp;Lazy&lt;T&gt;</span><span class="c4">. S&#259; modific&#259;m clasa cititor astfel:</span></p><p class="c0 c7"><span class="c4"></span></p><a id="t.7316f0361bb5b6e250b07dfab30242f6abd63753"></a><a id="t.2"></a><table class="c10"><tr class="c9"><td class="c12" colspan="1" rowspan="1"><p class="c3"><span class="c6">class</span><span class="c1">&nbsp;</span><span class="c11">Reader</span><span class="c1"><br>{<br> &nbsp; &nbsp;Lazy&lt;Library&gt; library = </span><span class="c6">new</span><span class="c1">&nbsp;Lazy&lt;Library&gt;();<br> &nbsp; &nbsp;</span><span class="c6">public</span><span class="c1">&nbsp;</span><span class="c6">void</span><span class="c1">&nbsp;</span><span class="c11">ReadBook</span><span class="c1">()<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;library.Value.GetBook();<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(</span><span class="c2">&quot;Citim o carte tip&#259;rit&#259;&quot;</span><span class="c1">);<br> &nbsp; &nbsp;}<br><br> &nbsp; &nbsp;</span><span class="c6">public</span><span class="c1">&nbsp;</span><span class="c6">void</span><span class="c1">&nbsp;</span><span class="c11">ReadEbook</span><span class="c1">()<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(</span><span class="c2">&quot;Citim o carte pe computer&quot;</span><span class="c1">);<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></table><p class="c0 c7"><span class="c4"></span></p><p class="c0"><span class="c5">Clasa Library r&#259;m&acirc;ne neschimbat&#259;. Dar acum clasa Reader con&#539;ine o referin&#539;&#259; la bibliotec&#259; sub forma unui obiect </span><span class="c5 c8">Lazy&lt;Library&gt;</span><span class="c5">. Iar pentru a accesa biblioteca &#537;i metodele acesteia, trebuie s&#259; folosim expresia</span><span class="c5 c8">&nbsp;library.Value</span><span class="c4">&nbsp;- aceasta este obiectul Library.</span></p><p class="c0 c7"><span class="c4"></span></p><p class="c0"><span class="c4">Ce schimb&#259; &icirc;n comportamentul clasei Reader aceast&#259; modificare? S&#259; analiz&#259;m utilizarea ei:</span></p><p class="c0 c7"><span class="c4"></span></p><a id="t.54a9ec94666aea60d625bf4f4faa6875aad5f370"></a><a id="t.3"></a><table class="c10"><tr class="c9"><td class="c12" colspan="1" rowspan="1"><p class="c3"><span class="c1">Reader reader = </span><span class="c6">new</span><span class="c1">&nbsp;Reader();<br>reader.ReadEbook();<br>reader.ReadBook();</span></p></td></tr></table><p class="c0 c7"><span class="c4"></span></p><p class="c0"><span class="c5">Obiectul Library este folosit direct doar la a treia linie, &icirc;n metoda </span><span class="c5 c8">reader.ReadBook(),</span><span class="c5">&nbsp;care la r&acirc;ndul s&#259;u apeleaz&#259; metoda </span><span class="c5 c8">library.Value.GetBook()</span><span class="c5">. Prin urmare, p&acirc;n&#259; la a treia linie, obiectul Library utilizat de cititor nu va fi creat. Dac&#259; nu vom folosi metoda </span><span class="c5 c8">reader.ReadBook()</span><span class="c5">&nbsp;&icirc;n program, atunci obiectul bibliotecii nu va fi creat deloc, evit&acirc;nd astfel costurile suplimentare de memorie. Astfel,</span><span class="c5 c8">&nbsp;Lazy&lt;T&gt; </span><span class="c4">ne garanteaz&#259; c&#259; obiectul va fi creat doar atunci c&acirc;nd este necesar.</span></p><p class="c0 c7"><span class="c4"></span></p></body></html>