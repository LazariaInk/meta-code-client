<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><link rel="stylesheet" type="text/css" href="/lessons/styles.css"></head><body class="c19 doc-content"><p class="c3"><span class="c15">Crearea thread-urilor. Delegatul ThreadStart.</span></p><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">Limbajul C# permite rularea &#537;i executarea &icirc;n cadrul aplica&#539;iei a mai multor thread-uri care se vor executa simultan.</span></p><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c18">Pentru crearea unui thread se folose&#537;te unul dintre constructorii clasei </span><span class="c14">Thread</span><span class="c9">:</span></p><p class="c3 c6"><span class="c9"></span></p><ul class="c4 lst-kix_posqdd9hbn5w-0 start"><li class="c3 c17 c16 li-bullet-0"><span class="c14">Thread(ThreadStart)</span><span class="c9">: ca parametru prime&#537;te un obiect de delegat ThreadStart, care reprezint&#259; ac&#539;iunea ce va fi executat&#259; &icirc;n thread</span></li></ul><p class="c3 c6 c16"><span class="c9"></span></p><ul class="c4 lst-kix_posqdd9hbn5w-0"><li class="c3 c17 c16 li-bullet-0"><span class="c14">Thread(ThreadStart, Int32)</span><span class="c9">: &icirc;n plus fa&#539;&#259; de delegatul ThreadStart, prime&#537;te o valoare numeric&#259; ce stabile&#537;te dimensiunea stivei alocate pentru acest thread</span></li></ul><p class="c3 c6 c16"><span class="c9"></span></p><ul class="c4 lst-kix_posqdd9hbn5w-0"><li class="c3 c16 c17 li-bullet-0"><span class="c14">Thread(ParameterizedThreadStart)</span><span class="c9">: ca parametru prime&#537;te un obiect de delegat ParameterizedThreadStart, care reprezint&#259; ac&#539;iunea ce va fi executat&#259; &icirc;n thread</span></li></ul><p class="c3 c6 c16"><span class="c9"></span></p><ul class="c4 lst-kix_posqdd9hbn5w-0"><li class="c3 c17 c16 li-bullet-0"><span class="c14">Thread(ParameterizedThreadStart, Int32)</span><span class="c9">: &icirc;mpreun&#259; cu delegatul ParameterizedThreadStart, prime&#537;te o valoare numeric&#259; ce stabile&#537;te dimensiunea stivei pentru acest thread</span></li></ul><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">Indiferent de constructorul folosit pentru creare, trebuie s&#259; definim ac&#539;iunea ce va fi executat&#259; &icirc;n thread. &Icirc;n acest articol, vom examina utilizarea delegatului ThreadStart. Acest delegat reprezint&#259; o ac&#539;iune care nu prime&#537;te niciun parametru &#537;i nu returneaz&#259; nicio valoare:</span></p><p class="c3 c6"><span class="c9"></span></p><a id="t.6107f95c19964cea0e75e9cdda9e2f1290b5e20c"></a><a id="t.0"></a><table class="c7"><tr class="c11"><td class="c5" colspan="1" rowspan="1"><p class="c0"><span class="c10">public</span><span class="c2">&nbsp;</span><span class="c10">delegate</span><span class="c2">&nbsp;</span><span class="c10">void</span><span class="c2">&nbsp;</span><span class="c13">ThreadStart</span><span class="c2">();</span></p></td></tr></table><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">Adic&#259;, pentru acest delegat, trebuie s&#259; definim o metod&#259; de tip void care nu prime&#537;te niciun parametru. Exemple de definire a thread-urilor:</span></p><p class="c3 c6"><span class="c9"></span></p><a id="t.1127b3a09d785153864c6532b32917f3c14f4751"></a><a id="t.1"></a><table class="c7"><tr class="c11"><td class="c5" colspan="1" rowspan="1"><p class="c0"><span class="c2">Thread myThread1 = </span><span class="c10">new</span><span class="c2">&nbsp;Thread(Print); <br>Thread myThread2 = </span><span class="c10">new</span><span class="c2">&nbsp;Thread(</span><span class="c10">new</span><span class="c2">&nbsp;ThreadStart(Print));<br>Thread myThread3 = </span><span class="c10">new</span><span class="c2">&nbsp;Thread(()=&gt;Console.WriteLine(</span><span class="c8">&quot;Hello Threads&quot;</span><span class="c2">));<br><br></span><span class="c10">void</span><span class="c2">&nbsp;</span><span class="c13">Print</span><span class="c2">() =&gt; Console.WriteLine(</span><span class="c8">&quot;Hello Threads&quot;</span><span class="c2">);</span></p></td></tr></table><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c18">Pentru a porni un nou thread, se folose&#537;te metoda </span><span class="c14">Start </span><span class="c9">a clasei Thread:</span></p><p class="c3 c6"><span class="c9"></span></p><a id="t.4f213c77819ddefa61834a8a08cc0a128c6f92ce"></a><a id="t.2"></a><table class="c7"><tr class="c11"><td class="c5" colspan="1" rowspan="1"><p class="c0"><span class="c10">using</span><span class="c2">&nbsp;System.Threading;<br><br></span><span class="c12">// cre&#259;m un nou thread</span><span class="c2"><br>Thread myThread1 = </span><span class="c10">new</span><span class="c2">&nbsp;Thread(Print); <br>Thread myThread2 = </span><span class="c10">new</span><span class="c2">&nbsp;Thread(</span><span class="c10">new</span><span class="c2">&nbsp;ThreadStart(Print));<br>Thread myThread3 = </span><span class="c10">new</span><span class="c2">&nbsp;Thread(()=&gt;Console.WriteLine(</span><span class="c8">&quot;Hello Threads&quot;</span><span class="c2">));<br><br>myThread1.Start(); &nbsp;</span><span class="c12">// pornim thread-ul myThread1</span><span class="c2"><br>myThread2.Start(); &nbsp;</span><span class="c12">// pornim thread-ul myThread2</span><span class="c2"><br>myThread3.Start(); &nbsp;</span><span class="c12">// pornim thread-ul myThread3</span><span class="c2"><br><br></span><span class="c10">void</span><span class="c2">&nbsp;</span><span class="c13">Print</span><span class="c2">() =&gt; Console.WriteLine(</span><span class="c8">&quot;Hello Threads&quot;</span><span class="c2">);</span></p></td></tr></table><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">Avantajul thread-urilor este c&#259; ele pot fi executate simultan. De exemplu:</span></p><p class="c3 c6"><span class="c9"></span></p><a id="t.b6eb560b7a3cec938364cc45345b5f80c565a1f7"></a><a id="t.3"></a><table class="c7"><tr class="c11"><td class="c5" colspan="1" rowspan="1"><p class="c0"><span class="c10">using</span><span class="c2">&nbsp;System.Threading;<br><br></span><span class="c12">// cre&#259;m un nou thread</span><span class="c2"><br>Thread myThread = </span><span class="c10">new</span><span class="c2">&nbsp;Thread(Print);<br></span><span class="c12">// pornim thread-ul myThread</span><span class="c2"><br>myThread.Start();<br><br></span><span class="c12">// ac&#539;iuni executate &icirc;n thread-ul principal</span><span class="c2"><br></span><span class="c10">for</span><span class="c2">&nbsp;(</span><span class="c10">int</span><span class="c2">&nbsp;i = </span><span class="c1">0</span><span class="c2">; i &lt; </span><span class="c1">5</span><span class="c2">; i++)<br>{<br> &nbsp; &nbsp;Console.WriteLine(</span><span class="c8">$&quot;Thread-ul principal: {i}&quot;</span><span class="c2">);<br> &nbsp; &nbsp;Thread.Sleep(</span><span class="c1">300</span><span class="c2">);<br>}<br><br></span><span class="c12">// ac&#539;iuni executate &icirc;n al doilea thread</span><span class="c2"><br></span><span class="c10">void</span><span class="c2">&nbsp;</span><span class="c13">Print</span><span class="c2">()<br>{<br> &nbsp; &nbsp;</span><span class="c10">for</span><span class="c2">&nbsp;(</span><span class="c10">int</span><span class="c2">&nbsp;i = </span><span class="c1">0</span><span class="c2">; i &lt; </span><span class="c1">5</span><span class="c2">; i++)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(</span><span class="c8">$&quot;Al doilea thread: {i}&quot;</span><span class="c2">);<br> &nbsp; &nbsp; &nbsp; &nbsp;Thread.Sleep(</span><span class="c1">400</span><span class="c2">);<br> &nbsp; &nbsp;}<br>}</span></p></td></tr></table><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">Aici, noul thread va executa ac&#539;iunile definite &icirc;n metoda Print, adic&#259; va afi&#537;a pe consol&#259; numerele de la 0 la 4. Dup&#259; fiecare afi&#537;are, se va produce o &icirc;nt&acirc;rziere de 400 milisecunde.</span></p><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">&Icirc;n thread-ul principal - &icirc;n metoda Main - cre&#259;m &#537;i pornim un nou thread &icirc;n care se execut&#259; metoda Print</span></p><p class="c3 c6"><span class="c9"></span></p><a id="t.e8ec752ac7373ab212b4595786f1bfb866229d4a"></a><a id="t.4"></a><table class="c7"><tr class="c11"><td class="c5" colspan="1" rowspan="1"><p class="c0"><span class="c2">Thread myThread = </span><span class="c10">new</span><span class="c2">&nbsp;Thread(Print);<br>myThread.Start();</span></p></td></tr></table><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">&Icirc;n plus, &icirc;n thread-ul principal, efectu&#259;m ac&#539;iuni similare - afi&#537;&#259;m pe consol&#259; numerele de la 0 la 4 cu o &icirc;nt&acirc;rziere de 300 milisecunde.</span></p><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">Astfel, &icirc;n programul nostru, vor rula simultan thread-ul principal, reprezentat de metoda Main, &#537;i al doilea thread, &icirc;n care se execut&#259; metoda Print. De &icirc;ndat&#259; ce toate thread-urile &icirc;&#537;i vor &icirc;ncheia execu&#539;ia, programul se va &icirc;ncheia. &Icirc;n final, vom ob&#539;ine urm&#259;toarea ie&#537;ire pe consol&#259;:</span></p><p class="c3 c6"><span class="c9"></span></p><a id="t.2d91e4b24ed9e25ab48b127d8d4b325a37eb3286"></a><a id="t.5"></a><table class="c7"><tr class="c11"><td class="c5" colspan="1" rowspan="1"><p class="c0"><span class="c2">Thread-ul principal: </span><span class="c1">0</span><span class="c2"><br>Al doilea thread: </span><span class="c1">0</span><span class="c2"><br>Thread-ul principal: </span><span class="c1">1</span><span class="c2"><br>Al doilea thread: </span><span class="c1">1</span><span class="c2"><br>Thread-ul principal: </span><span class="c1">2</span><span class="c2"><br>Al doilea thread: </span><span class="c1">2</span><span class="c2"><br>Thread-ul principal: </span><span class="c1">3</span><span class="c2"><br>Al doilea thread: </span><span class="c1">3</span><span class="c2"><br>Thread-ul principal: </span><span class="c1">4</span><span class="c2"><br>Al doilea thread: </span><span class="c1">4</span></p></td></tr></table><p class="c3 c6"><span class="c9"></span></p><p class="c3"><span class="c9">&Icirc;n mod similar, putem crea &#537;i porni trei, patru sau un set &icirc;ntreg de noi thread-uri care vor putea rezolva diverse sarcini.</span></p><p class="c3 c6"><span class="c9"></span></p></body></html>