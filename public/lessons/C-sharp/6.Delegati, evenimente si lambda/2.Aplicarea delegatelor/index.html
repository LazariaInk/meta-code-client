<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c17 doc-content">
    <h1 class="c2 c18">Aplicarea delegatelor.</h1>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c15">&Icirc;n tema anterioar&#259;, delega&#539;ii au fost examina&#539;i &icirc;n
            detaliu. Totu&#537;i, exemplele date poate c&#259; nu arat&#259; adev&#259;rata putere a delegatelor,
            deoarece metodele necesare &icirc;n acest caz pot fi apelate direct f&#259;r&#259; niciun delegat. Cu toate
            acestea, partea cea mai puternic&#259; a delegatelor const&#259; &icirc;n faptul c&#259; ele permit
        </span><span class="c1">delegarea </span><span class="c8">execut&#259;rii unui cod extern. &#536;i &icirc;n
            momentul scrierii programului, putem s&#259; nu &#537;tim ce cod va fi executat. Pur &#537;i simplu
            apel&#259;m delegatul. Iar ce metod&#259; va fi executat&#259; efectiv la apelarea delegatului, va fi decis
            ulterior.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">S&#259; lu&#259;m un exemplu detaliat. S&#259; presupunem c&#259; avem o clas&#259;
            care descrie un cont bancar:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.88df9bdca8d93ca2f8e35e7a767a849096a20986"></a><a
        id="t.0"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c6">public</span><span class="c0">&nbsp;</span><span
                        class="c6">class</span><span class="c0">&nbsp;</span><span class="c3">Account</span><span
                        class="c0"><br>{<br> &nbsp; &nbsp;</span><span class="c6">int</span><span class="c0">&nbsp;sum;
                    </span><span class="c7">// Variabil&#259; pentru stocarea sumei</span><span class="c0"><br> &nbsp;
                        &nbsp;</span><span class="c7">// prin constructor se stabile&#537;te suma ini&#539;ial&#259;
                        &icirc;n cont</span><span class="c0"><br> &nbsp; &nbsp;</span><span
                        class="c6">public</span><span class="c0">&nbsp;</span><span class="c3">Account</span><span
                        class="c0">(</span><span class="c6">int</span><span class="c0">&nbsp;sum) =&gt; </span><span
                        class="c6">this</span><span class="c0">.sum = sum;<br> &nbsp; &nbsp;</span><span class="c7">//
                        adaug&#259; fonduri &icirc;n cont</span><span class="c0"><br> &nbsp; &nbsp;</span><span
                        class="c6">public</span><span class="c0">&nbsp;</span><span class="c6">void</span><span
                        class="c0">&nbsp;</span><span class="c3">Add</span><span class="c0">(</span><span
                        class="c6">int</span><span class="c0">&nbsp;sum) =&gt; </span><span class="c6">this</span><span
                        class="c0">.sum += sum;<br> &nbsp; &nbsp;</span><span class="c7">// retrage bani din
                        cont</span><span class="c0"><br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">Take</span><span class="c0">(</span><span class="c6">int</span><span
                        class="c0">&nbsp;sum)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c7">// retragem bani dac&#259; sunt suficien&#539;i &icirc;n cont</span><span
                        class="c0"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">if</span><span
                        class="c0">&nbsp;(</span><span class="c6">this</span><span class="c0">.sum &gt;= sum)
                    </span><span class="c6">this</span><span class="c0">.sum -= sum;<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">&Icirc;n variabila sum este stocat&#259; suma din cont. Cu ajutorul constructorului
            se stabile&#537;te suma ini&#539;ial&#259; &icirc;n cont. Metoda Add() serve&#537;te pentru a ad&#259;uga
            bani &icirc;n cont, iar metoda Take - pentru a retrage bani din cont.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">S&#259; presupunem c&#259;, &icirc;n cazul retragerii banilor prin metoda Take,
            trebuie cumva s&#259;-l notific&#259;m pe de&#539;in&#259;torul contului &#537;i, poate, alte obiecte.
            Dac&#259; este vorba de un program de consol&#259;, &#537;i clasa va fi utilizat&#259; &icirc;n acela&#537;i
            proiect &icirc;n care a fost creat&#259;, putem scrie pur &#537;i simplu:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.a6c60abf146882020ba12c97c8a12a4b4006ba30"></a><a
        id="t.1"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c6">public</span><span class="c0">&nbsp;</span><span
                        class="c6">class</span><span class="c0">&nbsp;</span><span class="c3">Account</span><span
                        class="c0"><br>{<br> &nbsp; &nbsp;</span><span class="c6">int</span><span
                        class="c0">&nbsp;sum;<br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c3">Account</span><span class="c0">(</span><span
                        class="c6">int</span><span class="c0">&nbsp;sum) =&gt; </span><span class="c6">this</span><span
                        class="c0">.sum = sum;<br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">Add</span><span class="c0">(</span><span class="c6">int</span><span
                        class="c0">&nbsp;sum) =&gt; </span><span class="c6">this</span><span class="c0">.sum += sum;<br>
                        &nbsp; &nbsp;</span><span class="c6">public</span><span class="c0">&nbsp;</span><span
                        class="c6">void</span><span class="c0">&nbsp;</span><span class="c3">Take</span><span
                        class="c0">(</span><span class="c6">int</span><span class="c0">&nbsp;sum)<br> &nbsp; &nbsp;{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">if</span><span class="c0">&nbsp;(</span><span
                        class="c6">this</span><span class="c0">.sum &gt;= sum)<br> &nbsp; &nbsp; &nbsp; &nbsp;{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">this</span><span
                        class="c0">.sum -= sum;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;Console.WriteLine(</span><span class="c16">$&quot;S-au retras {sum}
                        unit&#259;&#539;i.&quot;</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Dar ce facem dac&#259; clasa noastr&#259; este planificat&#259; s&#259; fie
            utilizat&#259; &icirc;n alte proiecte, de exemplu, &icirc;ntr-o aplica&#539;ie grafic&#259; pe Windows Forms
            sau WPF, &icirc;ntr-o aplica&#539;ie mobil&#259;, &icirc;ntr-o aplica&#539;ie web. Acolo linia de
            notificare</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.ec0a5261488aadf6b73717a3fa87d95cbe8f99b8"></a><a
        id="t.2"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c0">Console.WriteLine(</span><span class="c16">$&quot;S-au retras {sum}
                        unit&#259;&#539;i.&quot;</span><span class="c0">);</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">nu va avea mare sens.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Mai mult, clasa noastr&#259; Account va fi utilizat&#259; de al&#539;i dezvoltatori
            sub forma unei biblioteci de clase separate. &#536;i ace&#537;ti dezvoltatori vor dori s&#259; notifice
            retragerea fondurilor &icirc;ntr-un alt mod, despre care nici nu putem b&#259;nui &icirc;n momentul scrierii
            clasei. Prin urmare, notificarea primitiv&#259; sub forma unei linii de cod</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.ec0a5261488aadf6b73717a3fa87d95cbe8f99b8"></a><a
        id="t.3"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c0">Console.WriteLine(</span><span class="c16">$&quot;S-au retras {sum}
                        unit&#259;&#539;i.&quot;</span><span class="c0">);</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">nu este cea mai bun&#259; solu&#539;ie &icirc;n acest caz. Iar delega&#539;ii permit
            delegarea definirii ac&#539;iunii din clas&#259; c&#259;tre un cod extern, care va folosi aceast&#259;
            clas&#259;.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">S&#259; modific&#259;m clasa, aplic&acirc;nd delega&#539;ii:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.0eb65236a70fd345e29e27253f3d990d27bb2a18"></a><a
        id="t.4"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c7">// Declar&#259;m delegatul</span><span class="c0"><br></span><span
                        class="c6">public</span><span class="c0">&nbsp;</span><span class="c6">delegate</span><span
                        class="c0">&nbsp;</span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">AccountHandler</span><span class="c0">(</span><span class="c6">string</span><span
                        class="c0">&nbsp;message);<br></span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c6">class</span><span class="c0">&nbsp;</span><span
                        class="c3">Account</span><span class="c0"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c6">int</span><span class="c0">&nbsp;sum;<br> &nbsp; &nbsp;</span><span class="c7">//
                        Cre&#259;m o variabil&#259; delegat</span><span class="c0"><br> &nbsp; &nbsp;AccountHandler?
                        taken;<br> &nbsp; &nbsp;</span><span class="c6">public</span><span class="c0">&nbsp;</span><span
                        class="c3">Account</span><span class="c0">(</span><span class="c6">int</span><span
                        class="c0">&nbsp;sum) =&gt; </span><span class="c6">this</span><span class="c0">.sum = sum;<br>
                        &nbsp; &nbsp;</span><span class="c7">// &Icirc;nregistr&#259;m delegatul</span><span
                        class="c0"><br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">RegisterHandler</span><span class="c0">(AccountHandler del)<br> &nbsp; &nbsp;{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;taken = del;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span
                        class="c6">public</span><span class="c0">&nbsp;</span><span class="c6">void</span><span
                        class="c0">&nbsp;</span><span class="c3">Add</span><span class="c0">(</span><span
                        class="c6">int</span><span class="c0">&nbsp;sum) =&gt; </span><span class="c6">this</span><span
                        class="c0">.sum += sum;<br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">Take</span><span class="c0">(</span><span class="c6">int</span><span
                        class="c0">&nbsp;sum)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c6">if</span><span class="c0">&nbsp;(</span><span class="c6">this</span><span
                        class="c0">.sum &gt;= sum)<br> &nbsp; &nbsp; &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c6">this</span><span class="c0">.sum -= sum;<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c7">// apel&#259;m delegatul,
                        transmit&acirc;ndu-i mesajul</span><span class="c0"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;taken?.Invoke(</span><span class="c16">$&quot;S-au retras {sum}
                        unit&#259;&#539;i.&quot;</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c6">else</span><span class="c0"><br> &nbsp; &nbsp;
                        &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;taken?.Invoke(</span><span
                        class="c16">$&quot;Fonduri insuficiente. Sold: {</span><span class="c6">this</span><span
                        class="c16">.sum} unit&#259;&#539;i.&quot;</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c15">Pentru delegarea ac&#539;iunii aici este definit delegatul </span><span
            class="c1">AccountHandler</span><span class="c15">. Acest delegat corespunde oric&#259;ror metode care au
            tipul </span><span class="c1">void </span><span class="c15">&#537;i accept&#259; un parametru de tip
        </span><span class="c1">string</span><span class="c8">.</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.d7999d7555e23d697ef000c81f56fee4e492c397"></a><a
        id="t.5"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c6">public</span><span class="c0">&nbsp;</span><span
                        class="c6">delegate</span><span class="c0">&nbsp;</span><span class="c6">void</span><span
                        class="c0">&nbsp;</span><span class="c3">AccountHandler</span><span class="c0">(</span><span
                        class="c6">string</span><span class="c0">&nbsp;message);</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c15">&Icirc;n clasa Account definim variabila </span><span class="c10">taken</span><span
            class="c8">, care reprezint&#259; acest delegat:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.a0b5b34e7908601d9f4343703ad901458036aec0"></a><a
        id="t.6"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c0">AccountHandler? taken;</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Acum trebuie s&#259; leg&#259;m aceast&#259; variabil&#259; de o ac&#539;iune
            concret&#259;, care va fi executat&#259;. Putem folosi diferite modalit&#259;&#539;i pentru a transmite
            delegatul &icirc;n clas&#259;. &Icirc;n acest caz, se define&#537;te o metod&#259; special&#259;
            RegisterHandler, &icirc;n care &icirc;n variabila taken este transmis&#259; ac&#539;iunea real&#259;:</span>
    </p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.bbd95bb08cbe6e63c1ca5c724a4416cede6c3b0a"></a><a
        id="t.7"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c6">public</span><span class="c0">&nbsp;</span><span
                        class="c6">void</span><span class="c0">&nbsp;</span><span class="c3">RegisterHandler</span><span
                        class="c0">(AccountHandler del)<br>{<br> &nbsp; &nbsp;taken = del;<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Astfel, delegatul este stabilit, &#537;i acum poate fi apelat. Apelul delegatului se
            realizeaz&#259; &icirc;n metoda Take:</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">p</span></p><a id="t.cd9b38c1d86a57cd5964672be3f5be1d6cecdea8"></a><a id="t.8"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c0">ublic </span><span class="c6">void</span><span
                        class="c0">&nbsp;</span><span class="c3">Take</span><span class="c0">(</span><span
                        class="c6">int</span><span class="c0">&nbsp;sum)<br>{<br> &nbsp; &nbsp;</span><span
                        class="c6">if</span><span class="c0">&nbsp;(</span><span class="c6">this</span><span
                        class="c0">.sum &gt;= sum)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c6">this</span><span class="c0">.sum -= sum;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c7">// apel&#259;m delegatul, transmit&acirc;ndu-i mesajul</span><span class="c0"><br>
                        &nbsp; &nbsp; &nbsp; &nbsp;taken?.Invoke(</span><span class="c16">$&quot;S-au retras {sum}
                        unit&#259;&#539;i.&quot;</span><span class="c0">);<br> &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;</span><span class="c6">else</span><span class="c0"><br> &nbsp; &nbsp;{<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;taken?.Invoke(</span><span class="c16">$&quot;Fonduri insuficiente. Sold:
                        {</span><span class="c6">this</span><span class="c16">.sum} unit&#259;&#539;i.&quot;</span><span
                        class="c0">);<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Deoarece delegatul AccountHandler accept&#259; ca parametru un &#537;ir de caractere,
            la apelarea variabilei taken() putem transmite &icirc;n acest apel un mesaj concret. &Icirc;n func&#539;ie
            de faptul dac&#259; s-a realizat retragerea banilor sau nu, &icirc;n apelul delegatului sunt transmise
            mesaje diferite.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Deci, &icirc;n locul delegatului vor fi efectuate ac&#539;iunile care sunt transmise
            delegatului &icirc;n metoda RegisterHandler. &#536;i, repet, la apelarea delegatului nu &#537;tim ce
            ac&#539;iuni vor fi. Aici doar transmitem ac&#539;iunilor mesajul despre reu&#537;ita sau nereu&#537;ita
            retragerii.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Acum test&#259;m clasa &icirc;n programul principal:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.280cc02bb70005e297bc65233c0c5df7868c3f15"></a><a
        id="t.9"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c7">// cre&#259;m un cont bancar</span><span class="c0"><br>Account account =
                    </span><span class="c6">new</span><span class="c0">&nbsp;Account(</span><span
                        class="c5">200</span><span class="c0">);<br></span><span class="c7">// Ad&#259;ug&#259;m
                        &icirc;n delegat o referin&#539;&#259; la metoda PrintSimpleMessage</span><span
                        class="c0"><br>account.RegisterHandler(PrintSimpleMessage);<br></span><span class="c7">//
                        &Icirc;ncerc&#259;m de dou&#259; ori la r&acirc;nd s&#259; retragem bani</span><span
                        class="c0"><br>account.Take(</span><span class="c5">100</span><span
                        class="c0">);<br>account.Take(</span><span class="c5">150</span><span
                        class="c0">);<br><br></span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">PrintSimpleMessage</span><span class="c0">(</span><span class="c6">string</span><span
                        class="c0">&nbsp;message) =&gt; Console.WriteLine(message);</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c15">Aici, prin metoda RegisterHandler, variabilei taken din clasa Account i se transmite
            o referin&#539;&#259; la metoda PrintSimpleMessage. Aceast&#259; metod&#259; corespunde delegatului
            AccountHandler. Astfel, acolo unde &icirc;n clasa Account se apeleaz&#259; delegatul taken, &icirc;n
            realitate va fi executat&#259; metoda </span><span class="c10">PrintSimpleMessage</span><span
            class="c8">.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c15">Prin parametrul message, metoda </span><span class="c10">PrintSimpleMessage
        </span><span class="c8">va primi mesajul transmis din delegat &#537;i &icirc;l va afi&#537;a &icirc;n
            consol&#259;:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.efc1db6530acea6344cf41b8ddc137379a32ee63"></a><a
        id="t.10"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c0">S-au retras </span><span class="c5">100</span><span
                        class="c0">&nbsp;unit&#259;&#539;i.<br>Fonduri insuficiente. Sold: </span><span
                        class="c5">100</span><span class="c0">&nbsp;unit&#259;&#539;i.</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Astfel, am creat un mecanism de apel invers pentru clasa Account, care se
            activeaz&#259; &icirc;n cazul retragerii banilor. Aici afi&#537;&#259;m mesajul &icirc;n consol&#259;. Da,
            am putea pur &#537;i simplu s&#259; afi&#537;&#259;m mesajul &icirc;n consol&#259; &#537;i f&#259;r&#259;
            delega&#539;i. Totu&#537;i, cu un delegat, pentru clasa Account nu conteaz&#259; cum se afi&#537;eaz&#259;
            acest mesaj. Clasa Account nici nu &#537;tie ce se va face efectiv ca urmare a retragerii banilor. Ea doar
            trimite o notificare despre acest lucru prin delegat.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">&Icirc;n rezultat, dac&#259; cre&#259;m o aplica&#539;ie de consol&#259;, putem
            afi&#537;a mesajul &icirc;n consol&#259; prin delegat. Dac&#259; cre&#259;m o aplica&#539;ie grafic&#259;
            Windows Forms sau WPF, putem afi&#537;a mesajul sub form&#259; de fereastr&#259; grafic&#259;. Sau putem nu
            doar s&#259; afi&#537;&#259;m mesajul. Putem, de exemplu, s&#259; &icirc;nregistr&#259;m informa&#539;ia
            despre aceast&#259; ac&#539;iune &icirc;ntr-un fi&#537;ier sau s&#259; trimitem o notificare prin e-mail.
            &Icirc;n general, putem trata apelul delegatului prin orice metode. Iar modul de tratare nu va depinde de
            clasa Account.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c13">Ad&#259;ugarea &#537;i eliminarea metodelor &icirc;n delegat.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">De&#537;i &icirc;n exemplul nostru delegatul accepta adresa unei singure metode,
            &icirc;n realitate el poate indica simultan mai multe metode. &Icirc;n plus, dac&#259; este necesar, putem
            elimina referin&#539;ele la anumite metode, astfel &icirc;nc&acirc;t acestea s&#259; nu fie apelate la
            apelul delegatului. A&#537;adar, modific&#259;m &icirc;n clasa Account metoda RegisterHandler &#537;i
            ad&#259;ug&#259;m o nou&#259; metod&#259; UnregisterHandler, care va elimina metodele din lista metodelor
            delegatului:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.eac04037b54787bdf5f8b08b6f20e16d54f87119"></a><a
        id="t.11"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c6">public</span><span class="c0">&nbsp;</span><span
                        class="c6">delegate</span><span class="c0">&nbsp;</span><span class="c6">void</span><span
                        class="c0">&nbsp;</span><span class="c3">AccountHandler</span><span class="c0">(</span><span
                        class="c6">string</span><span class="c0">&nbsp;message);<br></span><span
                        class="c6">public</span><span class="c0">&nbsp;</span><span class="c6">class</span><span
                        class="c0">&nbsp;</span><span class="c3">Account</span><span class="c0"><br>{<br> &nbsp;
                        &nbsp;</span><span class="c6">int</span><span class="c0">&nbsp;sum;<br> &nbsp;
                        &nbsp;AccountHandler? taken;<br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c3">Account</span><span class="c0">(</span><span
                        class="c6">int</span><span class="c0">&nbsp;sum) =&gt; </span><span class="c6">this</span><span
                        class="c0">.sum = sum;<br> &nbsp; &nbsp;</span><span class="c7">// &Icirc;nregistr&#259;m
                        delegatul</span><span class="c0"><br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">RegisterHandler</span><span class="c0">(AccountHandler del)<br><br><br> &nbsp;
                        &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;taken += del;<br> &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;</span><span class="c7">// Anularea &icirc;nregistr&#259;rii delegatului</span><span
                        class="c0"><br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">UnregisterHandler</span><span class="c0">(AccountHandler del)<br> &nbsp; &nbsp;{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;taken -= del; </span><span class="c7">// elimin&#259;m
                        delegatul</span><span class="c0"><br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span
                        class="c6">public</span><span class="c0">&nbsp;</span><span class="c6">void</span><span
                        class="c0">&nbsp;</span><span class="c3">Add</span><span class="c0">(</span><span
                        class="c6">int</span><span class="c0">&nbsp;sum) =&gt; </span><span class="c6">this</span><span
                        class="c0">.sum += sum;<br> &nbsp; &nbsp;</span><span class="c6">public</span><span
                        class="c0">&nbsp;</span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">Take</span><span class="c0">(</span><span class="c6">int</span><span
                        class="c0">&nbsp;sum)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c6">if</span><span class="c0">&nbsp;(</span><span class="c6">this</span><span
                        class="c0">.sum &gt;= sum)<br> &nbsp; &nbsp; &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c6">this</span><span class="c0">.sum -= sum;<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;taken?.Invoke(</span><span class="c16">$&quot;S-au retras {sum}
                        unit&#259;&#539;i.&quot;</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c6">else</span><span class="c0"><br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;taken?.Invoke(</span><span class="c16">$&quot;Fonduri insuficiente.
                        Sold: {</span><span class="c6">this</span><span class="c16">.sum}
                        unit&#259;&#539;i.&quot;</span><span class="c0">);<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c15">&Icirc;n prima metod&#259;, delega&#539;ii </span><span class="c10">taken
        </span><span class="c15">&#537;i </span><span class="c10">del </span><span class="c15">sunt combina&#539;i
            &icirc;ntr-unul singur, care apoi este atribuit variabilei </span><span class="c10">taken</span><span
            class="c15">. &Icirc;n a doua metod&#259;, din variabila </span><span class="c10">taken </span><span
            class="c15">este eliminat delegatul </span><span class="c10">del</span><span class="c8">.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c8">Aplic&#259;m noile metode:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.814e97f7d2d712cb7493b334773a07208bdf9a1d"></a><a
        id="t.12"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c0">Account account = </span><span class="c6">new</span><span
                        class="c0">&nbsp;Account(</span><span class="c5">200</span><span class="c0">);<br></span><span
                        class="c7">// Ad&#259;ug&#259;m &icirc;n delegat referin&#539;e la metode</span><span
                        class="c0"><br>account.RegisterHandler(PrintSimpleMessage);<br>account.RegisterHandler(PrintColorMessage);<br></span><span
                        class="c7">// &Icirc;ncerc&#259;m de dou&#259; ori la r&acirc;nd s&#259; retragem
                        bani</span><span class="c0"><br>account.Take(</span><span class="c5">100</span><span
                        class="c0">);<br>account.Take(</span><span class="c5">150</span><span
                        class="c0">);<br><br></span><span class="c7">// Elimin&#259;m delegatul</span><span
                        class="c0"><br>account.UnregisterHandler(PrintColorMessage);<br></span><span class="c7">//
                        &icirc;ncerc&#259;m din nou s&#259; retragem bani</span><span
                        class="c0"><br>account.Take(</span><span class="c5">50</span><span
                        class="c0">);<br><br></span><span class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">PrintSimpleMessage</span><span class="c0">(</span><span class="c6">string</span><span
                        class="c0">&nbsp;message) =&gt; Console.WriteLine(message);<br></span><span
                        class="c6">void</span><span class="c0">&nbsp;</span><span
                        class="c3">PrintColorMessage</span><span class="c0">(</span><span class="c6">string</span><span
                        class="c0">&nbsp;message)<br>{<br> &nbsp; &nbsp;</span><span class="c7">// Set&#259;m culoarea
                        ro&#537;ie a caracterelor</span><span class="c0"><br> &nbsp; &nbsp;Console.ForegroundColor =
                        ConsoleColor.Red;<br> &nbsp; &nbsp;Console.WriteLine(message);<br> &nbsp; &nbsp;</span><span
                        class="c7">// Reset&#259;m set&#259;rile de culoare</span><span class="c0"><br> &nbsp;
                        &nbsp;Console.ResetColor();<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c15">Pentru testare, am creat &icirc;nc&#259; o metod&#259; - PrintColorMessage, care
            afi&#537;eaz&#259; acela&#537;i mesaj doar c&#259; &icirc;n culoarea ro&#537;ie. Referin&#539;a la
            aceast&#259; metod&#259; este, de asemenea, transmis&#259; &icirc;n metoda RegisterHandler, &#537;i astfel
            va fi primit&#259; de variabila </span><span class="c10">taken</span><span class="c8">.</span></p>
    <p class="c2 c11"><span class="c8"></span></p>
    <p class="c2"><span class="c15">&Icirc;n linia account.</span><span
            class="c10">UnregisterHandler(PrintColorMessage);</span><span class="c8">&nbsp;aceast&#259; metod&#259; este
            eliminat&#259; din lista apelurilor delegatului, deci aceast&#259; metod&#259; nu va mai fi executat&#259;.
            Afi&#537;area &icirc;n consol&#259; va avea urm&#259;toarea form&#259;:</span></p>
    <p class="c2 c11"><span class="c8"></span></p><a id="t.4b24013fcb7bd8e97bb88f169ccb9ae774bd75e4"></a><a
        id="t.13"></a>
    <table class="c12">
        <tr class="c14">
            <td class="c9" colspan="1" rowspan="1">
                <p class="c4"><span class="c0">S-au retras </span><span class="c5">100</span><span
                        class="c0">&nbsp;unit&#259;&#539;i.<br>S-au retras </span><span class="c5">100</span><span
                        class="c0">&nbsp;unit&#259;&#539;i.<br>Fonduri insuficiente. Sold: </span><span
                        class="c5">100</span><span class="c0">&nbsp;unit&#259;&#539;i.<br>Fonduri insuficiente. Sold:
                    </span><span class="c5">100</span><span class="c0">&nbsp;unit&#259;&#539;i.<br>S-au retras
                    </span><span class="c5">50</span><span class="c0">&nbsp;unit&#259;&#539;i.</span></p>
            </td>
        </tr>
    </table>
    <p class="c2 c11"><span class="c8"></span></p>
</body>

</html>