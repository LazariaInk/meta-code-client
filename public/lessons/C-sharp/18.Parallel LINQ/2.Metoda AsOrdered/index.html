<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><link rel="stylesheet" type="text/css" href="/lessons/styles.css"></head><body class="c15 doc-content"><p class="c5"><span class="c16">Metoda AsOrdered.</span></p><p class="c5 c7"><span class="c1"></span></p><p class="c5"><span class="c1">&Icirc;n timpul execu&#539;iei unei interog&#259;ri paralele, ordinea datelor &icirc;n setul de rezultate poate fi imprevizibil&#259;. De exemplu:</span></p><p class="c5 c7"><span class="c1"></span></p><a id="t.776c491274a4393f3acd84e28ac2eee2e89caee2"></a><a id="t.0"></a><table class="c9"><tr class="c10"><td class="c6" colspan="1" rowspan="1"><p class="c11"><span class="c4">int</span><span class="c0">[] numbers = </span><span class="c4">new</span><span class="c0">&nbsp;</span><span class="c4">int</span><span class="c0">[] { </span><span class="c2">-2</span><span class="c0">, </span><span class="c2">-1</span><span class="c0">, </span><span class="c2">0</span><span class="c0">, </span><span class="c2">1</span><span class="c0">, </span><span class="c2">2</span><span class="c0">, </span><span class="c2">3</span><span class="c0">, </span><span class="c2">4</span><span class="c0">, </span><span class="c2">5</span><span class="c0">, </span><span class="c2">6</span><span class="c0">, </span><span class="c2">7</span><span class="c0">, </span><span class="c2">8</span><span class="c0">, };<br></span><span class="c4">var</span><span class="c0">&nbsp;squares = </span><span class="c4">from</span><span class="c0">&nbsp;n </span><span class="c4">in</span><span class="c0">&nbsp;numbers.AsParallel()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4">where</span><span class="c0">&nbsp;n &gt; </span><span class="c2">0</span><span class="c0"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4">select</span><span class="c0">&nbsp;</span><span class="c8">Square</span><span class="c0">(n);<br> <br></span><span class="c4">foreach</span><span class="c0">&nbsp;(</span><span class="c4">var</span><span class="c0">&nbsp;n </span><span class="c4">in</span><span class="c0">&nbsp;squares)<br> &nbsp; &nbsp;Console.WriteLine(n);<br> <br></span><span class="c4">int</span><span class="c0">&nbsp;</span><span class="c8">Square</span><span class="c0">(</span><span class="c4">int</span><span class="c0">&nbsp;n) =&gt; n * n;</span></p></td></tr></table><p class="c5 c7"><span class="c1"></span></p><p class="c5"><span class="c1">&Icirc;n acest caz, programul calculeaz&#259; p&#259;tratele numerelor care sunt mai mari de 0. Totu&#537;i, rezultatul programului poate fi neordonat:</span></p><p class="c5 c7"><span class="c1"></span></p><a id="t.0f19797a539ec99a185132616fa682d1bdc6675e"></a><a id="t.1"></a><table class="c9"><tr class="c10"><td class="c6" colspan="1" rowspan="1"><p class="c11"><span class="c2">1</span><span class="c0"><br></span><span class="c2">16</span><span class="c0"><br></span><span class="c2">49</span><span class="c0"><br></span><span class="c2">4</span><span class="c0"><br></span><span class="c2">25</span><span class="c0"><br></span><span class="c2">64</span><span class="c0"><br></span><span class="c2">9</span><span class="c0"><br></span><span class="c2">36</span></p></td></tr></table><p class="c5 c7"><span class="c1"></span></p><p class="c5"><span class="c1">Adic&#259; datele sunt unite &icirc;ntr-un set comun f&#259;r&#259; a fi ordonate.</span></p><p class="c5 c7"><span class="c1"></span></p><p class="c5"><span class="c1">Dac&#259; &icirc;n interogare se aplic&#259; operatori sau metode de sortare, datele sunt ordonate automat:</span></p><p class="c5 c7"><span class="c1"></span></p><a id="t.54e3b5abf03a417b3bf71cade20430b420599a67"></a><a id="t.2"></a><table class="c9"><tr class="c10"><td class="c6" colspan="1" rowspan="1"><p class="c11"><span class="c4">var</span><span class="c0">&nbsp;squares = </span><span class="c4">from</span><span class="c0">&nbsp;n </span><span class="c4">in</span><span class="c0">&nbsp;numbers.AsParallel()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4">where</span><span class="c0">&nbsp;n &gt; </span><span class="c2">0</span><span class="c0"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4">orderby</span><span class="c0">&nbsp;n &nbsp;</span><span class="c12">// sortare</span><span class="c0"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c4">select</span><span class="c0">&nbsp;</span><span class="c8">Square</span><span class="c0">(n);</span></p></td></tr></table><p class="c5 c7"><span class="c1"></span></p><p class="c5"><span class="c14">Totu&#537;i, operatorul </span><span class="c3">orderby </span><span class="c14">sau metoda </span><span class="c3">OrderBy </span><span class="c14">nu sunt &icirc;ntotdeauna folosite &icirc;n interog&#259;ri. Mai mult, acestea ordoneaz&#259; setul de rezultate conform rezultatelor &#537;i nu conform secven&#539;ei ini&#539;iale. &Icirc;n aceste cazuri, putem aplica metoda </span><span class="c13">AsOrdered()</span><span class="c1">:</span></p><p class="c5 c7"><span class="c1"></span></p><a id="t.c5e5b99b944e1a7d30418de908c3a41c1b182c74"></a><a id="t.3"></a><table class="c9"><tr class="c10"><td class="c6" colspan="1" rowspan="1"><p class="c11"><span class="c4">var</span><span class="c0">&nbsp;squares = </span><span class="c4">from</span><span class="c0">&nbsp;n </span><span class="c4">in</span><span class="c0">&nbsp;numbers.AsParallel().AsOrdered()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">where</span><span class="c0">&nbsp;n &gt; </span><span class="c2">0</span><span class="c0"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">select</span><span class="c0">&nbsp;</span><span class="c8">Square</span><span class="c0">(n);</span></p></td></tr></table><p class="c5 c7"><span class="c1"></span></p><p class="c5"><span class="c1">&Icirc;n acest caz, rezultatul va fi ordonat conform modului &icirc;n care elementele sunt dispuse &icirc;n secven&#539;a ini&#539;ial&#259;:</span></p><p class="c5 c7"><span class="c1"></span></p><a id="t.3e19cc18add54cac5f48d2fc1dd221dd221b5e44"></a><a id="t.4"></a><table class="c9"><tr class="c10"><td class="c6" colspan="1" rowspan="1"><p class="c11"><span class="c2">1</span><span class="c0"><br></span><span class="c2">4</span><span class="c0"><br></span><span class="c2">9</span><span class="c0"><br></span><span class="c2">16</span><span class="c0"><br></span><span class="c2">25</span><span class="c0"><br></span><span class="c2">36</span><span class="c0"><br></span><span class="c2">49</span><span class="c0"><br></span><span class="c2">64</span></p></td></tr></table><p class="c5 c7"><span class="c1"></span></p><p class="c5"><span class="c1">Totu&#537;i, trebuie s&#259; &icirc;n&#539;elegem c&#259; ordonarea &icirc;n cadrul unei opera&#539;iuni paralele cre&#537;te costurile, astfel &icirc;nc&acirc;t o astfel de interogare va fi executat&#259; mai &icirc;ncet dec&acirc;t una neordonat&#259;. Dac&#259; sarcina nu necesit&#259; returnarea unui set ordonat, este mai bine s&#259; nu se aplice metoda AsOrdered.</span></p><p class="c5 c7"><span class="c1"></span></p><p class="c5"><span class="c14">&Icirc;n plus, dac&#259; &icirc;n program urmeaz&#259; s&#259; se efectueze anumite manipul&#259;ri cu setul de date ob&#539;inut, dar ordonarea nu mai este necesar&#259;, putem aplica metoda </span><span class="c13">AsUnordered()</span><span class="c1">:</span></p><p class="c5 c7"><span class="c1"></span></p><a id="t.46893b0a0f83c89ae60796ef85955a0c7aa1596b"></a><a id="t.5"></a><table class="c9"><tr class="c10"><td class="c6" colspan="1" rowspan="1"><p class="c11"><span class="c4">int</span><span class="c0">[] numbers = </span><span class="c4">new</span><span class="c0">&nbsp;</span><span class="c4">int</span><span class="c0">[] { </span><span class="c2">-2</span><span class="c0">, </span><span class="c2">-1</span><span class="c0">, </span><span class="c2">0</span><span class="c0">, </span><span class="c2">1</span><span class="c0">, </span><span class="c2">2</span><span class="c0">, </span><span class="c2">3</span><span class="c0">, </span><span class="c2">4</span><span class="c0">, </span><span class="c2">5</span><span class="c0">, </span><span class="c2">6</span><span class="c0">, </span><span class="c2">7</span><span class="c0">, </span><span class="c2">8</span><span class="c0">, };<br></span><span class="c4">var</span><span class="c0">&nbsp;squares = </span><span class="c4">from</span><span class="c0">&nbsp;n </span><span class="c4">in</span><span class="c0">&nbsp;numbers.AsParallel().AsOrdered()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">where</span><span class="c0">&nbsp;n &gt; </span><span class="c2">0</span><span class="c0"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">select</span><span class="c0">&nbsp;</span><span class="c8">Square</span><span class="c0">(n);<br> <br></span><span class="c12">// select&#259;m numerele mai mari de 4 f&#259;r&#259; a ordona rezultatul</span><span class="c0"><br></span><span class="c4">var</span><span class="c0">&nbsp;query = </span><span class="c4">from</span><span class="c0">&nbsp;n </span><span class="c4">in</span><span class="c0">&nbsp;squares.AsUnordered()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">where</span><span class="c0">&nbsp;n &gt; </span><span class="c2">4</span><span class="c0"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">select</span><span class="c0">&nbsp;n;<br> <br></span><span class="c4">foreach</span><span class="c0">&nbsp;(</span><span class="c4">var</span><span class="c0">&nbsp;n </span><span class="c4">in</span><span class="c0">&nbsp;query)<br> &nbsp; &nbsp;Console.WriteLine(n);<br> <br></span><span class="c4">int</span><span class="c0">&nbsp;</span><span class="c8">Square</span><span class="c0">(</span><span class="c4">int</span><span class="c0">&nbsp;n) =&gt; n * n;</span></p></td></tr></table><p class="c5 c7"><span class="c1"></span></p><p class="c5 c7"><span class="c1"></span></p></body></html>