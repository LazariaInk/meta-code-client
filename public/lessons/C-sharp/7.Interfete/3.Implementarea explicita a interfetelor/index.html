<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c12 doc-content">
    <h1 class="c10 c16">Implementarea explicită a interfețelor.</h1>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">Pe l&acirc;ng&#259; utilizarea implicit&#259; a interfe&#539;elor, care a fost
            discutat&#259; &icirc;n articolul anterior, exist&#259; &#537;i implementarea explicit&#259; a
            interfe&#539;ei. &Icirc;n cazul implement&#259;rii explicite, se men&#539;ioneaz&#259; numele metodei sau
            propriet&#259;&#539;ii &icirc;mpreun&#259; cu numele interfe&#539;ei. &Icirc;n acest caz, nu putem folosi
            niciun fel de modificatori:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.edc777dd9d17baa06346f52a0a6c127d22beb9f5"></a><a id="t.0"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">interface</span><span class="c1">&nbsp;</span><span
                        class="c4">IAction</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;</span><span class="c4">Move</span><span
                        class="c1">();<br>}<br></span><span class="c0">class</span><span class="c1">&nbsp;</span><span
                        class="c4">BaseAction</span><span class="c1">&nbsp;: </span><span class="c4">IAction</span><span
                        class="c1"><br>{<br> &nbsp; &nbsp;</span><span class="c0">void</span><span
                        class="c1">&nbsp;IAction.Move() =&gt; Console.WriteLine(</span><span class="c13">&quot;Move in
                        Base Class&quot;</span><span class="c1">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c15">Trebuie s&#259; avem &icirc;n vedere c&#259;, la implementarea explicit&#259; a
            interfe&#539;ei, metodele &#537;i propriet&#259;&#539;ile acesteia</span><span class="c6">&nbsp;nu fac parte
        </span><span class="c2">din interfa&#539;a clasei. Prin urmare, nu putem accesa direct aceste metode &#537;i
            propriet&#259;&#539;i prin obiectul clasei:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.99e61dfe730e0192b5d6cd7a9095fbe7378aadfd"></a><a id="t.1"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">BaseAction baseAction1 = </span><span class="c0">new</span><span
                        class="c1">&nbsp;BaseAction();<br> <br></span><span class="c9">// baseAction1.Move(); &nbsp;// !
                        Eroare - &icirc;n BaseAction nu exist&#259; metoda Move</span><span class="c1"><br></span><span
                        class="c9">// este necesar&#259; conversia la tipul IAction</span><span
                        class="c1"><br></span><span class="c9">// conversie nesigur&#259;</span><span
                        class="c1"><br>((IAction)baseAction1).Move(); &nbsp; <br></span><span class="c9">// conversie
                        sigur&#259;</span><span class="c1"><br></span><span class="c0">if</span><span
                        class="c1">&nbsp;(baseAction1 </span><span class="c0">is</span><span class="c1">&nbsp;IAction
                        action) action.Move();<br></span><span class="c9">// sau a&#537;a</span><span
                        class="c1"><br>IAction baseAction2 = </span><span class="c0">new</span><span
                        class="c1">&nbsp;BaseAction();<br>baseAction2.Move();</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">&Icirc;n ce situa&#539;ie poate fi necesar&#259; implementarea explicit&#259; a
            interfe&#539;ei? De exemplu, c&acirc;nd o clas&#259; implementeaz&#259; mai multe interfe&#539;e, dar
            acestea au aceea&#537;i metod&#259; cu acela&#537;i rezultat &#537;i aceia&#537;i parametri:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.dd258930608ec322804c4c86e68e1d8a59d0273d"></a><a id="t.2"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">class</span><span class="c1">&nbsp;</span><span
                        class="c4">Person</span><span class="c1">&nbsp;: </span><span class="c4">ISchool</span><span
                        class="c1">, </span><span class="c4">IUniversity</span><span class="c1"><br>{<br> &nbsp;
                        &nbsp;</span><span class="c0">public</span><span class="c1">&nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;</span><span class="c4">Study</span><span
                        class="c1">() =&gt; Console.WriteLine(</span><span class="c13">&quot;&Icirc;nv&#259;&#539;are la
                        &#537;coal&#259; sau la universitate&quot;</span><span class="c1">);<br>}<br></span><span
                        class="c0">interface</span><span class="c1">&nbsp;</span><span class="c4">ISchool</span><span
                        class="c1"><br>{<br> &nbsp; &nbsp;</span><span class="c0">void</span><span
                        class="c1">&nbsp;</span><span class="c4">Study</span><span class="c1">();<br>}<br></span><span
                        class="c0">interface</span><span class="c1">&nbsp;</span><span
                        class="c4">IUniversity</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;</span><span class="c4">Study</span><span
                        class="c1">();<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c15">Clasa Person define&#537;te o metod&#259;</span><span
            class="c11">&nbsp;Study()</span><span class="c2">, cre&acirc;nd o implementare comun&#259; pentru ambele
            interfe&#539;e aplicate. Indiferent dac&#259; trat&#259;m obiectul Person ca obiect de tip ISchool sau
            IUniversity, rezultatul metodei va fi acela&#537;i.</span></p>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">Pentru a distinge interfe&#539;ele implementate, trebuie s&#259; aplic&#259;m
            explicit interfa&#539;a:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.732eae7f9a099c938c52822eb50f6bd574caf27a"></a><a id="t.3"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">class</span><span class="c1">&nbsp;</span><span
                        class="c4">Person</span><span class="c1">&nbsp;: </span><span class="c4">ISchool</span><span
                        class="c1">, </span><span class="c4">IUniversity</span><span class="c1"><br>{<br> &nbsp;
                        &nbsp;</span><span class="c0">void</span><span class="c1">&nbsp;ISchool.Study() =&gt;
                        Console.WriteLine(</span><span class="c13">&quot;&Icirc;nv&#259;&#539;are la
                        &#537;coal&#259;&quot;</span><span class="c1">);<br> &nbsp; &nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;IUniversity.Study() =&gt;
                        Console.WriteLine(</span><span class="c13">&quot;&Icirc;nv&#259;&#539;are la
                        universitate&quot;</span><span class="c1">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">Utilizare:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.0ba48b7a54b78f9217ae3bf631a976d0715ba95d"></a><a id="t.4"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">Person person = </span><span class="c0">new</span><span
                        class="c1">&nbsp;Person();<br>
                        <br>((ISchool)person).Study();<br>((IUniversity)person).Study();</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">O alt&#259; situa&#539;ie este atunci c&acirc;nd &icirc;n clasa de baz&#259;
            interfa&#539;a este deja implementat&#259;, dar este necesar&#259; implementarea diferit&#259; a acesteia
            &icirc;n clasa derivat&#259;:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.492827228f3c7996e51b1d0c2eae56055631b5f6"></a><a id="t.5"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c0">interface</span><span class="c1">&nbsp;</span><span
                        class="c4">IAction</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;</span><span class="c4">Move</span><span
                        class="c1">();<br>}<br></span><span class="c0">class</span><span class="c1">&nbsp;</span><span
                        class="c4">BaseAction</span><span class="c1">&nbsp;: </span><span class="c4">IAction</span><span
                        class="c1"><br>{<br> &nbsp; &nbsp;</span><span class="c0">public</span><span
                        class="c1">&nbsp;</span><span class="c0">void</span><span class="c1">&nbsp;</span><span
                        class="c4">Move</span><span class="c1">() =&gt; Console.WriteLine(</span><span
                        class="c13">&quot;Move in BaseAction&quot;</span><span class="c1">);<br>}<br></span><span
                        class="c0">class</span><span class="c1">&nbsp;</span><span class="c4">HeroAction</span><span
                        class="c1">&nbsp;: </span><span class="c4">BaseAction</span><span class="c1">, </span><span
                        class="c4">IAction</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;IAction.Move() =&gt; Console.WriteLine(</span><span
                        class="c13">&quot;Move in HeroAction&quot;</span><span class="c1">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">De&#537;i clasa de baz&#259; BaseAction a implementat deja interfa&#539;a IAction,
            clasa derivat&#259; o implementeaz&#259; &icirc;n mod diferit. Utilizarea claselor:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.6648427d771b7fb5d912033b3b1a6dfbd1669bb6"></a><a id="t.6"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">HeroAction action1 = </span><span class="c0">new</span><span
                        class="c1">&nbsp;HeroAction();<br>action1.Move(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c9">// Move in BaseAction</span><span
                        class="c1"><br>((IAction)action1).Move(); </span><span class="c9">// Move in
                        HeroAction</span><span class="c1"><br> <br>IAction action2 = </span><span
                        class="c0">new</span><span class="c1">&nbsp;HeroAction();<br>action2.Move(); &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">// Move in HeroAction</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c17">Modificatori de acces.</span></p>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">Membrii interfe&#539;ei pot avea diferi&#539;i modificatori de acces. Dac&#259;
            modificatorul de acces nu este public, ci altul, atunci la implementarea metodei, propriet&#259;&#539;ii sau
            evenimentului interfe&#539;ei &icirc;n clase &#537;i structuri, putem folosi dou&#259; metode. &Icirc;n
            primul r&acirc;nd, putem folosi &#537;i implementarea explicit&#259; a interfe&#539;ei, implement&acirc;nd
            toate necesit&#259;&#539;ile interfe&#539;ei f&#259;r&#259; modificatori de acces:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.f646ce785c1f4d5c11df6ec618a4082ab5a01aed"></a><a id="t.7"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">IMovable tom = </span><span class="c0">new</span><span
                        class="c1">&nbsp;Person(</span><span class="c13">&quot;Tom&quot;</span><span
                        class="c1">);<br></span><span class="c9">// abonare la eveniment</span><span
                        class="c1"><br>tom.MoveEvent += () =&gt; Console.WriteLine(</span><span
                        class="c13">$&quot;{tom.Name} is moving&quot;</span><span class="c1">);<br>tom.Move();<br>
                        <br></span><span class="c0">delegate</span><span class="c1">&nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;</span><span class="c4">MoveHandler</span><span
                        class="c1">(); &nbsp; &nbsp;</span><span class="c9">// delegat de mi&#537;care</span><span
                        class="c1"><br></span><span class="c0">interface</span><span class="c1">&nbsp;</span><span
                        class="c4">IMovable</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c0">protected</span><span class="c1">&nbsp;</span><span class="c0">internal</span><span
                        class="c1">&nbsp;</span><span class="c0">void</span><span class="c1">&nbsp;</span><span
                        class="c4">Move</span><span class="c1">();<br> &nbsp; &nbsp;</span><span
                        class="c0">protected</span><span class="c1">&nbsp;</span><span class="c0">internal</span><span
                        class="c1">&nbsp;</span><span class="c0">string</span><span class="c1">&nbsp;Name { </span><span
                        class="c0">get</span><span class="c1">; }<br> &nbsp; &nbsp;</span><span
                        class="c0">protected</span><span class="c1">&nbsp;</span><span class="c0">internal</span><span
                        class="c1">&nbsp;</span><span class="c0">event</span><span class="c1">&nbsp;MoveHandler
                        MoveEvent;<br>}<br></span><span class="c0">class</span><span class="c1">&nbsp;</span><span
                        class="c4">Person</span><span class="c1">&nbsp;: </span><span class="c4">IMovable</span><span
                        class="c1"><br>{<br> &nbsp; &nbsp;</span><span class="c0">string</span><span
                        class="c1">&nbsp;name;<br> &nbsp; &nbsp;</span><span class="c9">// implementarea explicit&#259;
                        a evenimentului - se creeaz&#259; o variabil&#259; suplimentar&#259;</span><span class="c1"><br>
                        &nbsp; &nbsp;MoveHandler? moveEvent;<br> &nbsp; &nbsp;</span><span class="c0">event</span><span
                        class="c1">&nbsp;MoveHandler IMovable.MoveEvent<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c0">add</span><span class="c1">&nbsp;=&gt; moveEvent += </span><span
                        class="c0">value</span><span class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">remove</span><span class="c1">&nbsp;=&gt; moveEvent -= </span><span
                        class="c0">value</span><span class="c1">;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span
                        class="c9">// implementarea explicit&#259; a propriet&#259;&#539;ii - ca
                        auto-proprietate</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c0">string</span><span class="c1">&nbsp;IMovable.Name { </span><span
                        class="c0">get</span><span class="c1">&nbsp;=&gt; name; }<br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c4">Person</span><span
                        class="c1">(</span><span class="c0">string</span><span class="c1">&nbsp;name) =&gt; </span><span
                        class="c0">this</span><span class="c1">.name = name;<br> &nbsp; &nbsp;</span><span class="c9">//
                        implementarea explicit&#259; a metodei</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;IMovable.Move()<br> &nbsp; &nbsp;{<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;Console.WriteLine(</span><span class="c13">$&quot;{name} is
                        walking&quot;</span><span class="c1">);<br> &nbsp; &nbsp; &nbsp; &nbsp;moveEvent?.Invoke();<br>
                        &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">&Icirc;n acest caz, trebuie s&#259; avem &icirc;n vedere c&#259; putem accesa direct
            aceste metode, propriet&#259;&#539;i &#537;i evenimente doar prin variabila interfe&#539;ei, nu prin
            variabila clasei.</span></p>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c15">O alternativ&#259; o reprezint&#259; implementarea implicit&#259; cu modificatorul
        </span><span class="c6">public</span><span class="c2">:</span></p>
    <p class="c3"><span class="c2"></span></p><a id="t.4660ab98688a27c7978aa4f67a0d27bcbe09f349"></a><a id="t.8"></a>
    <table class="c14">
        <tr class="c8">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">Person tom = </span><span class="c0">new</span><span
                        class="c1">&nbsp;Person(</span><span class="c13">&quot;Tom&quot;</span><span
                        class="c1">);<br></span><span class="c9">// abonare la eveniment</span><span
                        class="c1"><br>tom.MoveEvent += () =&gt; Console.WriteLine(</span><span
                        class="c13">$&quot;{tom.Name} is moving&quot;</span><span class="c1">);<br>tom.Move();<br>
                        <br></span><span class="c0">delegate</span><span class="c1">&nbsp;</span><span
                        class="c0">void</span><span class="c1">&nbsp;</span><span class="c4">MoveHandler</span><span
                        class="c1">();<br> <br></span><span class="c0">interface</span><span
                        class="c1">&nbsp;</span><span class="c4">IMovable</span><span class="c1"><br>{<br> &nbsp;
                        &nbsp;</span><span class="c0">protected</span><span class="c1">&nbsp;</span><span
                        class="c0">internal</span><span class="c1">&nbsp;</span><span class="c0">void</span><span
                        class="c1">&nbsp;</span><span class="c4">Move</span><span class="c1">();<br> &nbsp;
                        &nbsp;</span><span class="c0">protected</span><span class="c1">&nbsp;</span><span
                        class="c0">internal</span><span class="c1">&nbsp;</span><span class="c0">string</span><span
                        class="c1">&nbsp;Name { </span><span class="c0">get</span><span class="c1">; }<br> &nbsp;
                        &nbsp;</span><span class="c0">protected</span><span class="c1">&nbsp;</span><span
                        class="c0">internal</span><span class="c1">&nbsp;</span><span class="c0">event</span><span
                        class="c1">&nbsp;MoveHandler MoveEvent;<br>}<br></span><span class="c0">class</span><span
                        class="c1">&nbsp;</span><span class="c4">Person</span><span class="c1">&nbsp;: </span><span
                        class="c4">IMovable</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c0">string</span><span class="c1">&nbsp;name;<br> &nbsp; &nbsp;</span><span class="c9">//
                        implementarea explicit&#259; a evenimentului - se creeaz&#259; o variabil&#259;
                        suplimentar&#259;</span><span class="c1"><br> &nbsp; &nbsp;MoveHandler? moveEvent;<br> &nbsp;
                        &nbsp;</span><span class="c9">// implementarea implicit&#259; a evenimentului cu modificatorul
                        public</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c0">public</span><span
                        class="c1">&nbsp;</span><span class="c0">event</span><span class="c1">&nbsp;MoveHandler
                        MoveEvent<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">add</span><span class="c1">&nbsp;=&gt; moveEvent += </span><span
                        class="c0">value</span><span class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">remove</span><span class="c1">&nbsp;=&gt; moveEvent -= </span><span
                        class="c0">value</span><span class="c1">;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span
                        class="c9">// implementarea implicit&#259; a propriet&#259;&#539;ii - ca auto-proprietate, dar
                        cu modificatorul public</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c0">string</span><span
                        class="c1">&nbsp;Name { </span><span class="c0">get</span><span class="c1">&nbsp;=&gt; name;
                        }<br> &nbsp; &nbsp;</span><span class="c0">public</span><span class="c1">&nbsp;</span><span
                        class="c4">Person</span><span class="c1">(</span><span class="c0">string</span><span
                        class="c1">&nbsp;name) =&gt; </span><span class="c0">this</span><span class="c1">.name =
                        name;<br> &nbsp; &nbsp;</span><span class="c9">// implementarea implicit&#259; a metodei, dar cu
                        modificatorul public</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c0">void</span><span
                        class="c1">&nbsp;</span><span class="c4">Move</span><span class="c1">()<br> &nbsp; &nbsp;{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(</span><span class="c13">$&quot;{name} is
                        walking&quot;</span><span class="c1">);<br> &nbsp; &nbsp; &nbsp; &nbsp;moveEvent?.Invoke();<br>
                        &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c2"></span></p>
    <p class="c10"><span class="c2">&Icirc;n acest caz, metodele, propriet&#259;&#539;ile &#537;i evenimentele
            interfe&#539;ei pot fi accesate prin variabila clasei.</span></p>
    <p class="c3"><span class="c2"></span></p>
</body>

</html>