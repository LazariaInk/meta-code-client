<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c17 doc-content">
    <h1 class="c1 c16">Sortarea obiectelor. Interfa»õa IComparable.</h1>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Majoritatea claselor de colec&#539;ii &icirc;ncorporate &icirc;n .NET &#537;i
            array-urile suport&#259; sortarea. Cu ajutorul unei metode, de obicei numit&#259; Sort(), po&#539;i sorta
            imediat &icirc;ntregul set de date &icirc;n ordine cresc&#259;toare. De exemplu:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.457e235a86a0dd7a1c72c5cd451ccab45e626479"></a><a id="t.0"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">int</span><span class="c0">[] numbers = </span><span
                        class="c2">new</span><span class="c0">&nbsp;</span><span class="c2">int</span><span
                        class="c0">[] { </span><span class="c9">97</span><span class="c0">, </span><span
                        class="c9">45</span><span class="c0">, </span><span class="c9">32</span><span class="c0">,
                    </span><span class="c9">65</span><span class="c0">, </span><span class="c9">83</span><span
                        class="c0">, </span><span class="c9">23</span><span class="c0">, </span><span
                        class="c9">15</span><span class="c0">&nbsp;};<br>Array.Sort(numbers);<br></span><span
                        class="c2">foreach</span><span class="c0">&nbsp;(</span><span class="c2">int</span><span
                        class="c0">&nbsp;n </span><span class="c2">in</span><span class="c0">&nbsp;numbers)<br> &nbsp;
                        &nbsp;Console.WriteLine(n);<br></span><span class="c18">// 15 23 32 45 65 83 97</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c12">Totu&#537;i, metoda Sort func&#539;ioneaz&#259; implicit doar pentru seturi de
            tipuri primitive, cum ar fi int sau string. Pentru a sorta seturi de obiecte complexe, se folose&#537;te
            interfa&#539;a </span><span class="c7">IComparable</span><span class="c3">. Aceasta are un singur
            metod&#259;:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.647f6af552f1dbb1dfffbbdc1ba5ba9d43f8186e"></a><a id="t.1"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c2">interface</span><span class="c0">&nbsp;</span><span
                        class="c6">IComparable</span><span class="c0"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c2">int</span><span class="c0">&nbsp;</span><span class="c6">CompareTo</span><span
                        class="c0">(</span><span class="c2">object</span><span class="c0">? o);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c12">Metoda </span><span class="c12 c15">CompareTo </span><span class="c12">este
            destinat&#259; compar&#259;rii obiectului curent cu obiectul trecut ca parametru</span><span
            class="c12 c15">&nbsp;object? o</span><span class="c3">. Returneaz&#259; un num&#259;r &icirc;ntreg care
            poate avea una dintre cele trei valori:</span></p>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">- Mai pu&#539;in de zero: Obiectul curent ar trebui s&#259; fie &icirc;naintea
            obiectului trecut ca parametru.</span></p>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">- Egal cu zero: Ambele obiecte sunt egale.</span></p>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">- Mai mare de zero: Obiectul curent ar trebui s&#259; fie dup&#259; obiectul trecut
            ca parametru.</span></p>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">De exemplu, avem clasa Person:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.b59e1380445e74570b4d7036d74001224b9e06ab"></a><a id="t.2"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">class</span><span class="c0">&nbsp;</span><span
                        class="c6">Person</span><span class="c0">&nbsp;: </span><span class="c6">IComparable</span><span
                        class="c0"><br>{<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">string</span><span class="c0">&nbsp;Name { </span><span
                        class="c2">get</span><span class="c0">; }<br> &nbsp; &nbsp;</span><span
                        class="c2">public</span><span class="c0">&nbsp;</span><span class="c2">int</span><span
                        class="c0">&nbsp;Age { </span><span class="c2">get</span><span class="c0">; </span><span
                        class="c2">set</span><span class="c0">; }<br> &nbsp; &nbsp;</span><span
                        class="c2">public</span><span class="c0">&nbsp;</span><span class="c6">Person</span><span
                        class="c0">(</span><span class="c2">string</span><span class="c0">&nbsp;name, </span><span
                        class="c2">int</span><span class="c0">&nbsp;age)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;Name = name;<br> &nbsp; &nbsp; &nbsp; &nbsp;Age = age;<br> &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c2">int</span><span class="c0">&nbsp;</span><span class="c6">CompareTo</span><span
                        class="c0">(</span><span class="c2">object</span><span class="c0">? o)<br> &nbsp; &nbsp;{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">if</span><span class="c0">(o </span><span
                        class="c2">is</span><span class="c0">&nbsp;Person person) </span><span
                        class="c2">return</span><span class="c0">&nbsp;Name.CompareTo(person.Name);<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c2">else</span><span class="c0">&nbsp;</span><span
                        class="c2">throw</span><span class="c0">&nbsp;</span><span class="c2">new</span><span
                        class="c0">&nbsp;ArgumentException(</span><span class="c8">&quot;Valoarea parametrului este
                        incorect&#259;&quot;</span><span class="c0">);<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Aici, ca criteriu de compara&#539;ie a fost aleas&#259; proprietatea Name a
            obiectului Person. Astfel, compararea se face &icirc;ntre valoarea propriet&#259;&#539;ii Name a obiectului
            curent &#537;i valoarea propriet&#259;&#539;ii Name a obiectului transmis prin parametru. Dac&#259; obiectul
            nu poate fi convertit la tipul Person, se arunc&#259; o excep&#539;ie.</span></p>
    <p class="c1"><span class="c3">Utilizare:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.02cdd688e87ca29d58e1824ac4b45528668fbff7"></a><a id="t.3"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">var</span><span class="c0">&nbsp;tom = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Tom&quot;</span><span class="c0">, </span><span class="c9">37</span><span
                        class="c0">);<br></span><span class="c2">var</span><span class="c0">&nbsp;bob = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Bob&quot;</span><span class="c0">, </span><span class="c9">41</span><span
                        class="c0">);<br></span><span class="c2">var</span><span class="c0">&nbsp;sam = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Sam&quot;</span><span class="c0">, </span><span class="c9">25</span><span
                        class="c0">);<br> <br>Person[] people = { tom, bob, sam };<br>Array.Sort(people);<br>
                        <br></span><span class="c2">foreach</span><span class="c0">&nbsp;(Person person </span><span
                        class="c2">in</span><span class="c0">&nbsp;people)<br>{<br> &nbsp;
                        &nbsp;Console.WriteLine(</span><span class="c8">$&quot;{person.Name} -
                        {person.Age}&quot;</span><span class="c0">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">&#536;i &icirc;n acest caz, ob&#539;inem urm&#259;toarea ie&#537;ire &icirc;n
            consol&#259;:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.84df822ab2ec392c64943a7ae03cfed26f1d67c3"></a><a id="t.4"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c0">Bob - </span><span class="c9">41</span><span class="c0"><br>Sam -
                    </span><span class="c9">25</span><span class="c0"><br>Tom - </span><span class="c9">37</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">Interfa&#539;a IComparable are o versiune generic&#259;, astfel c&#259; putem
            simplifica &#537;i scurta utilizarea acesteia &icirc;n clasa Person:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.758316c20a86cc7ddbc9a5eedbc6c075d05b9696"></a><a id="t.5"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">class</span><span class="c0">&nbsp;</span><span
                        class="c6">Person</span><span class="c0">&nbsp;: </span><span class="c6">IComparable</span><span
                        class="c0">&lt;</span><span class="c6">Person</span><span class="c0">&gt;<br>{<br> &nbsp;
                        &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c2">string</span><span class="c0">&nbsp;Name { </span><span class="c2">get</span><span
                        class="c0">; }<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">int</span><span class="c0">&nbsp;Age { </span><span
                        class="c2">get</span><span class="c0">; </span><span class="c2">set</span><span class="c0">;
                        }<br> &nbsp; &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c6">Person</span><span class="c0">(</span><span class="c2">string</span><span
                        class="c0">&nbsp;name, </span><span class="c2">int</span><span class="c0">&nbsp;age)<br> &nbsp;
                        &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;Name = name;<br> &nbsp; &nbsp; &nbsp; &nbsp;Age =
                        age;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">int</span><span class="c0">&nbsp;</span><span
                        class="c6">CompareTo</span><span class="c0">(Person? person)<br> &nbsp; &nbsp;{<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c2">if</span><span class="c0">(person </span><span
                        class="c2">is</span><span class="c0">&nbsp;</span><span class="c2">null</span><span class="c0">)
                    </span><span class="c2">throw</span><span class="c0">&nbsp;</span><span class="c2">new</span><span
                        class="c0">&nbsp;ArgumentException(</span><span class="c8">&quot;Valoarea parametrului este
                        incorect&#259;&quot;</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c2">return</span><span class="c0">&nbsp;Name.CompareTo(person.Name);<br> &nbsp;
                        &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">&Icirc;n mod similar, putem compara dup&#259; v&acirc;rst&#259;:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.f787a2d50d637892c08fbc053733ea43db04a8c1"></a><a id="t.6"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">class</span><span class="c0">&nbsp;</span><span
                        class="c6">Person</span><span class="c0">&nbsp;: </span><span class="c6">IComparable</span><span
                        class="c0">&lt;</span><span class="c6">Person</span><span class="c0">&gt;<br>{<br> &nbsp;
                        &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c2">string</span><span class="c0">&nbsp;Name { </span><span class="c2">get</span><span
                        class="c0">; }<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">int</span><span class="c0">&nbsp;Age { </span><span
                        class="c2">get</span><span class="c0">; </span><span class="c2">set</span><span class="c0">;
                        }<br> &nbsp; &nbsp;</span><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c6">Person</span><span class="c0">(</span><span class="c2">string</span><span
                        class="c0">&nbsp;name, </span><span class="c2">int</span><span class="c0">&nbsp;age)<br> &nbsp;
                        &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;Name = name;<br> &nbsp; &nbsp; &nbsp; &nbsp;Age =
                        age;<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">int</span><span class="c0">&nbsp;</span><span
                        class="c6">CompareTo</span><span class="c0">(Person? person)<br> &nbsp; &nbsp;{<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c2">if</span><span class="c0">(person </span><span
                        class="c2">is</span><span class="c0">&nbsp;</span><span class="c2">null</span><span class="c0">)
                    </span><span class="c2">throw</span><span class="c0">&nbsp;</span><span class="c2">new</span><span
                        class="c0">&nbsp;ArgumentException(</span><span class="c8">&quot;Valoarea parametrului este
                        incorect&#259;&quot;</span><span class="c0">);<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c2">return</span><span class="c0">&nbsp;Age - person.Age;<br> &nbsp; &nbsp;}<br>}</span>
                </p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c14">Utilizarea comparatorului.</span></p>
    <p class="c1 c4"><span class="c14"></span></p>
    <p class="c1"><span class="c12">&Icirc;n afar&#259; de interfa&#539;a IComparable, platforma .NET ofer&#259; &#537;i
            interfa&#539;a </span><span class="c7">IComparer</span><span class="c3">:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.b8625572fca6888b54ea95fe1dd6e314b43dbeea"></a><a id="t.7"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">public</span><span class="c0">&nbsp;</span><span
                        class="c2">interface</span><span class="c0">&nbsp;</span><span class="c6">IComparer</span><span
                        class="c0">&lt;</span><span class="c6">in</span><span class="c0">&nbsp;</span><span
                        class="c6">T</span><span class="c0">&gt;<br>{<br> &nbsp; &nbsp;</span><span
                        class="c2">int</span><span class="c0">&nbsp;</span><span class="c6">Compare</span><span
                        class="c0">(T? x, T? y);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c12">Metoda </span><span class="c12 c15">Compare </span><span class="c3">este
            destinat&#259; compar&#259;rii a dou&#259; obiecte o1 &#537;i o2. Aceasta returneaz&#259; de asemenea trei
            valori, &icirc;n func&#539;ie de rezultatul compara&#539;iei: dac&#259; primul obiect este mai mare
            dec&acirc;t al doilea, se returneaz&#259; un num&#259;r mai mare dec&acirc;t 0, dac&#259; este mai mic - un
            num&#259;r mai mic dec&acirc;t zero; dac&#259; ambele obiecte sunt egale, se returneaz&#259; zero.</span>
    </p>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">S&#259; cre&#259;m un comparator pentru obiectele Person. S&#259; presupunem c&#259;
            acesta compar&#259; obiectele &icirc;n func&#539;ie de lungimea &#537;irului - valoarea
            propriet&#259;&#539;ii Name:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.117d507a6d5c49af986908da42c1802fc289dea8"></a><a id="t.8"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">class</span><span class="c0">&nbsp;</span><span
                        class="c6">PeopleComparer</span><span class="c0">&nbsp;: </span><span
                        class="c6">IComparer</span><span class="c0">&lt;</span><span class="c6">Person</span><span
                        class="c0">&gt;<br>{<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">int</span><span class="c0">&nbsp;</span><span
                        class="c6">Compare</span><span class="c0">(Person? p1, Person? p2)<br> &nbsp; &nbsp;{<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c2">if</span><span class="c0">(p1 </span><span
                        class="c2">is</span><span class="c0">&nbsp;</span><span class="c2">null</span><span
                        class="c0">&nbsp;|| p2 </span><span class="c2">is</span><span class="c0">&nbsp;</span><span
                        class="c2">null</span><span class="c0">) <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c2">throw</span><span class="c0">&nbsp;</span><span
                        class="c2">new</span><span class="c0">&nbsp;ArgumentException(</span><span
                        class="c8">&quot;Valoarea parametrului este incorect&#259;&quot;</span><span class="c0">);<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2">return</span><span
                        class="c0">&nbsp;p1.Name.Length - p2.Name.Length;<br> &nbsp; &nbsp;}<br>}<br> <br></span><span
                        class="c2">class</span><span class="c0">&nbsp;</span><span class="c6">Person</span><span
                        class="c0"><br>{<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c0">&nbsp;</span><span class="c2">string</span><span class="c0">&nbsp;Name { </span><span
                        class="c2">get</span><span class="c0">; }<br> &nbsp; &nbsp;</span><span
                        class="c2">public</span><span class="c0">&nbsp;</span><span class="c2">int</span><span
                        class="c0">&nbsp;Age { </span><span class="c2">get</span><span class="c0">; </span><span
                        class="c2">set</span><span class="c0">; }<br> &nbsp; &nbsp;</span><span
                        class="c2">public</span><span class="c0">&nbsp;</span><span class="c6">Person</span><span
                        class="c0">(</span><span class="c2">string</span><span class="c0">&nbsp;name, </span><span
                        class="c2">int</span><span class="c0">&nbsp;age)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;Name = name;<br> &nbsp; &nbsp; &nbsp; &nbsp;Age = age;<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c3">&Icirc;n acest caz, se folose&#537;te versiunea generic&#259; a interfe&#539;ei
            IComparer, pentru a evita conversiile inutile de tipuri. Utilizarea comparatorului:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.8e749984d7409dcabda9b3ad12c51c9aaae9aee9"></a><a id="t.9"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c2">var</span><span class="c0">&nbsp;alice = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Alice&quot;</span><span class="c0">, </span><span class="c9">41</span><span
                        class="c0">);<br></span><span class="c2">var</span><span class="c0">&nbsp;tom = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Tom&quot;</span><span class="c0">, </span><span class="c9">37</span><span
                        class="c0">);<br></span><span class="c2">var</span><span class="c0">&nbsp;kate = </span><span
                        class="c2">new</span><span class="c0">&nbsp;Person(</span><span
                        class="c8">&quot;Kate&quot;</span><span class="c0">, </span><span class="c9">25</span><span
                        class="c0">);<br> <br>Person[] people = { alice, tom, kate };<br>Array.Sort(people, </span><span
                        class="c2">new</span><span class="c0">&nbsp;PeopleComparer());<br> <br></span><span
                        class="c2">foreach</span><span class="c0">&nbsp;(Person person </span><span
                        class="c2">in</span><span class="c0">&nbsp;people)<br>{<br> &nbsp;
                        &nbsp;Console.WriteLine(</span><span class="c8">$&quot;{person.Name} -
                        {person.Age}&quot;</span><span class="c0">);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1"><span class="c12">Comparatorul este specificat ca al doilea parametru al metodei</span><span
            class="c12 c15">&nbsp;Array.Sort()</span><span class="c3">. &Icirc;n acest caz, nu conteaz&#259; dac&#259;
            clasa Person implementeaz&#259; interfa&#539;a IComparable sau nu. Regulile de sortare stabilite de
            comparator vor avea prioritate. La &icirc;nceput vor fi obiectele Person cu nume mai scurte, iar la final
            cele cu nume mai lungi:</span></p>
    <p class="c1 c4"><span class="c3"></span></p><a id="t.5757c209834b66566caa8478b20897a84ac658b9"></a><a
        id="t.10"></a>
    <table class="c13">
        <tr class="c5">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c10"><span class="c0">Tom - </span><span class="c9">37</span><span class="c0"><br>Kate -
                    </span><span class="c9">25</span><span class="c0"><br>Alice - </span><span class="c9">41</span></p>
            </td>
        </tr>
    </table>
    <p class="c1 c4"><span class="c3"></span></p>
    <p class="c1 c4"><span class="c3"></span></p>
</body>

</html>