<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><link rel="stylesheet" type="text/css" href="/lessons/styles.css"></head><body class="c21 doc-content"><p class="c7"><span class="c20">LINQ to XML: Crearea unui document XML.</span></p><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c14">O alt&#259; abordare pentru lucrul cu XML este tehnologia</span><span class="c1">&nbsp;LINQ to XML</span><span class="c14">. &Icirc;ntreaga func&#539;ionalitate LINQ to XML se reg&#259;se&#537;te &icirc;n spa&#539;iul de nume</span><span class="c1">&nbsp;System.Xml.Linq</span><span class="c6">. S&#259; analiz&#259;m principalele clase din acest spa&#539;iu de nume:</span></p><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_3324j5llwclp-0 start"><li class="c7 c9 li-bullet-0"><span class="c1">XAttribute</span><span class="c6">: reprezint&#259; un atribut al unui element XML</span></li></ul><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_3324j5llwclp-0"><li class="c7 c9 li-bullet-0"><span class="c1">XComment</span><span class="c6">: reprezint&#259; un comentariu</span></li></ul><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_3324j5llwclp-0"><li class="c7 c9 li-bullet-0"><span class="c1">XDocument</span><span class="c6">: reprezint&#259; &icirc;ntregul document XML</span></li></ul><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_3324j5llwclp-0"><li class="c7 c9 li-bullet-0"><span class="c1">XElement</span><span class="c6">: reprezint&#259; un element XML individual</span></li></ul><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c14">Clasa principal&#259; este </span><span class="c14 c19">XElement</span><span class="c6">, care permite ob&#539;inerea elementelor &icirc;ncorporate &#537;i gestionarea acestora. Printre metodele sale, se remarc&#259; urm&#259;toarele:</span></p><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_nuaioepv0ev5-0 start"><li class="c7 c9 li-bullet-0"><span class="c1">Add()</span><span class="c6">: adaug&#259; un nou atribut sau element</span></li></ul><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_nuaioepv0ev5-0"><li class="c7 c9 li-bullet-0"><span class="c1">Attributes()</span><span class="c6">: returneaz&#259; o colec&#539;ie de atribute pentru acest element</span></li></ul><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_nuaioepv0ev5-0"><li class="c7 c9 li-bullet-0"><span class="c1">Elements()</span><span class="c6">: returneaz&#259; toate elementele copil ale acestui element</span></li></ul><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_nuaioepv0ev5-0"><li class="c7 c9 li-bullet-0"><span class="c1">Remove()</span><span class="c6">: elimin&#259; acest element din obiectul p&#259;rinte</span></li></ul><p class="c7 c11"><span class="c6"></span></p><ul class="c16 lst-kix_nuaioepv0ev5-0"><li class="c7 c9 li-bullet-0"><span class="c1">RemoveAll()</span><span class="c6">: elimin&#259; toate elementele copil &#537;i atributele acestui element</span></li></ul><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c6">Acum, s&#259; folosim func&#539;ionalitatea LINQ to XML &#537;i s&#259; cre&#259;m un nou document XML:</span></p><p class="c7 c11"><span class="c6"></span></p><a id="t.89678aec32a30f002361baf65a532c1b0e9c3f57"></a><a id="t.0"></a><table class="c12"><tr class="c17"><td class="c2" colspan="1" rowspan="1"><p class="c13"><span class="c10">using</span><span class="c5">&nbsp;System.Xml.Linq;<br><br>XDocument xdoc = </span><span class="c10">new</span><span class="c5">&nbsp;XDocument();<br></span><span class="c0">// cre&#259;m primul element person</span><span class="c5"><br>XElement tom = </span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;person&quot;</span><span class="c5">);<br></span><span class="c0">// cre&#259;m atributul name</span><span class="c5"><br>XAttribute tomNameAttr = </span><span class="c10">new</span><span class="c5">&nbsp;XAttribute(</span><span class="c3">&quot;name&quot;</span><span class="c5">, </span><span class="c3">&quot;Tom&quot;</span><span class="c5">);<br></span><span class="c0">// cre&#259;m dou&#259; elemente company &#537;i age </span><span class="c5"><br>XElement tomCompanyElem = </span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;company&quot;</span><span class="c5">, </span><span class="c3">&quot;Microsoft&quot;</span><span class="c5">);<br>XElement tomAgeElem = </span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;age&quot;</span><span class="c5">, </span><span class="c15">37</span><span class="c5">);<br></span><span class="c0">// ad&#259;ug&#259;m atributul &#537;i elementele &icirc;n primul element person</span><span class="c5"><br>tom.Add(tomNameAttr);<br>tom.Add(tomCompanyElem);<br>tom.Add(tomAgeElem);<br><br></span><span class="c0">// cre&#259;m al doilea element person</span><span class="c5"><br>XElement bob = </span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;person&quot;</span><span class="c5">);<br></span><span class="c0">// cre&#259;m pentru el atributul name</span><span class="c5"><br>XAttribute bobNameAttr = </span><span class="c10">new</span><span class="c5">&nbsp;XAttribute(</span><span class="c3">&quot;name&quot;</span><span class="c5">, </span><span class="c3">&quot;Bob&quot;</span><span class="c5">);<br></span><span class="c0">// &#537;i dou&#259; elemente - company &#537;i age</span><span class="c5"><br>XElement bobCompanyElem = </span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;company&quot;</span><span class="c5">, </span><span class="c3">&quot;Google&quot;</span><span class="c5">);<br>XElement bobAgeElem = </span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;age&quot;</span><span class="c5">, </span><span class="c15">41</span><span class="c5">);<br>bob.Add(bobNameAttr);<br>bob.Add(bobCompanyElem);<br>bob.Add(bobAgeElem);<br></span><span class="c0">// cre&#259;m elementul r&#259;d&#259;cin&#259;</span><span class="c5"><br>XElement people = </span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;people&quot;</span><span class="c5">);<br></span><span class="c0">// ad&#259;ug&#259;m cele dou&#259; elemente person &icirc;n elementul r&#259;d&#259;cin&#259;</span><span class="c5"><br>people.Add(tom);<br>people.Add(bob);<br></span><span class="c0">// ad&#259;ug&#259;m elementul r&#259;d&#259;cin&#259; &icirc;n document</span><span class="c5"><br>xdoc.Add(people);<br></span><span class="c0">// salv&#259;m documentul</span><span class="c5"><br>xdoc.Save(</span><span class="c3">&quot;people.xml&quot;</span><span class="c5">);<br><br>Console.WriteLine(</span><span class="c3">&quot;Data saved&quot;</span><span class="c5">);</span></p></td></tr></table><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c14">Pentru a crea un document, trebuie s&#259; cre&#259;m un obiect al clasei </span><span class="c1">XDocument</span><span class="c6">. Acesta este obiectul de cel mai &icirc;nalt nivel din documentul XML.</span></p><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c14">Elementele sunt create folosind constructorul clasei </span><span class="c1">XElement</span><span class="c6">. Constructorul are mai multe versiuni suprasolicitate. Primul parametru al constructorului transmite numele elementului, de exemplu, person. Al doilea parametru transmite valoarea acestui element.</span></p><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c14">Crearea unui atribut este similar&#259; cu crearea unui element. Apoi, toate atributele &#537;i elementele sunt ad&#259;ugate &icirc;n elementele person folosind metoda </span><span class="c14 c19">Add()</span><span class="c6">.</span></p><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c6">Deoarece documentul XML trebuie s&#259; aib&#259; un singur element r&#259;d&#259;cin&#259;, toate elementele person sunt ad&#259;ugate &icirc;ntr-un container - elementul people.</span></p><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c14">La final, elementul r&#259;d&#259;cin&#259; este ad&#259;ugat &icirc;n obiectul XDocument, iar acest obiect este salvat pe disc &icirc;ntr-un fi&#537;ier XML folosind metoda</span><span class="c1">&nbsp;Save()</span><span class="c6">.</span></p><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c14">Dac&#259; deschidem fi&#537;ierul salvat </span><span class="c1">people.xml</span><span class="c6">, vom vedea urm&#259;torul con&#539;inut:</span></p><p class="c7 c11"><span class="c6"></span></p><a id="t.020f06049dd92aa3b2c8ff07cf04376479e11c18"></a><a id="t.1"></a><table class="c12"><tr class="c17"><td class="c2" colspan="1" rowspan="1"><p class="c13"><span class="c18">&lt;?</span><span class="c5">xml version=</span><span class="c3">&quot;1.0&quot;</span><span class="c5">&nbsp;encoding=</span><span class="c3">&quot;utf-8&quot;</span><span class="c18">?&gt;</span><span class="c5"><br></span><span class="c8">&lt;</span><span class="c4">people</span><span class="c8">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c8">&lt;</span><span class="c4">person</span><span class="c8">&nbsp;name=</span><span class="c3">&quot;Tom&quot;</span><span class="c8">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c8">&lt;</span><span class="c4">company</span><span class="c8">&gt;</span><span class="c5">Microsoft</span><span class="c8">&lt;/</span><span class="c4">company</span><span class="c8">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c8">&lt;</span><span class="c4">age</span><span class="c8">&gt;</span><span class="c5">37</span><span class="c8">&lt;/</span><span class="c4">age</span><span class="c8">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c8">&lt;/</span><span class="c4">person</span><span class="c8">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c8">&lt;</span><span class="c4">person</span><span class="c8">&nbsp;name=</span><span class="c3">&quot;Bob&quot;</span><span class="c8">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c8">&lt;</span><span class="c4">company</span><span class="c8">&gt;</span><span class="c5">Google</span><span class="c8">&lt;/</span><span class="c4">company</span><span class="c8">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c8">&lt;</span><span class="c4">age</span><span class="c8">&gt;</span><span class="c5">41</span><span class="c8">&lt;/</span><span class="c4">age</span><span class="c8">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c8">&lt;/</span><span class="c4">person</span><span class="c8">&gt;</span><span class="c5"><br></span><span class="c8">&lt;/</span><span class="c4">people</span><span class="c8">&gt;</span></p></td></tr></table><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c6">Constructorul clasei XElement permite setarea unui grup de obiecte care vor face parte din element. Astfel, exemplul anterior poate fi scurtat &icirc;n felul urm&#259;tor:</span></p><p class="c7 c11"><span class="c6"></span></p><a id="t.b5ce05010b07c88ee10891e6f1297dc0a68185b4"></a><a id="t.2"></a><table class="c12"><tr class="c17"><td class="c2" colspan="1" rowspan="1"><p class="c13"><span class="c10">using</span><span class="c5">&nbsp;System.Xml.Linq;<br><br>XDocument xdoc = </span><span class="c10">new</span><span class="c5">&nbsp;XDocument(</span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;people&quot;</span><span class="c5">,<br> &nbsp; &nbsp;</span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;person&quot;</span><span class="c5">,<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c5">&nbsp;XAttribute(</span><span class="c3">&quot;name&quot;</span><span class="c5">, </span><span class="c3">&quot;Tom&quot;</span><span class="c5">),<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;company&quot;</span><span class="c5">, </span><span class="c3">&quot;Microsoft&quot;</span><span class="c5">),<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;age&quot;</span><span class="c5">, </span><span class="c15">37</span><span class="c5">)),<br> &nbsp; &nbsp;</span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;person&quot;</span><span class="c5">,<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c5">&nbsp;XAttribute(</span><span class="c3">&quot;name&quot;</span><span class="c5">, </span><span class="c3">&quot;Bob&quot;</span><span class="c5">),<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;company&quot;</span><span class="c5">, </span><span class="c3">&quot;Google&quot;</span><span class="c5">),<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c5">&nbsp;XElement(</span><span class="c3">&quot;age&quot;</span><span class="c5">, </span><span class="c15">41</span><span class="c5">))));<br>xdoc.Save(</span><span class="c3">&quot;people2.xml&quot;</span><span class="c5">);<br><br>Console.WriteLine(</span><span class="c3">&quot;Data saved&quot;</span><span class="c5">);</span></p></td></tr></table><p class="c7 c11"><span class="c6"></span></p><p class="c7 c11"><span class="c6"></span></p><p class="c7"><span class="c6">Acest cod creeaz&#259; &#537;i salveaz&#259; un document XML similar celui din exemplul anterior, dar &icirc;ntr-un mod mai concis.</span></p><p class="c7 c11"><span class="c6"></span></p></body></html>