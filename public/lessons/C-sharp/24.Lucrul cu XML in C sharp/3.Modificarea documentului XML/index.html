<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=cGvuclDC_Z1vE_cnVEU6AQ3B2cQio22zuQYmMduN3_l7ONtQ5a4SPXkjZSXpzESjP2gInyaGnGxV-h1PT8k4ug);.lst-kix_yzpv7gzgpag4-3>li:before{content:"\0025cf   "}.lst-kix_yzpv7gzgpag4-4>li:before{content:"\0025cb   "}.lst-kix_yzpv7gzgpag4-2>li:before{content:"\0025a0   "}.lst-kix_yzpv7gzgpag4-6>li:before{content:"\0025cf   "}.lst-kix_yzpv7gzgpag4-5>li:before{content:"\0025a0   "}.lst-kix_yzpv7gzgpag4-0>li:before{content:"\0025cf   "}.lst-kix_78d9pyo4eowt-5>li:before{content:"\0025a0   "}.lst-kix_78d9pyo4eowt-6>li:before{content:"\0025cf   "}.lst-kix_yzpv7gzgpag4-1>li:before{content:"\0025cb   "}ul.lst-kix_78d9pyo4eowt-4{list-style-type:none}.lst-kix_78d9pyo4eowt-8>li:before{content:"\0025a0   "}ul.lst-kix_78d9pyo4eowt-5{list-style-type:none}ul.lst-kix_78d9pyo4eowt-2{list-style-type:none}.lst-kix_78d9pyo4eowt-7>li:before{content:"\0025cb   "}ul.lst-kix_78d9pyo4eowt-3{list-style-type:none}ul.lst-kix_78d9pyo4eowt-0{list-style-type:none}ul.lst-kix_78d9pyo4eowt-1{list-style-type:none}ul.lst-kix_yzpv7gzgpag4-7{list-style-type:none}ul.lst-kix_yzpv7gzgpag4-8{list-style-type:none}ul.lst-kix_yzpv7gzgpag4-5{list-style-type:none}.lst-kix_78d9pyo4eowt-4>li:before{content:"\0025cb   "}ul.lst-kix_yzpv7gzgpag4-6{list-style-type:none}ul.lst-kix_yzpv7gzgpag4-3{list-style-type:none}.lst-kix_78d9pyo4eowt-3>li:before{content:"\0025cf   "}ul.lst-kix_yzpv7gzgpag4-4{list-style-type:none}ul.lst-kix_yzpv7gzgpag4-1{list-style-type:none}.lst-kix_78d9pyo4eowt-2>li:before{content:"\0025a0   "}ul.lst-kix_yzpv7gzgpag4-2{list-style-type:none}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ul.lst-kix_yzpv7gzgpag4-0{list-style-type:none}.lst-kix_78d9pyo4eowt-0>li:before{content:"\0025cf   "}.lst-kix_78d9pyo4eowt-1>li:before{content:"\0025cb   "}.lst-kix_yzpv7gzgpag4-7>li:before{content:"\0025cb   "}.lst-kix_yzpv7gzgpag4-8>li:before{content:"\0025a0   "}ul.lst-kix_78d9pyo4eowt-8{list-style-type:none}ul.lst-kix_78d9pyo4eowt-6{list-style-type:none}ul.lst-kix_78d9pyo4eowt-7{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c15{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#333333;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c10{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Open Sans";font-style:normal}.c21{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Open Sans";font-style:normal}.c18{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:27pt;font-family:"Open Sans";font-style:normal}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.c11{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c1{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#888888;font-weight:400}.c20{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#fc9b9b;font-weight:400}.c0{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#62c8f3;font-weight:400}.c5{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#ffffff;font-weight:400}.c8{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#a2fca2;font-weight:400}.c14{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#fcc28c;font-weight:400}.c7{background-color:#333333;font-size:12pt;font-family:"Consolas";color:#62c8f3;font-weight:700}.c9{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c17{border-spacing:0;border-collapse:collapse;margin-right:auto}.c16{font-size:12pt;font-family:"Open Sans";font-weight:400}.c13{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c3{font-size:12pt;font-family:"Open Sans";font-weight:700}.c12{padding:0;margin:0}.c6{height:0pt}.c19{font-style:italic}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c13 doc-content"><p class="c11"><span class="c18">Modificarea documentului XML.</span></p><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c16">Pentru editarea unui document XML (modificarea, ad&#259;ugarea sau &#537;tergerea elementelor), putem utiliza metodele clasei </span><span class="c3">XmlNode</span><span class="c2">:</span></p><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_78d9pyo4eowt-0 start"><li class="c10 li-bullet-0"><span class="c3">AppendChild</span><span class="c2">: adaug&#259; la sf&acirc;r&#537;itul nodului curent un nou nod copil</span></li></ul><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_78d9pyo4eowt-0"><li class="c10 li-bullet-0"><span class="c3">InsertAfter</span><span class="c2">: adaug&#259; un nou nod dup&#259; un anumit nod</span></li></ul><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_78d9pyo4eowt-0"><li class="c10 li-bullet-0"><span class="c3">InsertBefore</span><span class="c2">: adaug&#259; un nou nod &icirc;nainte de un anumit nod</span></li></ul><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_78d9pyo4eowt-0"><li class="c10 li-bullet-0"><span class="c3">RemoveAll</span><span class="c2">: &#537;terge toate nodurile copii ale nodului curent</span></li></ul><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_78d9pyo4eowt-0"><li class="c10 li-bullet-0"><span class="c3">RemoveChild</span><span class="c2">: &#537;terge un nod copil al nodului curent &#537;i &icirc;l returneaz&#259;</span></li></ul><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c16">Clasa </span><span class="c3">XmlDocument </span><span class="c2">adaug&#259; &icirc;nc&#259; o serie de metode care permit crearea de noduri noi:</span></p><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_yzpv7gzgpag4-0 start"><li class="c10 li-bullet-0"><span class="c3">CreateNode</span><span class="c2">: creeaz&#259; un nod de orice tip</span></li></ul><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_yzpv7gzgpag4-0"><li class="c10 li-bullet-0"><span class="c3">CreateElement</span><span class="c2">: creeaz&#259; un nod de tip XmlDocument</span></li></ul><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_yzpv7gzgpag4-0"><li class="c10 li-bullet-0"><span class="c3">CreateAttribute</span><span class="c2">: creeaz&#259; un nod de tip XmlAttribute</span></li></ul><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_yzpv7gzgpag4-0"><li class="c10 li-bullet-0"><span class="c3">CreateTextNode</span><span class="c2">: creeaz&#259; un nod de tip XmlTextNode</span></li></ul><p class="c4"><span class="c2"></span></p><ul class="c12 lst-kix_yzpv7gzgpag4-0"><li class="c10 li-bullet-0"><span class="c3">CreateComment</span><span class="c2">: creeaz&#259; un comentariu</span></li></ul><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c2">Vom lua documentul XML people.xml din tema anterioar&#259;:</span></p><p class="c4"><span class="c2"></span></p><a id="t.f0cbcc1faa7ceed326b660f08ddc7ed92ce6bc31"></a><a id="t.0"></a><table class="c17"><tr class="c6"><td class="c15" colspan="1" rowspan="1"><p class="c9"><span class="c20">&lt;?</span><span class="c5">xml version=</span><span class="c8">&quot;1.0&quot;</span><span class="c5">&nbsp;encoding=</span><span class="c8">&quot;utf-8&quot;</span><span class="c5">&nbsp;</span><span class="c20">?&gt;</span><span class="c5"><br></span><span class="c0">&lt;</span><span class="c7">people</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;</span><span class="c7">person</span><span class="c0">&nbsp;name=</span><span class="c8">&quot;Tom&quot;</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5">Microsoft</span><span class="c0">&lt;/</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5">37</span><span class="c0">&lt;/</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;/</span><span class="c7">person</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;</span><span class="c7">person</span><span class="c0">&nbsp;name=</span><span class="c8">&quot;Bob&quot;</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5">Google</span><span class="c0">&lt;/</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5">41</span><span class="c0">&lt;/</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;/</span><span class="c7">person</span><span class="c0">&gt;</span><span class="c5"><br></span><span class="c0">&lt;/</span><span class="c7">people</span><span class="c0">&gt;</span></p></td></tr></table><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c2">Vom ad&#259;uga &icirc;n acest document XML un nou element &lt;person&gt;:</span></p><p class="c4"><span class="c2"></span></p><a id="t.6f25d0cb3038c62871d51c511a94a6ef04ac1742"></a><a id="t.1"></a><table class="c17"><tr class="c6"><td class="c15" colspan="1" rowspan="1"><p class="c9"><span class="c14">using</span><span class="c5">&nbsp;System.Xml;<br><br>XmlDocument xDoc = </span><span class="c14">new</span><span class="c5">&nbsp;XmlDocument();<br>xDoc.Load(</span><span class="c8">&quot;people.xml&quot;</span><span class="c5">);<br>XmlElement? xRoot = xDoc.DocumentElement;<br><br></span><span class="c1">// cre&#259;m un nou element person</span><span class="c5"><br>XmlElement personElem = xDoc.CreateElement(</span><span class="c8">&quot;person&quot;</span><span class="c5">);<br><br></span><span class="c1">// cre&#259;m atributul name</span><span class="c5"><br>XmlAttribute nameAttr = xDoc.CreateAttribute(</span><span class="c8">&quot;name&quot;</span><span class="c5">);<br><br></span><span class="c1">// cre&#259;m elementele company &#537;i age</span><span class="c5"><br>XmlElement companyElem = xDoc.CreateElement(</span><span class="c8">&quot;company&quot;</span><span class="c5">);<br>XmlElement ageElem = xDoc.CreateElement(</span><span class="c8">&quot;age&quot;</span><span class="c5">);<br><br></span><span class="c1">// cre&#259;m valorile text pentru elemente &#537;i atribut</span><span class="c5"><br>XmlText nameText = xDoc.CreateTextNode(</span><span class="c8">&quot;Mark&quot;</span><span class="c5">);<br>XmlText companyText = xDoc.CreateTextNode(</span><span class="c8">&quot;Facebook&quot;</span><span class="c5">);<br>XmlText ageText = xDoc.CreateTextNode(</span><span class="c8">&quot;30&quot;</span><span class="c5">);<br><br></span><span class="c1">// ad&#259;ug&#259;m nodurile</span><span class="c5"><br>nameAttr.AppendChild(nameText);<br>companyElem.AppendChild(companyText);<br>ageElem.AppendChild(ageText);<br><br></span><span class="c1">// ad&#259;ug&#259;m atributul name</span><span class="c5"><br>personElem.Attributes.Append(nameAttr);<br></span><span class="c1">// ad&#259;ug&#259;m elementele company &#537;i age</span><span class="c5"><br>personElem.AppendChild(companyElem);<br>personElem.AppendChild(ageElem);<br></span><span class="c1">// ad&#259;ug&#259;m &icirc;n elementul r&#259;d&#259;cin&#259; noul element person</span><span class="c5"><br>xRoot?.AppendChild(personElem);<br></span><span class="c1">// salv&#259;m modific&#259;rile documentului XML &icirc;n fi&#537;ier</span><span class="c5"><br>xDoc.Save(</span><span class="c8">&quot;people.xml&quot;</span><span class="c5">);</span></p></td></tr></table><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c16">Ad&#259;ugarea elementelor urmeaz&#259; un &#537;ablon. Mai &icirc;nt&acirc;i cre&#259;m elementul </span><span class="c16 c19">(xDoc.CreateElement(&quot;person&quot;)</span><span class="c16">). Dac&#259; elementul este complex, adic&#259; con&#539;ine alte elemente, atunci cre&#259;m aceste elemente. Dac&#259; elementul este simplu, con&#539;in&acirc;nd un text, cre&#259;m acest text </span><span class="c16 c19">(XmlText companyText = xDoc.CreateTextNode(&quot;Facebook&quot;)</span><span class="c2">;).</span></p><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c16">Apoi, toate elementele sunt ad&#259;ugate &icirc;n elementul principal person, care este ad&#259;ugat &icirc;n elementul r&#259;d&#259;cin&#259; (</span><span class="c16 c19">xRoot.AppendChild(personElem);</span><span class="c2">).</span></p><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c16">Pentru a salva documentul modificat pe disc, utiliz&#259;m metoda </span><span class="c16 c19">Save</span><span class="c16">: </span><span class="c16 c19">xDoc.Save(&quot;people.xml&quot;</span><span class="c2">).</span></p><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c2">Dup&#259; aceasta, &icirc;n fi&#537;ierul XML va ap&#259;rea urm&#259;torul element:</span></p><p class="c4"><span class="c2"></span></p><a id="t.43c79bfd0d50831a770ce2398ceab4e8076d864b"></a><a id="t.2"></a><table class="c17"><tr class="c6"><td class="c15" colspan="1" rowspan="1"><p class="c9"><span class="c20">&lt;?</span><span class="c5">xml version=</span><span class="c8">&quot;1.0&quot;</span><span class="c5">&nbsp;encoding=</span><span class="c8">&quot;utf-8&quot;</span><span class="c20">?&gt;</span><span class="c5"><br></span><span class="c0">&lt;</span><span class="c7">people</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;</span><span class="c7">person</span><span class="c0">&nbsp;name=</span><span class="c8">&quot;Tom&quot;</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5">Microsoft</span><span class="c0">&lt;/</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5">37</span><span class="c0">&lt;/</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;/</span><span class="c7">person</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;</span><span class="c7">person</span><span class="c0">&nbsp;name=</span><span class="c8">&quot;Bob&quot;</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5">Google</span><span class="c0">&lt;/</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5">41</span><span class="c0">&lt;/</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;/</span><span class="c7">person</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;</span><span class="c7">person</span><span class="c0">&nbsp;name=</span><span class="c8">&quot;Mark&quot;</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5">Facebook</span><span class="c0">&lt;/</span><span class="c7">company</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp; &nbsp;</span><span class="c0">&lt;</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5">30</span><span class="c0">&lt;/</span><span class="c7">age</span><span class="c0">&gt;</span><span class="c5"><br> &nbsp;</span><span class="c0">&lt;/</span><span class="c7">person</span><span class="c0">&gt;</span><span class="c5"><br></span><span class="c0">&lt;/</span><span class="c7">people</span><span class="c0">&gt;</span></p></td></tr></table><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c21">&#536;tergerea nodurilor.</span></p><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c2">Vom &#537;terge primul nod din documentul XML:</span></p><p class="c4"><span class="c2"></span></p><a id="t.11b79d2dd119cd7e14b13d65cffe7a9b1812e397"></a><a id="t.3"></a><table class="c17"><tr class="c6"><td class="c15" colspan="1" rowspan="1"><p class="c9"><span class="c5">using System.Xml;<br><br>XmlDocument xDoc = new XmlDocument();<br>xDoc.Load(&quot;people.xml&quot;);<br>XmlElement? xRoot = xDoc.DocumentElement;<br>XmlNode? firstNode = xRoot?.FirstChild;<br>if (firstNode is not null) xRoot?.RemoveChild(firstNode);<br>xDoc.Save(&quot;people.xml&quot;);</span></p></td></tr></table><p class="c4"><span class="c2"></span></p><p class="c11"><span class="c2">Acest cod &#537;terge primul nod copil al elementului r&#259;d&#259;cin&#259; &#537;i salveaz&#259; modific&#259;rile &icirc;n fi&#537;ierul XML.</span></p><p class="c4"><span class="c2"></span></p></body></html>