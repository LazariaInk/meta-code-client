<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><link rel="stylesheet" type="text/css" href="/lessons/styles.css"></head><body class="c15 doc-content"><p class="c6"><span class="c16">Modificarea documentului &icirc;n LINQ to XML.</span></p><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c13">S&#259; lu&#259;m fi&#537;ierul XML </span><span class="c11">people.xml </span><span class="c0">din temele anterioare:</span></p><p class="c6 c7"><span class="c0"></span></p><a id="t.020f06049dd92aa3b2c8ff07cf04376479e11c18"></a><a id="t.0"></a><table class="c4"><tr class="c3"><td class="c12" colspan="1" rowspan="1"><p class="c9"><span class="c2">&lt;?xml version=</span><span class="c5">&quot;1.0&quot;</span><span class="c2">&nbsp;encoding=</span><span class="c5">&quot;utf-8&quot;</span><span class="c2">?&gt;<br>&lt;people&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Tom&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;Microsoft&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">37</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Bob&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;Google&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">41</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br>&lt;/people&gt;</span></p></td></tr></table><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c14">Ad&#259;ugarea de date.</span></p><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c13">Pentru a ad&#259;uga date &icirc;ntr-un document XML, la obiectul XElement se aplic&#259; metoda </span><span class="c11">Add()</span><span class="c0">, &icirc;n care se transmite obiectul ce urmeaz&#259; a fi ad&#259;ugat:</span></p><p class="c6 c7"><span class="c0"></span></p><a id="t.2b093c7be80dcc22d559da113f7014d29a83e688"></a><a id="t.1"></a><table class="c4"><tr class="c3"><td class="c12" colspan="1" rowspan="1"><p class="c9"><span class="c10">using</span><span class="c2">&nbsp;System.Xml.Linq;<br><br>XDocument xdoc = XDocument.Load(</span><span class="c5">&quot;people.xml&quot;</span><span class="c2">);<br>XElement? root = xdoc.Element(</span><span class="c5">&quot;people&quot;</span><span class="c2">);<br><br></span><span class="c10">if</span><span class="c2">(root != </span><span class="c10">null</span><span class="c2">)<br>{<br> &nbsp; &nbsp;</span><span class="c8">// ad&#259;ug&#259;m un nou element</span><span class="c2"><br> &nbsp; &nbsp;root.Add(</span><span class="c10">new</span><span class="c2">&nbsp;XElement(</span><span class="c5">&quot;person&quot;</span><span class="c2">,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c2">&nbsp;XAttribute(</span><span class="c5">&quot;name&quot;</span><span class="c2">, </span><span class="c5">&quot;Sam&quot;</span><span class="c2">),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c2">&nbsp;XElement(</span><span class="c5">&quot;company&quot;</span><span class="c2">, </span><span class="c5">&quot;JetBrains&quot;</span><span class="c2">),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">new</span><span class="c2">&nbsp;XElement(</span><span class="c5">&quot;age&quot;</span><span class="c2">, </span><span class="c1">28</span><span class="c2">)));<br><br> &nbsp; &nbsp;xdoc.Save(</span><span class="c5">&quot;people.xml&quot;</span><span class="c2">);<br>}<br><br></span><span class="c8">// afi&#537;&#259;m documentul XML &icirc;n consol&#259;</span><span class="c2"><br>Console.WriteLine(xdoc);</span></p></td></tr></table><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c0">&Icirc;n urma execu&#539;iei, se va forma &#537;i salva pe disc un nou document:</span></p><p class="c6 c7"><span class="c0"></span></p><a id="t.b00652660e25417a7c23138692c2f42254b17af3"></a><a id="t.2"></a><table class="c4"><tr class="c3"><td class="c12" colspan="1" rowspan="1"><p class="c9"><span class="c2">&lt;people&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Tom&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;Microsoft&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">37</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Bob&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;Google&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">41</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Sam&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;JetBrains&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">28</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br>&lt;/people&gt;</span></p></td></tr></table><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c14">Modificarea datelor.</span></p><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c0">Pentru a modifica datele &icirc;ntr-un document XML, trebuie s&#259; ob&#539;inem elementul care trebuie schimbat &#537;i apoi putem edita valorile atributelor sau elementelor &icirc;ncorporate. S&#259; modific&#259;m elementul person, unde atributul name = &quot;Tom&quot;:</span></p><p class="c6 c7"><span class="c0"></span></p><a id="t.5c5f831eb8ac86f129dd71d3d22846ff1cd74fb3"></a><a id="t.3"></a><table class="c4"><tr class="c3"><td class="c12" colspan="1" rowspan="1"><p class="c9"><span class="c10">using</span><span class="c2">&nbsp;System.Xml.Linq;<br><br>XDocument xdoc = XDocument.Load(</span><span class="c5">&quot;people.xml&quot;</span><span class="c2">);<br><br></span><span class="c8">// ob&#539;inem elementul person cu name = &quot;Tom&quot;</span><span class="c2"><br></span><span class="c10">var</span><span class="c2">&nbsp;tom = xdoc.Element(</span><span class="c5">&quot;people&quot;</span><span class="c2">)?<br> &nbsp; &nbsp;.Elements(</span><span class="c5">&quot;person&quot;</span><span class="c2">)<br> &nbsp; &nbsp;.FirstOrDefault(p =&gt; p.Attribute(</span><span class="c5">&quot;name&quot;</span><span class="c2">)?.Value == </span><span class="c5">&quot;Tom&quot;</span><span class="c2">);<br><br></span><span class="c10">if</span><span class="c2">(tom != </span><span class="c10">null</span><span class="c2">)<br>{<br> &nbsp; &nbsp;</span><span class="c8">// schimb&#259;m atributul name</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c10">var</span><span class="c2">&nbsp;name = tom.Attribute(</span><span class="c5">&quot;name&quot;</span><span class="c2">);<br> &nbsp; &nbsp;</span><span class="c10">if</span><span class="c2">&nbsp;(name != </span><span class="c10">null</span><span class="c2">) name.Value = </span><span class="c5">&quot;Tomas&quot;</span><span class="c2">;<br><br> &nbsp; &nbsp;</span><span class="c8">// schimb&#259;m elementul &icirc;ncorporat age</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c10">var</span><span class="c2">&nbsp;age = tom.Element(</span><span class="c5">&quot;age&quot;</span><span class="c2">);<br> &nbsp; &nbsp;</span><span class="c10">if</span><span class="c2">&nbsp;(age != </span><span class="c10">null</span><span class="c2">) age.Value = </span><span class="c5">&quot;22&quot;</span><span class="c2">;<br><br> &nbsp; &nbsp;xdoc.Save(</span><span class="c5">&quot;people.xml&quot;</span><span class="c2">);<br>}<br><br></span><span class="c8">// afi&#537;&#259;m documentul XML &icirc;n consol&#259;</span><span class="c2"><br>Console.WriteLine(xdoc);</span></p></td></tr></table><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c0">&Icirc;n urma execu&#539;iei, se va forma &#537;i salva pe disc un nou document:</span></p><p class="c6 c7"><span class="c0"></span></p><a id="t.360f1257415ed56aedd2611edaf78cd47f380930"></a><a id="t.4"></a><table class="c4"><tr class="c3"><td class="c12" colspan="1" rowspan="1"><p class="c9"><span class="c2">&lt;people&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Tomas&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;Microsoft&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">22</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Bob&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;Google&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">41</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Sam&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;JetBrains&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">28</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br>&lt;/people&gt;</span></p></td></tr></table><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c14">&#536;tergerea datelor.</span></p><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c13">Pentru a &#537;terge date dintr-un document XML, la obiectul XElement care urmeaz&#259; s&#259; fie &#537;ters se apeleaz&#259; metoda </span><span class="c11">Remove()</span><span class="c0">. De exemplu, s&#259; &#537;tergem elementul person, unde atributul name = &quot;Bob&quot;:</span></p><p class="c6 c7"><span class="c0"></span></p><a id="t.0509b0a90bb036aed97daaacba15b1628063a092"></a><a id="t.5"></a><table class="c4"><tr class="c3"><td class="c12" colspan="1" rowspan="1"><p class="c9"><span class="c10">using</span><span class="c2">&nbsp;System.Xml.Linq;<br><br>XDocument xdoc = XDocument.Load(</span><span class="c5">&quot;people.xml&quot;</span><span class="c2">);<br>XElement? root = xdoc.Element(</span><span class="c5">&quot;people&quot;</span><span class="c2">);<br><br></span><span class="c10">if</span><span class="c2">&nbsp;(root != </span><span class="c10">null</span><span class="c2">)<br>{<br> &nbsp; &nbsp;</span><span class="c8">// ob&#539;inem elementul person cu name = &quot;Bob&quot;</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c10">var</span><span class="c2">&nbsp;bob = root.Elements(</span><span class="c5">&quot;person&quot;</span><span class="c2">)<br> &nbsp; &nbsp; &nbsp; &nbsp;.FirstOrDefault(p =&gt; p.Attribute(</span><span class="c5">&quot;name&quot;</span><span class="c2">)?.Value == </span><span class="c5">&quot;Bob&quot;</span><span class="c2">);<br> &nbsp; &nbsp;</span><span class="c8">// &#537;i &icirc;l &#537;tergem</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c10">if</span><span class="c2">&nbsp;(bob != </span><span class="c10">null</span><span class="c2">)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;bob.Remove();<br> &nbsp; &nbsp; &nbsp; &nbsp;xdoc.Save(</span><span class="c5">&quot;people.xml&quot;</span><span class="c2">);<br> &nbsp; &nbsp;}<br>}<br><br></span><span class="c8">// afi&#537;&#259;m documentul XML &icirc;n consol&#259;</span><span class="c2"><br>Console.WriteLine(xdoc);</span></p></td></tr></table><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c0">&Icirc;n urma execu&#539;iei, se va forma &#537;i salva pe disc un nou document:</span></p><p class="c6 c7"><span class="c0"></span></p><a id="t.99993c2f12f6bc7f8b580b38c989c48b08b6ab4a"></a><a id="t.6"></a><table class="c4"><tr class="c3"><td class="c12" colspan="1" rowspan="1"><p class="c9"><span class="c2">&lt;people&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Tomas&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;Microsoft&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">22</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br> &nbsp;&lt;person name=</span><span class="c5">&quot;Sam&quot;</span><span class="c2">&gt;<br> &nbsp; &nbsp;&lt;company&gt;JetBrains&lt;/company&gt;<br> &nbsp; &nbsp;&lt;age&gt;</span><span class="c1">28</span><span class="c2">&lt;/age&gt;<br> &nbsp;&lt;/person&gt;<br>&lt;/people&gt;</span></p></td></tr></table><p class="c6 c7"><span class="c0"></span></p><p class="c6"><span class="c13">De asemenea, dac&#259; trebuie s&#259; &#537;terge&#539;i un atribut, la obiectul XAttribute se aplic&#259; metoda</span><span class="c13 c17">&nbsp;Remove()</span><span class="c0">.</span></p><p class="c6 c7"><span class="c0"></span></p></body></html>