<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><link rel="stylesheet" type="text/css" href="/lessons/styles.css"></head><body class="c20 doc-content"><p class="c3"><span class="c22 c23">&nbsp;XPath.</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">XPath </span><span class="c6">reprezint&#259; un limbaj de interogare &icirc;n XML. Acesta permite selectarea elementelor care corespund unui anumit selector.</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">S&#259; analiz&#259;m c&acirc;&#539;iva dintre cei mai des utiliza&#539;i selectori:</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">.</span><span class="c6">: selec&#539;ia nodului curent</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">..</span><span class="c6">: selec&#539;ia nodului p&#259;rinte</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">*</span><span class="c6">: selec&#539;ia tuturor nodurilor copii ale nodului curent</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">person</span><span class="c6">: selec&#539;ia tuturor nodurilor cu un anumit nume, &icirc;n acest caz cu numele &quot;person&quot;</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">@name</span><span class="c6">: selec&#539;ia atributului nodului curent, dup&#259; semnul @ se indic&#259; numele atributului (&icirc;n acest caz &quot;name&quot;)</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">@*</span><span class="c6">: selec&#539;ia tuturor atributelor nodului curent</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">element[3]</span><span class="c6">: selec&#539;ia unui anumit nod copil dup&#259; index, &icirc;n acest caz al treilea nod</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">//person</span><span class="c6">: selec&#539;ia &icirc;n document a tuturor nodurilor cu numele &quot;person&quot;</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">person[@name=&#39;Tom&#39;]</span><span class="c6">: selec&#539;ia elementelor cu o anumit&#259; valoare a atributului. &Icirc;n acest caz, sunt selectate toate elementele &quot;person&quot; cu atributul name=&#39;Tom&#39;</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">person[company=&#39;Microsoft&#39;]</span><span class="c6">: selec&#539;ia elementelor cu o anumit&#259; valoare a unui element &icirc;ncorporat. &Icirc;n acest caz, sunt selectate toate elementele &quot;person&quot; al c&#259;ror element copil &quot;company&quot; are valoarea &#39;Microsoft&#39;</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c11">//person/company</span><span class="c6">: selec&#539;ia &icirc;n document a tuturor nodurilor cu numele &quot;company&quot; care se afl&#259; &icirc;n elementele &quot;person&quot;</span></p><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c18">Func&#539;ionarea interog&#259;rilor XPath se bazeaz&#259; pe utilizarea a dou&#259; metode ale clasei </span><span class="c11">XmlElement</span><span class="c6">:</span></p><p class="c1"><span class="c6"></span></p><ul class="c19 lst-kix_600bg4mum1c4-0 start"><li class="c3 c8 li-bullet-0"><span class="c11">SelectSingleNode()</span><span class="c6">: selec&#539;ia unui singur nod din rezultatele interog&#259;rii. Dac&#259; interogarea returneaz&#259; mai multe noduri, este selectat primul</span></li></ul><p class="c1 c17"><span class="c6"></span></p><ul class="c19 lst-kix_600bg4mum1c4-0"><li class="c3 c8 li-bullet-0"><span class="c11">SelectNodes()</span><span class="c18">: selec&#539;ia unei colec&#539;ii de noduri ca obiect </span><span class="c10 c22">XmlNodeList</span></li></ul><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">Pentru interog&#259;ri, vom lua documentul XML din temele anterioare:</span></p><p class="c1"><span class="c6"></span></p><a id="t.f0cbcc1faa7ceed326b660f08ddc7ed92ce6bc31"></a><a id="t.0"></a><table class="c12"><tr class="c9"><td class="c16" colspan="1" rowspan="1"><p class="c13"><span class="c15">&lt;?</span><span class="c4">xml version=</span><span class="c0">&quot;1.0&quot;</span><span class="c4">&nbsp;encoding=</span><span class="c0">&quot;utf-8&quot;</span><span class="c4">&nbsp;</span><span class="c15">?&gt;</span><span class="c4"><br></span><span class="c2">&lt;</span><span class="c7">people</span><span class="c2">&gt;</span><span class="c4"><br> &nbsp;</span><span class="c2">&lt;</span><span class="c7">person</span><span class="c2">&nbsp;name=</span><span class="c0">&quot;Tom&quot;</span><span class="c2">&gt;</span><span class="c4"><br> &nbsp; &nbsp;</span><span class="c2">&lt;</span><span class="c7">company</span><span class="c2">&gt;</span><span class="c4">Microsoft</span><span class="c2">&lt;/</span><span class="c7">company</span><span class="c2">&gt;</span><span class="c4"><br> &nbsp; &nbsp;</span><span class="c2">&lt;</span><span class="c7">age</span><span class="c2">&gt;</span><span class="c4">37</span><span class="c2">&lt;/</span><span class="c7">age</span><span class="c2">&gt;</span><span class="c4"><br> &nbsp;</span><span class="c2">&lt;/</span><span class="c7">person</span><span class="c2">&gt;</span><span class="c4"><br> &nbsp;</span><span class="c2">&lt;</span><span class="c7">person</span><span class="c2">&nbsp;name=</span><span class="c0">&quot;Bob&quot;</span><span class="c2">&gt;</span><span class="c4"><br> &nbsp; &nbsp;</span><span class="c2">&lt;</span><span class="c7">company</span><span class="c2">&gt;</span><span class="c4">Google</span><span class="c2">&lt;/</span><span class="c7">company</span><span class="c2">&gt;</span><span class="c4"><br> &nbsp; &nbsp;</span><span class="c2">&lt;</span><span class="c7">age</span><span class="c2">&gt;</span><span class="c4">41</span><span class="c2">&lt;/</span><span class="c7">age</span><span class="c2">&gt;</span><span class="c4"><br> &nbsp;</span><span class="c2">&lt;/</span><span class="c7">person</span><span class="c2">&gt;</span><span class="c4"><br></span><span class="c2">&lt;/</span><span class="c7">people</span><span class="c2">&gt;</span></p></td></tr></table><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">Acum vom selecta toate nodurile elementului r&#259;d&#259;cin&#259;, adic&#259; toate elementele person:</span></p><p class="c1"><span class="c6"></span></p><a id="t.b0ec02a9f536d3e95e2c8032c1011912c5bb685b"></a><a id="t.1"></a><table class="c12"><tr class="c9"><td class="c16" colspan="1" rowspan="1"><p class="c13"><span class="c5">using</span><span class="c4">&nbsp;System.Xml;<br><br>XmlDocument xDoc = </span><span class="c5">new</span><span class="c4">&nbsp;XmlDocument();<br>xDoc.Load(</span><span class="c0">&quot;people.xml&quot;</span><span class="c4">);<br>XmlElement? xRoot = xDoc.DocumentElement;<br><br></span><span class="c14">// selec&#539;ia tuturor nodurilor fiice</span><span class="c4"><br>XmlNodeList? nodes = xRoot?.SelectNodes(</span><span class="c0">&quot;*&quot;</span><span class="c4">);<br></span><span class="c5">if</span><span class="c4">&nbsp;(nodes </span><span class="c5">is</span><span class="c4">&nbsp;not </span><span class="c5">null</span><span class="c4">)<br>{<br> &nbsp; &nbsp;</span><span class="c5">foreach</span><span class="c4">&nbsp;(XmlNode node </span><span class="c5">in</span><span class="c4">&nbsp;nodes)<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(node.OuterXml);<br>}</span></p></td></tr></table><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">Afi&#537;area &icirc;n consol&#259;:</span></p><p class="c1"><span class="c6"></span></p><a id="t.f23873552aada1358089441a0de0f8a2b331e8cc"></a><a id="t.2"></a><table class="c12"><tr class="c9"><td class="c16" colspan="1" rowspan="1"><p class="c13"><span class="c4">&lt;person name=</span><span class="c0">&quot;Tom&quot;</span><span class="c4">&gt;&lt;company&gt;Microsoft&lt;/company&gt;&lt;age&gt;</span><span class="c21">37</span><span class="c4">&lt;/age&gt;&lt;/person&gt;<br>&lt;person name=</span><span class="c0">&quot;Bob&quot;</span><span class="c4">&gt;&lt;company&gt;Google&lt;/company&gt;&lt;age&gt;</span><span class="c21">41</span><span class="c4">&lt;/age&gt;&lt;/person&gt;</span></p></td></tr></table><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c18">Vom selecta toate nodurile </span><span class="c10">&lt;person&gt;</span><span class="c6">:</span></p><p class="c1"><span class="c6"></span></p><a id="t.d6463f008e68af43ea109c683a7d20348cf417f2"></a><a id="t.3"></a><table class="c12"><tr class="c9"><td class="c16" colspan="1" rowspan="1"><p class="c13"><span class="c4">XmlNodeList? personNodes = xRoot?.SelectNodes(</span><span class="c0">&quot;person&quot;</span><span class="c4">);</span></p></td></tr></table><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">Vom afi&#537;a &icirc;n consol&#259; valorile atributelor name ale elementelor person:</span></p><p class="c1"><span class="c6"></span></p><a id="t.5096a1c8296ba801fd727db1031a715a2ed35ff4"></a><a id="t.4"></a><table class="c12"><tr class="c9"><td class="c16" colspan="1" rowspan="1"><p class="c13"><span class="c5">using</span><span class="c4">&nbsp;System.Xml;<br><br>XmlDocument xDoc = </span><span class="c5">new</span><span class="c4">&nbsp;XmlDocument();<br>xDoc.Load(</span><span class="c0">&quot;people.xml&quot;</span><span class="c4">);<br>XmlElement? xRoot = xDoc.DocumentElement;<br>XmlNodeList? personNodes = xRoot?.SelectNodes(</span><span class="c0">&quot;person&quot;</span><span class="c4">);<br></span><span class="c5">if</span><span class="c4">(personNodes </span><span class="c5">is</span><span class="c4">&nbsp;not </span><span class="c5">null</span><span class="c4">)<br>{<br> &nbsp; &nbsp;</span><span class="c5">foreach</span><span class="c4">&nbsp;(XmlNode node </span><span class="c5">in</span><span class="c4">&nbsp;personNodes)<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(node.SelectSingleNode(</span><span class="c0">&quot;@name&quot;</span><span class="c4">)?.Value);<br>}</span></p></td></tr></table><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">Rezultatul afi&#537;at va fi:</span></p><p class="c1"><span class="c6"></span></p><a id="t.43c2718d8910bfba21ae2b03eb55e5dae9f2b1a3"></a><a id="t.5"></a><table class="c12"><tr class="c9"><td class="c16" colspan="1" rowspan="1"><p class="c13"><span class="c4">Tom<br>Bob</span></p></td></tr></table><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">Vom selecta nodul al c&#259;rui atribut name are valoarea &quot;Tom&quot;:</span></p><p class="c1"><span class="c6"></span></p><a id="t.5b582dc0b35bf3fca0c9bd59f2677b060b242a3d"></a><a id="t.6"></a><table class="c12"><tr class="c9"><td class="c16" colspan="1" rowspan="1"><p class="c13"><span class="c4">XmlNode? tomNode = xRoot?.SelectSingleNode(</span><span class="c0">&quot;person[@name=&#39;Tom&#39;]&quot;</span><span class="c4">);<br>Console.WriteLine(tomNode?.OuterXml);</span></p></td></tr></table><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">S&#259; presupunem c&#259; trebuie s&#259; ob&#539;inem doar companiile. Pentru aceasta, trebuie s&#259; facem o selec&#539;ie &icirc;n josul ierarhiei elementelor:</span></p><p class="c1"><span class="c6"></span></p><a id="t.693ca54e8997d7e8cfd4366d33220f1bddd28033"></a><a id="t.7"></a><table class="c12"><tr class="c9"><td class="c16" colspan="1" rowspan="1"><p class="c13"><span class="c5">using</span><span class="c4">&nbsp;System.Xml;<br><br>XmlDocument xDoc = </span><span class="c5">new</span><span class="c4">&nbsp;XmlDocument();<br>xDoc.Load(</span><span class="c0">&quot;people.xml&quot;</span><span class="c4">);<br>XmlElement? xRoot = xDoc.DocumentElement;<br><br>XmlNodeList? companyNodes = xRoot?.SelectNodes(</span><span class="c0">&quot;//person/company&quot;</span><span class="c4">);<br></span><span class="c5">if</span><span class="c4">(companyNodes </span><span class="c5">is</span><span class="c4">&nbsp;not </span><span class="c5">null</span><span class="c4">)<br>{<br> &nbsp; &nbsp;</span><span class="c5">foreach</span><span class="c4">&nbsp;(XmlNode node </span><span class="c5">in</span><span class="c4">&nbsp;companyNodes)<br> &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(node.InnerText);<br>}</span></p></td></tr></table><p class="c1"><span class="c6"></span></p><p class="c3"><span class="c6">Acest cod va afi&#537;a numele companiilor asociate cu fiecare element person.</span></p><p class="c1"><span class="c6"></span></p></body></html>