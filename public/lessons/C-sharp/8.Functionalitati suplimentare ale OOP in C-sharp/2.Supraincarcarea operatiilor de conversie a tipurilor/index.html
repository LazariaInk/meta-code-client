<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c16 doc-content">
    <h1 class="c6 c4 c8">Supraincărcarea operațiilor de conversie a tipurilor.</h1>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">&Icirc;n tema anterioar&#259; am discutat despre suprainc&#259;rcarea
            operatorilor. Aceasta este str&acirc;ns legat&#259; de suprainc&#259;rcarea operatorilor de conversie a
            tipurilor.</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">Anterior, am discutat despre conversiile explicite &#537;i implicite ale tipurilor
            primitive. De exemplu:</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p><a id="t.f02156b64f177215b0ba0bb3671ffe7821671207"></a><a
        id="t.0"></a>
    <table class="c9">
        <tr class="c10">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c12"><span class="c0">int</span><span class="c1">&nbsp;x = </span><span
                        class="c3">50</span><span class="c1">;<br></span><span class="c0">byte</span><span
                        class="c1">&nbsp;y = (</span><span class="c0">byte</span><span class="c1">)x; </span><span
                        class="c14">// conversie explicit&#259; de la int la byte</span><span
                        class="c1"><br></span><span class="c0">int</span><span class="c1">&nbsp;z = y;
                        &nbsp;</span><span class="c14">// conversie implicit&#259; de la byte la int</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">Ar fi util s&#259; putem defini logica de conversie a unui tip &icirc;n altul.
            Prin suprainc&#259;rcarea operatorilor, putem face acest lucru. Pentru aceasta, &icirc;n clas&#259; se
            define&#537;te o metod&#259; cu urm&#259;toarea form&#259;:</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p><a id="t.2f4f75dcd53073c8d4586602a64a99ad4a70d3c6"></a><a
        id="t.1"></a>
    <table class="c9">
        <tr class="c10">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c12"><span class="c0">public</span><span class="c1">&nbsp;</span><span
                        class="c0">static</span><span class="c1">&nbsp;</span><span class="c0">implicit</span><span
                        class="c1">|</span><span class="c0">explicit</span><span class="c1">&nbsp;</span><span
                        class="c0">operator</span><span
                        class="c1">&nbsp;Tip_&icirc;n_care_s&#259;_convertim(tip_de_origine param)<br>{<br> &nbsp;
                        &nbsp;</span><span class="c14">// logica de conversie</span><span class="c1"><br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c2">Dup&#259; modificatorii</span><span class="c13">&nbsp;public static</span><span
            class="c2">&nbsp;urmeaz&#259; cuv&acirc;ntul cheie </span><span class="c13">explicit </span><span
            class="c2">(dac&#259; conversia este explicit&#259;, adic&#259; este necesar&#259; opera&#539;ia de casting)
            sau </span><span class="c13">implicit </span><span class="c2">(dac&#259; conversia este implicit&#259;).
            Apoi urmeaz&#259; cuv&acirc;ntul cheie </span><span class="c13">operator </span><span class="c4 c2">&#537;i
            tipul returnat, &icirc;n care trebuie convertit obiectul. &Icirc;n paranteze, ca parametru, se transmite
            obiectul care trebuie convertit.</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">De exemplu, s&#259; presupunem c&#259; avem urm&#259;toarea clas&#259; Counter,
            care reprezint&#259; un contor-cronometru &#537;i care stocheaz&#259; num&#259;rul de secunde &icirc;n
            proprietatea Seconds:</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p><a id="t.f9e29f7335cee84d8d2f0452a8168c52ad8c6618"></a><a
        id="t.2"></a>
    <table class="c9">
        <tr class="c10">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c12"><span class="c0">class</span><span class="c1">&nbsp;</span><span
                        class="c5">Counter</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c0">int</span><span
                        class="c1">&nbsp;Seconds { </span><span class="c0">get</span><span class="c1">; </span><span
                        class="c0">set</span><span class="c1">; }<br><br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c0">static</span><span
                        class="c1">&nbsp;</span><span class="c0">implicit</span><span class="c1">&nbsp;</span><span
                        class="c0">operator</span><span class="c1">&nbsp;</span><span class="c5">Counter</span><span
                        class="c1">(</span><span class="c0">int</span><span class="c1">&nbsp;x)<br> &nbsp; &nbsp;{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">return</span><span
                        class="c1">&nbsp;</span><span class="c0">new</span><span class="c1">&nbsp;Counter { Seconds = x
                        };<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c0">public</span><span
                        class="c1">&nbsp;</span><span class="c0">static</span><span class="c1">&nbsp;</span><span
                        class="c0">explicit</span><span class="c1">&nbsp;</span><span class="c0">operator</span><span
                        class="c1">&nbsp;</span><span class="c5">int</span><span class="c1">(Counter counter)<br> &nbsp;
                        &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">return</span><span
                        class="c1">&nbsp;counter.Seconds;<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">Primul operator converte&#537;te un num&#259;r - obiect de tip int la tipul
            Counter. Logica sa este simpl&#259; - se creeaz&#259; un nou obiect Counter, c&#259;ruia i se seteaz&#259;
            proprietatea Seconds.</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">Al doilea operator converte&#537;te obiectul Counter la tipul int, adic&#259;
            ob&#539;ine un num&#259;r din Counter.</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">Aplicarea operatorilor de conversie &icirc;n program:</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p><a id="t.d987c3437b871ad6a4d55956c9837769dbc9ecb2"></a><a
        id="t.3"></a>
    <table class="c9">
        <tr class="c10">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">Counter counter1 = </span><span class="c0">new</span><span
                        class="c1">&nbsp;Counter { Seconds = </span><span class="c3">23</span><span
                        class="c1">&nbsp;};<br><br></span><span class="c0">int</span><span class="c1">&nbsp;x =
                        (</span><span class="c0">int</span><span class="c1">)counter1;<br>Console.WriteLine(x); &nbsp;
                    </span><span class="c14">// 23</span><span class="c1"><br><br>Counter counter2 =
                        x;<br>Console.WriteLine(counter2.Seconds); &nbsp;</span><span class="c14">// 23</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c2">Deoarece opera&#539;ia de conversie din Counter &icirc;n int este definit&#259; cu
            cuv&acirc;ntul cheie </span><span class="c2 c15">explicit</span><span class="c4 c2">, adic&#259; ca o
            conversie explicit&#259;, &icirc;n acest caz este necesar&#259; opera&#539;ia de casting:</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p><a id="t.5878e597de7084051a4eddcfb20e7441781a858f"></a><a
        id="t.4"></a>
    <table class="c9">
        <tr class="c10">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c12"><span class="c0">int</span><span class="c1">&nbsp;x = (</span><span
                        class="c0">int</span><span class="c1">)counter1;</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">&Icirc;n cazul opera&#539;iei de conversie de la int la Counter nu este nevoie de
            nimic similar, deoarece aceast&#259; opera&#539;ie este definit&#259; cu cuv&acirc;ntul cheie implicit,
            adic&#259; ca o conversie implicit&#259;. Ce opera&#539;ii de conversie s&#259; fie f&#259;cute explicite
            &#537;i care implicite este decizia dezvoltatorului.</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">Trebuie avut &icirc;n vedere c&#259; operatorul de conversie a tipurilor trebuie
            s&#259; converteasc&#259; din tipul sau &icirc;n tipul &icirc;n care acest operator este definit. Adic&#259;
            operatorul de conversie definit &icirc;n tipul Counter trebuie s&#259; accepte ca parametru un obiect de tip
            Counter sau s&#259; returneze un obiect de tip Counter.</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">S&#259; examin&#259;m &#537;i conversii mai complexe, de exemplu, dintr-un tip
            compus &icirc;ntr-alt tip compus. S&#259; presupunem c&#259; avem &#537;i clasa Timer:</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p><a id="t.839c2e7320af0cf18a7a221afda1a17c1eea390b"></a><a
        id="t.5"></a>
    <table class="c9">
        <tr class="c10">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c12"><span class="c0">class</span><span class="c1">&nbsp;</span><span
                        class="c5">Timer</span><span class="c1"><br>{<br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c0">int</span><span
                        class="c1">&nbsp;Hours { </span><span class="c0">get</span><span class="c1">; </span><span
                        class="c0">set</span><span class="c1">; }<br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c0">int</span><span
                        class="c1">&nbsp;Minutes { </span><span class="c0">get</span><span class="c1">; </span><span
                        class="c0">set</span><span class="c1">; }<br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c0">int</span><span
                        class="c1">&nbsp;Seconds { </span><span class="c0">get</span><span class="c1">; </span><span
                        class="c0">set</span><span class="c1">; }<br>}<br></span><span class="c0">class</span><span
                        class="c1">&nbsp;</span><span class="c5">Counter</span><span class="c1"><br>{<br> &nbsp;
                        &nbsp;</span><span class="c0">public</span><span class="c1">&nbsp;</span><span
                        class="c0">int</span><span class="c1">&nbsp;Seconds { </span><span class="c0">get</span><span
                        class="c1">; </span><span class="c0">set</span><span class="c1">; }<br><br> &nbsp;
                        &nbsp;</span><span class="c0">public</span><span class="c1">&nbsp;</span><span
                        class="c0">static</span><span class="c1">&nbsp;</span><span class="c0">implicit</span><span
                        class="c1">&nbsp;</span><span class="c0">operator</span><span class="c1">&nbsp;</span><span
                        class="c5">Counter</span><span class="c1">(</span><span class="c0">int</span><span
                        class="c1">&nbsp;x)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">return</span><span class="c1">&nbsp;</span><span class="c0">new</span><span
                        class="c1">&nbsp;Counter { Seconds = x };<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span
                        class="c0">public</span><span class="c1">&nbsp;</span><span class="c0">static</span><span
                        class="c1">&nbsp;</span><span class="c0">explicit</span><span class="c1">&nbsp;</span><span
                        class="c0">operator</span><span class="c1">&nbsp;</span><span class="c5">int</span><span
                        class="c1">(Counter counter)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">return</span><span class="c1">&nbsp;counter.Seconds;<br> &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;</span><span class="c0">public</span><span class="c1">&nbsp;</span><span
                        class="c0">static</span><span class="c1">&nbsp;</span><span class="c0">explicit</span><span
                        class="c1">&nbsp;</span><span class="c0">operator</span><span class="c1">&nbsp;</span><span
                        class="c5">Counter</span><span class="c1">(Timer timer)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c0">int</span><span class="c1">&nbsp;h = timer.Hours *
                    </span><span class="c3">3600</span><span class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">int</span><span class="c1">&nbsp;m = timer.Minutes * </span><span
                        class="c3">60</span><span class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">return</span><span class="c1">&nbsp;</span><span class="c0">new</span><span
                        class="c1">&nbsp;Counter { Seconds = h + m + timer.Seconds };<br> &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;</span><span class="c0">public</span><span class="c1">&nbsp;</span><span
                        class="c0">static</span><span class="c1">&nbsp;</span><span class="c0">implicit</span><span
                        class="c1">&nbsp;</span><span class="c0">operator</span><span class="c1">&nbsp;</span><span
                        class="c5">Timer</span><span class="c1">(Counter counter)<br> &nbsp; &nbsp;{<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c0">int</span><span class="c1">&nbsp;h = counter.Seconds /
                    </span><span class="c3">3600</span><span class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">int</span><span class="c1">&nbsp;m = (counter.Seconds % </span><span
                        class="c3">3600</span><span class="c1">) / </span><span class="c3">60</span><span
                        class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">int</span><span
                        class="c1">&nbsp;s = counter.Seconds % </span><span class="c3">60</span><span class="c1">;<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">return</span><span
                        class="c1">&nbsp;</span><span class="c0">new</span><span class="c1">&nbsp;Timer { Hours = h,
                        Minutes = m, Seconds = s };<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6"><span class="c4 c2">Clasa Timer reprezint&#259; un cronometru care stocheaz&#259; orele, minutele
            &#537;i secundele. Clasa Counter reprezint&#259; un contor-cronometru care stocheaz&#259; num&#259;rul de
            secunde. Pornind de la aceasta, putem defini o anumit&#259; logic&#259; de conversie dintr-un tip &icirc;n
            altul, adic&#259; ob&#539;inerea din secunde &icirc;n obiectul Counter a orelor, minutelor &#537;i
            secundelor &icirc;n obiectul Timer. De exemplu, 3675 secunde &icirc;nseamn&#259; 1 or&#259;, 1 minut &#537;i
            15 secunde.</span></p>
    <p class="c6 c7"><span class="c2 c4"></span></p>
    <p class="c6"><span class="c4 c2">Aplicarea opera&#539;iilor de conversie:</span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p><a id="t.607b03c794f6c5a89212f3e02b3f8c3457ad8953"></a><a
        id="t.6"></a>
    <table class="c9">
        <tr class="c10">
            <td class="c11" colspan="1" rowspan="1">
                <p class="c12"><span class="c1">Counter counter1 = </span><span class="c0">new</span><span
                        class="c1">&nbsp;Counter { Seconds = </span><span class="c3">115</span><span
                        class="c1">&nbsp;};<br><br>Timer timer = counter1;<br>Console.WriteLine(</span><span
                        class="c17">$&quot;{timer.Hours}:{timer.Minutes}:{timer.Seconds}&quot;</span><span class="c1">);
                    </span><span class="c14">// 0:1:55</span><span class="c1"><br><br>Counter counter2 =
                        (Counter)timer;<br>Console.WriteLine(counter2.Seconds); &nbsp;</span><span
                        class="c14">//115</span></p>
            </td>
        </tr>
    </table>
    <p class="c6 c7"><span class="c4 c2"></span></p>
    <p class="c6 c7"><span class="c4 c2"></span></p>
</body>

</html>