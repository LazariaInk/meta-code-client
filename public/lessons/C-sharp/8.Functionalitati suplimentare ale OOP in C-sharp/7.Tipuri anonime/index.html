<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c13 doc-content">
    <h1 class="c4 c16">Tipuri anonime.</h1>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c12">Tipurile anonime permit crearea unui obiect cu un anumit set de
            propriet&#259;&#539;i f&#259;r&#259; a defini o clas&#259;. Un tip anonim este definit cu ajutorul
            cuv&acirc;ntului cheie </span><span class="c7">var </span><span class="c0">&#537;i al ini&#539;ializatorului
            de obiecte:</span></p>
    <p class="c4 c6"><span class="c0"></span></p><a id="t.70fa8a8a2e22cb34c23f2baa989516dcaac7a053"></a><a id="t.0"></a>
    <table class="c8">
        <tr class="c9">
            <td class="c5" colspan="1" rowspan="1">
                <p class="c11"><span class="c2">var</span><span class="c1">&nbsp;user = </span><span
                        class="c2">new</span><span class="c1">&nbsp;{ Name = </span><span
                        class="c10">&quot;Tom&quot;</span><span class="c1">, Age = </span><span
                        class="c3">34</span><span class="c1">&nbsp;};<br>Console.WriteLine(user.Name);</span></p>
            </td>
        </tr>
    </table>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">&Icirc;n acest caz, user este un obiect de tip anonim, care are definite dou&#259;
            propriet&#259;&#539;i Name &#537;i Age. Putem folosi propriet&#259;&#539;ile acestuia la fel ca &#537;i
            &icirc;n cazul obiectelor claselor obi&#537;nuite. Totu&#537;i, exist&#259; o limitare -
            propriet&#259;&#539;ile tipurilor anonime sunt disponibile doar pentru citire.</span></p>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">&Icirc;n timpul compil&#259;rii, compilatorul va crea automat un nume de tip pentru
            el &#537;i va folosi acest nume la accesarea obiectului. Adesea, tipurile anonime au un nume de genul
            &lt;&gt;f__AnonymousType0&#39;2.</span></p>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">Pentru mediul de execu&#539;ie CLR, tipurile anonime vor reprezenta, la fel ca
            &#537;i clasele, un tip referen&#539;ial.</span></p>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">Dac&#259; &icirc;n program sunt folosite mai multe obiecte de tip anonim cu
            acela&#537;i set de propriet&#259;&#539;i, compilatorul va crea o singur&#259; defini&#539;ie a tipului
            anonim:</span></p>
    <p class="c4 c6"><span class="c0"></span></p><a id="t.3fe9800ae02e9778f9e35c34977cbb05e608cbcf"></a><a id="t.1"></a>
    <table class="c8">
        <tr class="c9">
            <td class="c5" colspan="1" rowspan="1">
                <p class="c11"><span class="c2">var</span><span class="c1">&nbsp;user = </span><span
                        class="c2">new</span><span class="c1">&nbsp;{ Name = </span><span
                        class="c10">&quot;Tom&quot;</span><span class="c1">, Age = </span><span
                        class="c3">34</span><span class="c1">&nbsp;};<br></span><span class="c2">var</span><span
                        class="c1">&nbsp;student = </span><span class="c2">new</span><span class="c1">&nbsp;{ Name =
                    </span><span class="c10">&quot;Alice&quot;</span><span class="c1">, Age = </span><span
                        class="c3">21</span><span class="c1">&nbsp;};<br></span><span class="c2">var</span><span
                        class="c1">&nbsp;manager = </span><span class="c2">new</span><span class="c1">&nbsp;{ Name =
                    </span><span class="c10">&quot;Bob&quot;</span><span class="c1">, Age = </span><span
                        class="c3">26</span><span class="c1">, Company = </span><span
                        class="c10">&quot;Microsoft&quot;</span><span
                        class="c1">&nbsp;};<br><br>Console.WriteLine(user.GetType().Name); </span><span class="c14">//
                        &lt;&gt;f__AnonymousType0&#39;2</span><span
                        class="c1"><br>Console.WriteLine(student.GetType().Name); </span><span class="c14">//
                        &lt;&gt;f__AnonymousType0&#39;2</span><span
                        class="c1"><br>Console.WriteLine(manager.GetType().Name); </span><span class="c14">//
                        &lt;&gt;f__AnonymousType1&#39;3</span></p>
            </td>
        </tr>
    </table>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">Aici, user &#537;i student vor avea aceea&#537;i defini&#539;ie a tipului anonim. Cu
            toate acestea, astfel de obiecte nu pot fi convertite la alt tip, de exemplu, la o clas&#259;, chiar
            dac&#259; aceasta are un set similar de propriet&#259;&#539;i.</span></p>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">Trebuie luat &icirc;n considerare faptul c&#259; propriet&#259;&#539;ile unui obiect
            anonim pot fi setate doar &icirc;n ini&#539;ializator. &Icirc;n afara ini&#539;ializatorului nu le putem
            atribui valori. Astfel, de exemplu, &icirc;n urm&#259;torul caz vom &icirc;nt&acirc;mpina o eroare:</span>
    </p>
    <p class="c4 c6"><span class="c0"></span></p><a id="t.2b0d20d8d49f0f0a9984b3769df680f87461a3bf"></a><a id="t.2"></a>
    <table class="c8">
        <tr class="c9">
            <td class="c5" colspan="1" rowspan="1">
                <p class="c11"><span class="c2">var</span><span class="c1">&nbsp;student = </span><span
                        class="c2">new</span><span class="c1">&nbsp;{ Name = </span><span
                        class="c10">&quot;Alice&quot;</span><span class="c1">, Age = </span><span
                        class="c3">21</span><span class="c1">&nbsp;};<br>student.Age = </span><span
                        class="c3">32</span><span class="c1">; &nbsp; </span><span class="c14">// ! Eroare</span></p>
            </td>
        </tr>
    </table>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c12">Pe l&acirc;ng&#259; forma de ini&#539;ializare folosit&#259; mai sus, c&acirc;nd
            atribuim propriet&#259;&#539;ilor anumite valori, putem folosi &#537;i </span><span
            class="c7">ini&#539;ializatori cu proiec&#539;ie</span><span class="c0">, unde putem transmite &icirc;n
            ini&#539;ializator anumi&#539;i identificatori ale c&#259;ror nume vor fi folosite ca denumiri ale
            propriet&#259;&#539;ilor:</span></p>
    <p class="c4 c6"><span class="c0"></span></p><a id="t.d51ca7fbdd0e0ecdd25c29a887d6b70a7f17a2ec"></a><a id="t.3"></a>
    <table class="c8">
        <tr class="c9">
            <td class="c5" colspan="1" rowspan="1">
                <p class="c11"><span class="c1">Person tom = </span><span class="c2">new</span><span
                        class="c1">&nbsp;Person(</span><span class="c10">&quot;Tom&quot;</span><span
                        class="c1">);<br></span><span class="c2">int</span><span class="c1">&nbsp;age = </span><span
                        class="c3">34</span><span class="c1">;<br></span><span class="c2">var</span><span
                        class="c1">&nbsp;student = </span><span class="c2">new</span><span class="c1">&nbsp;{ tom.Name,
                        age }; </span><span class="c14">// ini&#539;ializator cu proiec&#539;ie</span><span
                        class="c1"><br>Console.WriteLine(student.Name);<br>Console.WriteLine(student.age);<br><br></span><span
                        class="c2">class</span><span class="c1">&nbsp;</span><span class="c15">Person</span><span
                        class="c1"><br>{<br> &nbsp; &nbsp;</span><span class="c2">public</span><span
                        class="c1">&nbsp;</span><span class="c2">string</span><span class="c1">&nbsp;Name { </span><span
                        class="c2">get</span><span class="c1">; </span><span class="c2">set</span><span class="c1">;
                        }<br> &nbsp; &nbsp;</span><span class="c2">public</span><span class="c1">&nbsp;</span><span
                        class="c15">Person</span><span class="c1">(</span><span class="c2">string</span><span
                        class="c1">&nbsp;name) =&gt; Name = name;<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">&Icirc;n acest caz, definirea obiectului anonim va fi de fapt identic&#259; cu
            urm&#259;toarea:</span></p>
    <p class="c4 c6"><span class="c0"></span></p><a id="t.d44557822a6e91b07a89a46bade62d918df87729"></a><a id="t.4"></a>
    <table class="c8">
        <tr class="c9">
            <td class="c5" colspan="1" rowspan="1">
                <p class="c11"><span class="c2">var</span><span class="c1">&nbsp;student = </span><span
                        class="c2">new</span><span class="c1">&nbsp;{ Name = tom.Name, age = age};</span></p>
            </td>
        </tr>
    </table>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">Denumirile propriet&#259;&#539;ilor &#537;i variabilelor (Name &#537;i age) vor fi
            folosite ca denumiri ale propriet&#259;&#539;ilor obiectului.</span></p>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">De asemenea, putem defini array-uri de obiecte de tip anonim:</span></p>
    <p class="c4 c6"><span class="c0"></span></p><a id="t.b22c726481cd2645e4f2dfac63d47e94556d340c"></a><a id="t.5"></a>
    <table class="c8">
        <tr class="c9">
            <td class="c5" colspan="1" rowspan="1">
                <p class="c11"><span class="c2">var</span><span class="c1">&nbsp;people = </span><span
                        class="c2">new</span><span class="c1">[]<br>{<br> &nbsp; &nbsp;</span><span
                        class="c2">new</span><span class="c1">&nbsp;{Name=</span><span
                        class="c10">&quot;Tom&quot;</span><span class="c1">},<br> &nbsp; &nbsp;</span><span
                        class="c2">new</span><span class="c1">&nbsp;{Name=</span><span
                        class="c10">&quot;Bob&quot;</span><span class="c1">}<br>};<br></span><span
                        class="c2">foreach</span><span class="c1">(</span><span class="c2">var</span><span
                        class="c1">&nbsp;p </span><span class="c2">in</span><span class="c1">&nbsp;people)<br>{<br>
                        &nbsp; &nbsp;Console.WriteLine(p.Name);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c4 c6"><span class="c0"></span></p>
    <p class="c4"><span class="c0">De ce sunt necesare tipurile anonime? Uneori apare necesitatea de a folosi un tip
            &icirc;ntr-un context restr&acirc;ns sau chiar o singur&#259; dat&#259;. Crearea unei clase pentru un astfel
            de tip poate fi redundant&#259;. Dac&#259; dorim s&#259; ad&#259;ug&#259;m o proprietate, o putem face
            direct la locul obiectului anonim. &Icirc;n cazul unei clase, ar trebui s&#259; modific&#259;m &#537;i
            clasa, care poate s&#259; nu mai fie folosit&#259; &icirc;n alt&#259; parte. O situa&#539;ie tipic&#259;
            este ob&#539;inerea rezultatului unei selec&#539;ii dintr-o baz&#259; de date: obiectele sunt folosite doar
            pentru a ob&#539;ine selec&#539;ia &#537;i adesea nu mai sunt folosite &icirc;n alt&#259; parte, iar crearea
            unor clase pentru ele ar fi excesiv&#259;. Un obiect anonim este ideal pentru stocarea temporar&#259; a
            selec&#539;iei.</span></p>
    <p class="c4 c6"><span class="c0"></span></p>
</body>

</html>