<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><link rel="stylesheet" type="text/css" href="/lessons/styles.css"></head><body class="c21 doc-content"><p class="c5"><span class="c12">FileStream. Citirea &#537;i scrierea fi&#537;ierelor.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">Clasa </span><span class="c14">FileStream </span><span class="c0">ofer&#259; posibilit&#259;&#539;i pentru citirea &#537;i scrierea fi&#537;ierelor. Aceasta permite lucrul at&acirc;t cu fi&#537;iere text, c&acirc;t &#537;i cu fi&#537;iere binare.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c17">Crearea unui FileStream.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Pentru a crea un obiect FileStream, se pot utiliza fie constructorii acestei clase, fie metodele statice ale clasei File. Constructorul FileStream are multe versiuni supra&icirc;nc&#259;rcate, dintre care una dintre cele mai simple &#537;i utilizate este:</span></p><p class="c1"><span class="c0"></span></p><a id="t.14971e827b15055cbf526f4af56ab061c4268301"></a><a id="t.0"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">FileStream(</span><span class="c3">string</span><span class="c2">&nbsp;filename, FileMode mode)</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">Aici, constructorul prime&#537;te doi parametri: calea c&#259;tre fi&#537;ier &#537;i enumerarea </span><span class="c14">FileMode</span><span class="c0">. Aceast&#259; enumerare indic&#259; modul de acces la fi&#537;ier &#537;i poate lua urm&#259;toarele valori:</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">Append</span><span class="c0">: dac&#259; fi&#537;ierul exist&#259;, textul este ad&#259;ugat la sf&acirc;r&#537;itul fi&#537;ierului. Dac&#259; fi&#537;ierul nu exist&#259;, acesta este creat. Fi&#537;ierul este deschis doar pentru scriere.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">Create</span><span class="c0">: se creeaz&#259; un fi&#537;ier nou. Dac&#259; un astfel de fi&#537;ier deja exist&#259;, acesta este suprascris.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">CreateNew</span><span class="c0">: se creeaz&#259; un fi&#537;ier nou. Dac&#259; un astfel de fi&#537;ier deja exist&#259;, aplica&#539;ia va arunca o eroare.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">Open</span><span class="c0">: deschide fi&#537;ierul. Dac&#259; fi&#537;ierul nu exist&#259;, va arunca o excep&#539;ie.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">OpenOrCreate</span><span class="c0">: dac&#259; fi&#537;ierul exist&#259;, acesta este deschis; dac&#259; nu, se creeaz&#259; un fi&#537;ier nou.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">Truncate</span><span class="c0">: dac&#259; fi&#537;ierul exist&#259;, acesta este suprascris. Fi&#537;ierul este deschis doar pentru scriere.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">O alt&#259; modalitate de a crea un obiect FileStream este prin metodele statice ale clasei File:</span></p><p class="c1"><span class="c0"></span></p><a id="t.a096feeac03f41f7f72c9b0237de489af414dfeb"></a><a id="t.1"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">FileStream File.Open(</span><span class="c3">string</span><span class="c2">&nbsp;file, FileMode mode);<br>FileStream File.OpenRead(</span><span class="c3">string</span><span class="c2">&nbsp;file);<br>FileStream File.OpenWrite(</span><span class="c3">string</span><span class="c2">&nbsp;file);</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Prima metod&#259; deschide fi&#537;ierul &#539;in&acirc;nd cont de obiectul FileMode &#537;i returneaz&#259; un flux de fi&#537;ier FileStream. Aceast&#259; metod&#259; are &#537;i c&acirc;teva versiuni supra&icirc;nc&#259;rcate. A doua metod&#259; deschide fluxul pentru citire, iar a treia deschide fluxul pentru scriere.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c17">&Icirc;nchiderea fluxului.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">Clasa FileStream implementeaz&#259; interfa&#539;a IDisposable pentru eliberarea tuturor resurselor asociate cu fi&#537;ierul. Dup&#259; ce a&#539;i terminat de lucrat cu FileStream, trebuie s&#259; elibera&#539;i fi&#537;ierul asociat prin apelarea metodei Dispose. Pentru &icirc;nchiderea corect&#259;, pute&#539;i apela metoda </span><span class="c14">Close()</span><span class="c0">, care la r&acirc;ndul s&#259;u apeleaz&#259; metoda Dispose:</span></p><p class="c1"><span class="c0"></span></p><a id="t.bb56b0ef0db9f72ae36239319dcc3fb6aebb8cc9"></a><a id="t.2"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">FileStream? fstream = </span><span class="c3">null</span><span class="c2">;<br></span><span class="c3">try</span><span class="c2"><br>{<br> &nbsp; &nbsp;fstream = </span><span class="c3">new</span><span class="c2">&nbsp;FileStream(</span><span class="c6">&quot;note3.dat&quot;</span><span class="c2">, FileMode.OpenOrCreate);<br> &nbsp; &nbsp;</span><span class="c10">// opera&#539;iuni cu fstream</span><span class="c2"><br>}<br></span><span class="c3">catch</span><span class="c2">(Exception ex)<br>{ &nbsp;}<br></span><span class="c3">finally</span><span class="c2"><br>{<br> &nbsp; &nbsp;fstream?.Close();<br>}</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Sau pute&#539;i folosi structura using, care va elibera automat toate resursele asociate cu FileStream:</span></p><p class="c1"><span class="c0"></span></p><a id="t.7008578066623e97bba1579a2c06f6fac12cd923"></a><a id="t.3"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c3">using</span><span class="c2">&nbsp;(FileStream fstream = </span><span class="c3">new</span><span class="c2">&nbsp;FileStream(</span><span class="c6">&quot;note3.dat&quot;</span><span class="c2">, FileMode.OpenOrCreate))<br>{<br> &nbsp; &nbsp;</span><span class="c10">// opera&#539;iuni cu fstream</span><span class="c2"><br>}</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c17">Propriet&#259;&#539;i &#537;i metode ale FileStream.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">Cele mai importante propriet&#259;&#539;i ale clasei </span><span class="c14">FileStream </span><span class="c0">sunt:</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">Length</span><span class="c0">: returneaz&#259; lungimea fluxului &icirc;n bytes.</span></p><p class="c1"><span class="c14 c20"></span></p><p class="c5"><span class="c4">- </span><span class="c14">Position</span><span class="c0">: returneaz&#259; pozi&#539;ia curent&#259; &icirc;n flux.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">Name</span><span class="c0">: returneaz&#259; calea absolut&#259; c&#259;tre fi&#537;ierul deschis &icirc;n FileStream.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">Pentru citirea/scrierea fi&#537;ierelor, se pot utiliza urm&#259;toarele metode ale clasei </span><span class="c14">FileStream</span><span class="c0">:</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">-</span><span class="c4 c8">void</span><span class="c4">&nbsp;</span><span class="c4 c8">CopyTo(Stream destination)</span><span class="c0">: copie datele din fluxul curent &icirc;n fluxul destination.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">-</span><span class="c4 c8">&nbsp;Task CopyToAsync(Stream destination)</span><span class="c0">: versiunea asincron&#259; a metodei CopyTo.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c4 c8">void Flush()</span><span class="c0">: gole&#537;te con&#539;inutul bufferului &icirc;n fi&#537;ier.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c4 c8">Task FlushAsync()</span><span class="c0">: versiunea asincron&#259; a metodei Flush.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">-</span><span class="c4 c8">&nbsp;int Read(byte[] array, int offset, int count)</span><span class="c0">: cite&#537;te datele din fi&#537;ier &icirc;ntr-un array de bytes &#537;i returneaz&#259; num&#259;rul de bytes citi&#539;i. Prime&#537;te trei parametri:</span></p><p class="c1"><span class="c0"></span></p><ul class="c19 lst-kix_ok97nnlxldzr-0 start"><li class="c5 c16 li-bullet-0"><span class="c4">&nbsp; &nbsp;</span><span class="c4 c8">array </span><span class="c0">- array-ul de bytes &icirc;n care vor fi plasate datele citite din fi&#537;ier.</span></li></ul><p class="c1 c18"><span class="c0"></span></p><ul class="c19 lst-kix_ok97nnlxldzr-0"><li class="c5 c16 li-bullet-0"><span class="c4">&nbsp; &nbsp;</span><span class="c4 c8">offset </span><span class="c0">- reprezint&#259; deplasarea &icirc;n bytes &icirc;n array-ul array, &icirc;n care bytes-ii citi&#539;i vor fi plasa&#539;i.</span></li></ul><p class="c1 c18"><span class="c0"></span></p><ul class="c19 lst-kix_ok97nnlxldzr-0"><li class="c5 c16 li-bullet-0"><span class="c4">&nbsp; &nbsp;</span><span class="c4 c8">count </span><span class="c0">- num&#259;rul maxim de bytes care urmeaz&#259; s&#259; fie citi&#539;i.</span></li></ul><p class="c1"><span class="c0"></span></p><ul class="c19 lst-kix_fslxrvway0ks-0 start"><li class="c5 c16 li-bullet-0"><span class="c4">&nbsp;</span><span class="c4 c8">Task&lt;int&gt; ReadAsync(byte[] array, int offset, int count)</span><span class="c0">: versiunea asincron&#259; a metodei Read.</span></li></ul><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c4 c8">long Seek(long offset, SeekOrigin origin)</span><span class="c0">: seteaz&#259; pozi&#539;ia &icirc;n flux cu deplasare pe baza num&#259;rului de bytes indicat &icirc;n parametrul offset.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">-</span><span class="c4 c8">&nbsp;void Write(byte[] array, int offset, int count)</span><span class="c0">: scrie datele din array-ul de bytes &icirc;n fi&#537;ier. Prime&#537;te trei parametri:</span></p><p class="c1"><span class="c0"></span></p><ul class="c19 lst-kix_hl88rmo0bpi4-0 start"><li class="c5 c16 li-bullet-0"><span class="c4">&nbsp; &nbsp;</span><span class="c4 c8">array </span><span class="c0">- array-ul de bytes din care datele vor fi scrise &icirc;n fi&#537;ier.</span></li></ul><p class="c1 c18"><span class="c0"></span></p><ul class="c19 lst-kix_hl88rmo0bpi4-0"><li class="c5 c16 li-bullet-0"><span class="c4">&nbsp; &nbsp;</span><span class="c4 c8">offset </span><span class="c0">- deplasarea &icirc;n bytes &icirc;n array-ul array, de unde &icirc;ncepe scrierea bytes-ilor &icirc;n flux.</span></li></ul><p class="c1 c18"><span class="c0"></span></p><ul class="c19 lst-kix_hl88rmo0bpi4-0"><li class="c5 c16 li-bullet-0"><span class="c4">&nbsp; &nbsp;</span><span class="c4 c8">count </span><span class="c0">- num&#259;rul maxim de bytes care urmeaz&#259; s&#259; fie scri&#537;i.</span></li></ul><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">-</span><span class="c4 c8">&nbsp;Task WriteAsync(byte[] array, int offset, int count)</span><span class="c0">: versiunea asincron&#259; a metodei Write.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c17">Citirea &#537;i scrierea fi&#537;ierelor.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">FileStream ofer&#259; acces la fi&#537;iere la nivel de bytes, a&#537;a c&#259;, de exemplu, dac&#259; trebuie s&#259; citi&#539;i sau s&#259; scrie&#539;i una sau mai multe linii &icirc;ntr-un fi&#537;ier text, trebuie s&#259; transforma&#539;i array-ul de bytes &icirc;n stringuri folosind metode speciale. De aceea, pentru lucrul cu fi&#537;iere text sunt utilizate alte clase.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Totu&#537;i, c&acirc;nd lucra&#539;i cu fi&#537;iere binare care au o anumit&#259; structur&#259;, FileStream poate fi foarte util pentru extragerea anumitor por&#539;iuni de informa&#539;ii &#537;i procesarea lor.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">S&#259; vedem un exemplu de citire &#537;i scriere &icirc;ntr-un fi&#537;ier text:</span></p><p class="c1"><span class="c0"></span></p><a id="t.d657f653ebc4c6f2ac9d4fc65bb38f41e6de9fef"></a><a id="t.4"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c3">using</span><span class="c2">&nbsp;System.Text;<br> <br></span><span class="c3">string</span><span class="c2">&nbsp;path = </span><span class="c6">@&quot;C:\app\note.txt&quot;</span><span class="c2">; &nbsp; </span><span class="c10">// calea c&#259;tre fi&#537;ier</span><span class="c2"><br> <br></span><span class="c3">string</span><span class="c2">&nbsp;text = </span><span class="c6">&quot;Hello FDC.COM&quot;</span><span class="c2">; </span><span class="c10">// textul pentru scriere</span><span class="c2"><br> <br></span><span class="c10">// scrierea &icirc;n fi&#537;ier</span><span class="c2"><br></span><span class="c3">using</span><span class="c2">&nbsp;(FileStream fstream = </span><span class="c3">new</span><span class="c2">&nbsp;FileStream(path, FileMode.OpenOrCreate))<br>{<br> &nbsp; &nbsp;</span><span class="c10">// transform&#259;m string-ul &icirc;n bytes</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">byte</span><span class="c2">[] buffer = Encoding.Default.GetBytes(text);<br> &nbsp; &nbsp;</span><span class="c10">// scrierea array-ului de bytes &icirc;n fi&#537;ier</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">await</span><span class="c2">&nbsp;fstream.WriteAsync(buffer, </span><span class="c15">0</span><span class="c2">, buffer.Length);<br> &nbsp; &nbsp;Console.WriteLine(</span><span class="c6">&quot;Textul a fost scris &icirc;n fi&#537;ier&quot;</span><span class="c2">);<br>}<br> <br></span><span class="c10">// citirea din fi&#537;ier</span><span class="c2"><br></span><span class="c3">using</span><span class="c2">&nbsp;(FileStream fstream = File.OpenRead(path))<br>{<br> &nbsp; &nbsp;</span><span class="c10">// aloc&#259;m un array pentru citirea datelor din fi&#537;ier</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">byte</span><span class="c2">[] buffer = </span><span class="c3">new</span><span class="c2">&nbsp;</span><span class="c3">byte</span><span class="c2">[fstream.Length];<br> &nbsp; &nbsp;</span><span class="c10">// citirea datelor</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">await</span><span class="c2">&nbsp;fstream.ReadAsync(buffer, </span><span class="c15">0</span><span class="c2">, buffer.Length);<br> &nbsp; &nbsp;</span><span class="c10">// decod&#259;m bytes &icirc;n string</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">string</span><span class="c2">&nbsp;textFromFile = Encoding.Default.GetString(buffer);<br> &nbsp; &nbsp;Console.WriteLine(</span><span class="c6">$&quot;Textul din fi&#537;ier: {textFromFile}&quot;</span><span class="c2">);<br>}</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">&Icirc;n acest exemplu, definim calea c&#259;tre fi&#537;ier &#537;i textul pentru scriere. </span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">At&acirc;t la citire, c&acirc;t &#537;i la scriere, pentru crearea &#537;i eliminarea obiectului FileStream se utilizeaz&#259; structura </span><span class="c4 c8">using</span><span class="c4">, la sf&acirc;r&#537;itul c&#259;reia pentru obiectul FileStream creat se apeleaz&#259; automat metoda </span><span class="c4 c8">Dispose</span><span class="c0">, iar astfel obiectul este distrus.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">Deoarece opera&#539;iile cu fi&#537;iere pot dura mult timp &#537;i reprezint&#259; un punct sensibil &icirc;n func&#539;ionarea programului, se recomand&#259; utilizarea versiunilor asincrone ale metodelor FileStream. At&acirc;t la scriere, c&acirc;t &#537;i la citire, se folose&#537;te obiectul de codificare</span><span class="c4 c8">&nbsp;Encoding.Default </span><span class="c4">din spa&#539;iul de nume </span><span class="c4 c8">System.Text</span><span class="c4">. &Icirc;n acest caz, folosim dou&#259; metode ale acestuia: </span><span class="c4 c8">GetBytes </span><span class="c4">pentru ob&#539;inerea unui array de bytes dintr-un string &#537;i </span><span class="c4 c8">GetString </span><span class="c0">pentru ob&#539;inerea unui string dintr-un array de bytes.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">&Icirc;n final, textul introdus de noi este scris &icirc;n fi&#537;ierul note.txt &#537;i vom ob&#539;ine urm&#259;torul rezultat &icirc;n consol&#259;:</span></p><p class="c1"><span class="c0"></span></p><a id="t.a5708ac9a4b21b25e597c23e3a41bbdb9bf67cc6"></a><a id="t.5"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">Textul a fost scris &icirc;n fi&#537;ier<br>Textul din fi&#537;ier: Hello FDC.COM</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Fi&#537;ierul scris este, &icirc;n esen&#539;&#259;, un fi&#537;ier binar (nu text), de&#537;i dac&#259; scriem doar un string &icirc;n el, putem s&#259;-l vizualiz&#259;m &icirc;ntr-un mod lizibil, deschiz&acirc;ndu-l &icirc;ntr-un editor de text. Totu&#537;i, dac&#259; scriem bytes aleatorii &icirc;n el, de exemplu</span></p><p class="c1"><span class="c0"></span></p><a id="t.e7c7f01f8c5c4b5f4692bf5cccacebba50179578"></a><a id="t.6"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">fstream.WriteByte(</span><span class="c15">13</span><span class="c2">);<br>fstream.WriteByte(</span><span class="c15">103</span><span class="c2">);</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Atunci pot ap&#259;rea probleme &icirc;n interpretarea acestuia. De aceea, pentru lucrul cu fi&#537;iere text sunt destinate alte clase - StreamReader &#537;i StreamWriter.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c17">Acces aleatoriu la fi&#537;iere.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Adesea, fi&#537;ierele binare au o anumit&#259; structur&#259;. Cunosc&acirc;nd aceast&#259; structur&#259;, putem extrage por&#539;iunea necesar&#259; de informa&#539;ii din fi&#537;ier sau, invers, putem scrie &icirc;ntr-o anumit&#259; pozi&#539;ie a fi&#537;ierului un set specific de bytes. De exemplu, &icirc;n fi&#537;ierele .wav, datele audio &icirc;ncep de la byte-ul 44, iar p&acirc;n&#259; la byte-ul 44 se afl&#259; diferite metadate - num&#259;rul de canale audio, frecven&#539;a de e&#537;antionare etc.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">Cu ajutorul metodei </span><span class="c14">Seek() </span><span class="c0">putem controla pozi&#539;ia cursorului fluxului, de la care &icirc;ncepe citirea sau scrierea &icirc;n fi&#537;ier. Aceast&#259; metod&#259; prime&#537;te doi parametri: offset (deplasare) &#537;i pozi&#539;ia &icirc;n fi&#537;ier. Pozi&#539;ia &icirc;n fi&#537;ier este descris&#259; de trei valori:</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">SeekOrigin.Begin</span><span class="c0">: &icirc;nceputul fi&#537;ierului</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">SeekOrigin.End</span><span class="c0">: sf&acirc;r&#537;itul fi&#537;ierului</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c4">- </span><span class="c14">SeekOrigin.Current</span><span class="c0">: pozi&#539;ia curent&#259; &icirc;n fi&#537;ier</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Cursorul fluxului, de la care &icirc;ncepe citirea sau scrierea, este deplasat &icirc;nainte pe baza valorii offset &icirc;n raport cu pozi&#539;ia specificat&#259; ca al doilea parametru. Deplasarea poate fi negativ&#259;, atunci cursorul se deplaseaz&#259; &icirc;napoi; dac&#259; este pozitiv&#259;, se deplaseaz&#259; &icirc;nainte.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">S&#259; vedem un exemplu simplu:</span></p><p class="c1"><span class="c0"></span></p><a id="t.c683e2752c369c74b77e49dfabf7896bdc05942b"></a><a id="t.7"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c3">using</span><span class="c2">&nbsp;System.Text;<br> <br></span><span class="c3">string</span><span class="c2">&nbsp;path = </span><span class="c6">&quot;note.dat&quot;</span><span class="c2">;<br> <br></span><span class="c3">string</span><span class="c2">&nbsp;text = </span><span class="c6">&quot;hello world&quot;</span><span class="c2">;<br> <br></span><span class="c3">using</span><span class="c2">&nbsp;(FileStream fstream = </span><span class="c3">new</span><span class="c2">&nbsp;FileStream(path, FileMode.OpenOrCreate))<br>{<br> &nbsp; &nbsp;</span><span class="c10">// transform&#259;m string-ul &icirc;n bytes</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">byte</span><span class="c2">[] input = Encoding.Default.GetBytes(text);<br> &nbsp; &nbsp;</span><span class="c10">// scrierea array-ului de bytes &icirc;n fi&#537;ier</span><span class="c2"><br> &nbsp; &nbsp;fstream.Write(input, </span><span class="c15">0</span><span class="c2">, input.Length);<br> &nbsp; &nbsp;Console.WriteLine(</span><span class="c6">&quot;Textul a fost scris &icirc;n fi&#537;ier&quot;</span><span class="c2">);<br>}<br></span><span class="c10">// citirea unei p&#259;r&#539;i din fi&#537;ier</span><span class="c2"><br></span><span class="c3">using</span><span class="c2">&nbsp;(FileStream fstream = </span><span class="c3">new</span><span class="c2">&nbsp;FileStream(path, FileMode.OpenOrCreate))<br>{ <br> &nbsp; &nbsp;</span><span class="c10">// deplas&#259;m cursorul la sf&acirc;r&#537;itul fi&#537;ierului, cu cinci bytes &icirc;nainte de sf&acirc;r&#537;it</span><span class="c2"><br> &nbsp; &nbsp;fstream.Seek(</span><span class="c15">-5</span><span class="c2">, SeekOrigin.End); </span><span class="c10">// minus 5 caractere de la sf&acirc;r&#537;itul fluxului</span><span class="c2"><br> <br> &nbsp; &nbsp;</span><span class="c10">// citim cinci bytes de la pozi&#539;ia curent&#259;</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">byte</span><span class="c2">[] output = </span><span class="c3">new</span><span class="c2">&nbsp;</span><span class="c3">byte</span><span class="c2">[</span><span class="c15">5</span><span class="c2">];<br> &nbsp; &nbsp;</span><span class="c3">await</span><span class="c2">&nbsp;fstream.ReadAsync(output, </span><span class="c15">0</span><span class="c2">, output.Length);<br> &nbsp; &nbsp;</span><span class="c10">// decod&#259;m bytes &icirc;n string</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">string</span><span class="c2">&nbsp;textFromFile = Encoding.Default.GetString(output);<br> &nbsp; &nbsp;Console.WriteLine(</span><span class="c6">$&quot;Textul din fi&#537;ier: {textFromFile}&quot;</span><span class="c2">); </span><span class="c10">// world</span><span class="c2"><br>}</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Mai &icirc;nt&acirc;i, scriem &icirc;n fi&#537;ier textul &quot;hello world&quot;. Apoi, acces&#259;m din nou fi&#537;ierul pentru citire. Ini&#539;ial, deplas&#259;m cursorul cu cinci caractere &icirc;napoi &icirc;n raport cu sf&acirc;r&#537;itul fluxului de fi&#537;iere:</span></p><p class="c1"><span class="c0"></span></p><a id="t.71ce154ec91909731c3e4deadbd689aefc70d603"></a><a id="t.8"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">fstream.Seek(</span><span class="c15">-5</span><span class="c2">, SeekOrigin.End)</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 460.00px; height: 201.00px;"><img alt="" src="images/image1.png" style="width: 460.00px; height: 201.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Dup&#259; efectuarea acestei opera&#539;iuni, cursorul va fi pozi&#539;ionat pe caracterul &quot;w&quot;.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Dup&#259; aceasta, citim cinci bytes &icirc;ncep&acirc;nd cu caracterul &quot;w&quot;. &Icirc;n codificarea implicit&#259;, 1 caracter reprezint&#259; 1 byte. Prin urmare, citirea a 5 bytes este echivalent&#259; cu citirea a cinci caractere: &quot;world&quot;.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Astfel, ob&#539;inem urm&#259;torul rezultat &icirc;n consol&#259;:</span></p><p class="c1"><span class="c0"></span></p><a id="t.40d0228f955cbfd78e25d2d03cc4de46b1b0e11a"></a><a id="t.9"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">Textul a fost scris &icirc;n fi&#537;ier<br>Textul din fi&#537;ier: world</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">S&#259; vedem un exemplu pu&#539;in mai complex - cu scrierea &icirc;ncep&acirc;nd de la o anumit&#259; pozi&#539;ie:</span></p><p class="c1"><span class="c0"></span></p><a id="t.1f82615cc234918184cb2bcfe979095e9a890485"></a><a id="t.10"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c3">using</span><span class="c2">&nbsp;System.Text;<br> <br></span><span class="c3">string</span><span class="c2">&nbsp;path = </span><span class="c6">&quot;note2.dat&quot;</span><span class="c2">;<br> <br></span><span class="c3">string</span><span class="c2">&nbsp;text = </span><span class="c6">&quot;hello world&quot;</span><span class="c2">;<br> <br></span><span class="c10">// scrierea &icirc;n fi&#537;ier</span><span class="c2"><br></span><span class="c3">using</span><span class="c2">&nbsp;(FileStream fstream = </span><span class="c3">new</span><span class="c2">&nbsp;FileStream(path, FileMode.OpenOrCreate))<br>{<br> &nbsp; &nbsp;</span><span class="c10">// transform&#259;m string-ul &icirc;n bytes</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">byte</span><span class="c2">[] input = Encoding.Default.GetBytes(text);<br> &nbsp; &nbsp;</span><span class="c10">// scrierea array-ului de bytes &icirc;n fi&#537;ier</span><span class="c2"><br> &nbsp; &nbsp;fstream.Write(input, </span><span class="c15">0</span><span class="c2">, input.Length);<br> &nbsp; &nbsp;Console.WriteLine(</span><span class="c6">&quot;Textul a fost scris &icirc;n fi&#537;ier&quot;</span><span class="c2">);<br>}<br></span><span class="c3">using</span><span class="c2">&nbsp;(FileStream fstream = </span><span class="c3">new</span><span class="c2">&nbsp;FileStream(path, FileMode.OpenOrCreate))<br>{ <br> &nbsp; &nbsp;</span><span class="c10">// &icirc;nlocuim &icirc;n fi&#537;ier cuv&acirc;ntul &quot;world&quot; cu &quot;house&quot;</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">string</span><span class="c2">&nbsp;replaceText = </span><span class="c6">&quot;house&quot;</span><span class="c2">;<br> &nbsp; &nbsp;fstream.Seek(</span><span class="c15">-5</span><span class="c2">, SeekOrigin.End); </span><span class="c10">// minus 5 caractere de la sf&acirc;r&#537;itul fluxului</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">byte</span><span class="c2">[] input = Encoding.Default.GetBytes(replaceText);<br> &nbsp; &nbsp;</span><span class="c3">await</span><span class="c2">&nbsp;fstream.WriteAsync(input, </span><span class="c15">0</span><span class="c2">, input.Length);<br> <br> &nbsp; &nbsp;</span><span class="c10">// citim &icirc;ntregul fi&#537;ier</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c10">// readucem cursorul la &icirc;nceputul fi&#537;ierului</span><span class="c2"><br> &nbsp; &nbsp;fstream.Seek(</span><span class="c15">0</span><span class="c2">, SeekOrigin.Begin);<br> &nbsp; &nbsp;</span><span class="c3">byte</span><span class="c2">[] output = </span><span class="c3">new</span><span class="c2">&nbsp;</span><span class="c3">byte</span><span class="c2">[fstream.Length];<br> &nbsp; &nbsp;</span><span class="c3">await</span><span class="c2">&nbsp;fstream.ReadAsync(output, </span><span class="c15">0</span><span class="c2">, output.Length);<br> &nbsp; &nbsp;</span><span class="c10">// decod&#259;m bytes &icirc;n string</span><span class="c2"><br> &nbsp; &nbsp;</span><span class="c3">string</span><span class="c2">&nbsp;textFromFile = Encoding.Default.GetString(output);<br> &nbsp; &nbsp;Console.WriteLine(</span><span class="c6">$&quot;Textul din fi&#537;ier: {textFromFile}&quot;</span><span class="c2">); </span><span class="c10">// hello house</span><span class="c2"><br>}</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">&Icirc;n acest exemplu, scriem ini&#539;ial &icirc;n fi&#537;ier string-ul &quot;hello world&quot;. Apoi deschidem din nou fi&#537;ierul &#537;i ne deplas&#259;m la sf&acirc;r&#537;itul fi&#537;ierului, cu cinci caractere &icirc;nainte de sf&acirc;r&#537;it (adic&#259; din nou de la pozi&#539;ia caracterului &quot;w&quot;), &#537;i scriem string-ul &quot;house&quot;. Astfel, string-ul &quot;house&quot; &icirc;nlocuie&#537;te string-ul &quot;world&quot;.</span></p><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Pentru a citi &icirc;ntregul fi&#537;ier dup&#259; aceast&#259; opera&#539;iune, mut&#259;m cursorul la &icirc;nceputul fi&#537;ierului:</span></p><p class="c1"><span class="c0"></span></p><a id="t.53d4aa58dd4bbe2b10cc3a0fdbc5a709eaf48e4d"></a><a id="t.11"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">fstream.Seek(</span><span class="c15">0</span><span class="c2">, SeekOrigin.Begin);</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c5"><span class="c0">Rezultatul afi&#537;at &icirc;n consol&#259; va fi:</span></p><p class="c1"><span class="c0"></span></p><a id="t.e402ec2f10d9cf1a79187bbab749e1e39e489130"></a><a id="t.12"></a><table class="c13"><tr class="c9"><td class="c7" colspan="1" rowspan="1"><p class="c11"><span class="c2">Textul a fost scris &icirc;n fi&#537;ier<br>Textul din fi&#537;ier: hello house</span></p></td></tr></table><p class="c1"><span class="c0"></span></p><p class="c1"><span class="c0"></span></p></body></html>