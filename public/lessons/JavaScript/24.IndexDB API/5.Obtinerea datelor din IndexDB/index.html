<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c23 doc-content">
    <h1 class="c5 c11"><span class="c32">Ob»õinerea datelor din IndexDB. </h1>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c16">Pentru a ob&#539;ine un obiect din depozit, putem folosi o serie de metode ale
            obiectului </span><span class="c16 c29">IDBObjectStore</span><span class="c6">. S&#259; examin&#259;m
            diferitele op&#539;iuni de selec&#539;ie.</span></p>
    <p class="c3"><span class="c19 c14"></span></p>
    <p class="c5 c11"><span class="c19 c21">Ob&#539;inerea tuturor obiectelor din baza de date.</span></p>
    <p class="c3"><span class="c19 c14"></span></p>
    <p class="c5 c11"><span class="c16">Pentru a ob&#539;ine toate obiectele din depozit, obiectul IDBObjectStore
            ofer&#259; metoda </span><span class="c14 c19">getAll()</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.4c8d7e9edc2d6fb59b67bdb8b97691b747a292ed"></a><a id="t.0"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">getAll()</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c16">Aceast&#259; metod&#259; returneaz&#259; un obiect </span><span
            class="c14">IDBRequest</span><span class="c16">. Dac&#259; metoda se execut&#259; cu succes, pentru obiectul
            IDBRequest se genereaz&#259; evenimentul </span><span class="c14">success</span><span class="c16">, iar
            proprietatea sa </span><span class="c14">result </span><span class="c16">con&#539;ine un array cu datele
            ob&#539;inute din depozit. &Icirc;n cazul apari&#539;iei unei erori, la obiectul IDBRequest se
            declan&#537;eaz&#259; evenimentul </span><span class="c14">error</span><span class="c16">, iar proprietatea
            sa error con&#539;ine informa&#539;ii despre eroare. Pentru a gestiona aceste evenimente, se pot folosi,
            respectiv, propriet&#259;&#539;ile </span><span class="c14">onsuccess </span><span class="c16">&#537;i
        </span><span class="c14">onerror</span><span class="c6">.</span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">De exemplu, s&#259; ob&#539;inem toate obiectele din depozitul
            &quot;users&quot;:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.7aeb09c75c3774e377c832982d4ec6589706e6a9"></a><a id="t.1"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c12">const</span><span class="c1">&nbsp;request = indexedDB.open(</span><span
                        class="c0">&quot;test&quot;</span><span class="c1">, </span><span class="c10">5</span><span
                        class="c1">); </span><span class="c7">// ne conect&#259;m la baza de date test</span><span
                        class="c1"><br><br></span><span class="c7">// la crearea sau modificarea versiunii bazei de
                        date, cre&#259;m &icirc;n ea un depozit users</span><span class="c1"><br>request.onupgradeneeded
                        = (event) =&gt; { <br> &nbsp; &nbsp;</span><span class="c12">const</span><span
                        class="c1">&nbsp;db = event.target.result; &nbsp;</span><span class="c7">// ob&#539;inem baza de
                        date</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c7">// cheia este proprietatea
                        id, &#537;i este autoincrementat&#259;</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;userStore = db.createObjectStore(</span><span
                        class="c0">&quot;users&quot;</span><span class="c1">, { keyPath: </span><span
                        class="c0">&quot;id&quot;</span><span class="c1">, autoIncrement: </span><span
                        class="c12">true</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;userStore.add({name:
                    </span><span class="c0">&quot;Tom&quot;</span><span class="c1">, age: </span><span
                        class="c10">39</span><span class="c1">});<br> &nbsp; &nbsp;userStore.add({name: </span><span
                        class="c0">&quot;Bob&quot;</span><span class="c1">, age: </span><span class="c10">43</span><span
                        class="c1">});<br> &nbsp; &nbsp;userStore.add({name: </span><span
                        class="c0">&quot;Sam&quot;</span><span class="c1">, age: </span><span class="c10">28</span><span
                        class="c1">});<br>};<br></span><span class="c7">// la deschiderea bazei de date ob&#539;inem
                        toate datele</span><span class="c1"><br>request.onsuccess = (event) =&gt; { <br> &nbsp;
                        &nbsp;</span><span class="c12">const</span><span class="c1">&nbsp;db = event.target.result;
                        &nbsp;</span><span class="c7">// ob&#539;inem baza de date</span><span class="c1"><br> &nbsp;
                        &nbsp;</span><span class="c12">const</span><span class="c1">&nbsp;transaction =
                        db.transaction([</span><span class="c0">&quot;users&quot;</span><span class="c1">], </span><span
                        class="c0">&quot;readwrite&quot;</span><span class="c1">); </span><span class="c7">// cre&#259;m
                        o tranzac&#539;ie</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;userStore = transaction.objectStore(</span><span
                        class="c0">&quot;users&quot;</span><span class="c1">); &nbsp; </span><span class="c7">//
                        ob&#539;inem depozitul users</span><span class="c1"><br><br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;getRequest = userStore.getAll(); &nbsp;
                    </span><span class="c7">// ob&#539;inem toate obiectele</span><span class="c1"><br> &nbsp;
                        &nbsp;getRequest.onsuccess = (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;users = getRequest.result;<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c8">console</span><span class="c1">.log(users);<br> &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp;getRequest.onerror = (e) =&gt; &nbsp;</span><span
                        class="c8">console</span><span class="c1">.log(e.target.error.message); </span><span
                        class="c7">// afi&#537;&#259;m mesajul de eroare</span><span class="c1"><br>};</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">Aici, &icirc;n handlerul getRequest.onsuccess, ob&#539;inem datele extrase
            &icirc;n constanta users &#537;i le afi&#537;&#259;m &icirc;n consol&#259;:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.857ae7bd0043d228666ef0426680b4ff89bce9da"></a><a id="t.2"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">getRequest.onsuccess = (e) =&gt; {<br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;users = getRequest.result;<br> &nbsp;
                        &nbsp;</span><span class="c8">console</span><span class="c1">.log(users);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">Astfel, &icirc;n cazul meu, &icirc;n depozit sunt con&#539;inute trei obiecte cu
            propriet&#259;&#539;ile id (cheie), name &#537;i age:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.467fca504b605edbb7c4b1296966814adbf8e6b5"></a><a id="t.3"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">[<br> &nbsp; &nbsp;{ </span><span class="c0">&quot;name&quot;</span><span
                        class="c1">: </span><span class="c0">&quot;Tom&quot;</span><span class="c1">, </span><span
                        class="c0">&quot;age&quot;</span><span class="c1">: </span><span class="c10">39</span><span
                        class="c1">, </span><span class="c0">&quot;id&quot;</span><span class="c1">: </span><span
                        class="c10">1</span><span class="c1">},<br> &nbsp; &nbsp;{ </span><span
                        class="c0">&quot;name&quot;</span><span class="c1">: </span><span
                        class="c0">&quot;Bob&quot;</span><span class="c1">, </span><span
                        class="c0">&quot;age&quot;</span><span class="c1">: </span><span class="c10">43</span><span
                        class="c1">, </span><span class="c0">&quot;id&quot;</span><span class="c1">: </span><span
                        class="c10">2</span><span class="c1">},<br> &nbsp; &nbsp;{ </span><span
                        class="c0">&quot;name&quot;</span><span class="c1">: </span><span
                        class="c0">&quot;Sam&quot;</span><span class="c1">, </span><span
                        class="c0">&quot;age&quot;</span><span class="c1">: </span><span class="c10">28</span><span
                        class="c1">, </span><span class="c0">&quot;id&quot;</span><span class="c1">: </span><span
                        class="c10">3</span><span class="c1">}<br>]</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">Deoarece rezultatul este un array, putem folosi indici pentru a ob&#539;ine
            anumite elemente specifice din array sau s&#259; parcurgem array-ul:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.305bc6a155bab683574d14925aecf8db102ec44c"></a><a id="t.4"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">getRequest.onsuccess = (e) =&gt; {<br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;users = getRequest.result;<br> &nbsp;
                        &nbsp;</span><span class="c12">for</span><span class="c1">(user </span><span
                        class="c12">of</span><span class="c1">&nbsp;users){<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c8">console</span><span class="c1">.log(</span><span class="c0">`Name: ${user.name}
                        &nbsp;Age: ${user.age}`</span><span class="c1">);<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c19 c21">Filtrarea dup&#259; chei.</span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c16">O versiune suplimentar&#259; a metodei</span><span
            class="c16 c29">&nbsp;getAll()</span><span class="c6">&nbsp;permite filtrarea obiectelor sau selectarea doar
            a acelor obiecte care corespund unui anumit interval de chei:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.6b62bc04ddd33eaffb505bee0411bb41720766a4"></a><a id="t.5"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">getAll(query)<br>getAll(query, count)</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c16">Ca parametru query &icirc;n metod&#259; se transmite cheia sau obiectul
        </span><span class="c14">IDBKeyRange</span><span class="c16">, care stabile&#537;te intervalul de chei.
            Suplimentar, parametrul </span><span class="c16 c29">count </span><span class="c6">permite stabilirea
            num&#259;rului maxim de elemente &icirc;n selec&#539;ie.</span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">De exemplu, putem transmite valoarea cheii:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.667118219541c56f028afcfa06f07682dd22824b"></a><a id="t.6"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c12">const</span><span class="c1">&nbsp;getRequest =
                        userStore.getAll(</span><span class="c10">2</span><span class="c1">); &nbsp; </span><span
                        class="c7">// ob&#539;inem obiectele, al c&#259;ror proprietate-cheie este egal&#259; cu
                        2</span><span class="c1"><br>getRequest.onsuccess = (e) =&gt; {<br> &nbsp; &nbsp;</span><span
                        class="c8">console</span><span class="c1">.log(e.target.result);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">&Icirc;n acest caz, ob&#539;inem toate elementele, la care valoarea
            propriet&#259;&#539;ii-cheie este egal&#259; cu 2.</span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">Utilizarea obiectului IDBKeyRange ofer&#259; posibilit&#259;&#539;i suplimentare
            prin intermediul unei serii de metode statice:</span></p>
    <p class="c3"><span class="c6"></span></p>
    <ul class="c25 lst-kix_qdo3sp38pn3b-0 start">
        <li class="c5 c11 c20 li-bullet-0"><span class="c16">&nbsp;</span><span
                class="c16 c29">IDBKeyRange.bound()</span><span class="c6">: creeaz&#259; un interval de chei, pentru
                care sunt stabilite valorile minim&#259; &#537;i maxim&#259;</span></li>
    </ul>
    <p class="c3"><span class="c6"></span></p>
    <ul class="c25 lst-kix_qdo3sp38pn3b-0">
        <li class="c5 c11 c20 li-bullet-0"><span class="c16">&nbsp;</span><span
                class="c16 c29">IDBKeyRange.only()</span><span class="c6">: creeaz&#259; un interval de chei, care
                con&#539;ine doar o singur&#259; valoare</span></li>
    </ul>
    <p class="c3"><span class="c6"></span></p>
    <ul class="c25 lst-kix_qdo3sp38pn3b-0">
        <li class="c5 c11 c20 li-bullet-0"><span class="c16 c29">&nbsp;IDBKeyRange.lowerBound()</span><span class="c6">:
                creeaz&#259; un interval de chei, pentru care este stabilit&#259; valoarea minim&#259;</span></li>
    </ul>
    <p class="c3"><span class="c6"></span></p>
    <ul class="c25 lst-kix_qdo3sp38pn3b-0">
        <li class="c5 c11 c20 li-bullet-0"><span class="c16 c29">&nbsp;IDBKeyRange.upperBound()</span><span class="c6">:
                creeaz&#259; un interval de chei, pentru care este stabilit&#259; valoarea maxim&#259;</span></li>
    </ul>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">Intervalele de chei, care sunt create cu ajutorul acestor metode, pot fi descrise
            de urm&#259;toarea tabel&#259;:</span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.ef7b3328bbae18f8f8ee66e444fa56710b41950d"></a><a id="t.7"></a>
    <table class="c15">
        <tr class="c27">
            <td class="c33" colspan="1" rowspan="1">
                <p class="c18"><span class="c14">Interval</span></p>
            </td>
            <td class="c24" colspan="1" rowspan="1">
                <p class="c18"><span class="c14">Cod</span></p>
            </td>
            <td class="c35" colspan="1" rowspan="1">
                <p class="c18"><span class="c14">Descriere</span></p>
            </td>
        </tr>
        <tr class="c30">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii &gt;= x</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.lowerBound(x)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
        <tr class="c31">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii &gt; x</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.lowerBound(x, true)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
        <tr class="c28">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii &lt;= y</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.upperBound(y)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
        <tr class="c30">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii &lt; y</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.upperBound(y, true)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
        <tr class="c30">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii &gt;= x &amp;&amp; &lt;= y</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.bound(x, y)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
        <tr class="c28">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii &gt; x &lt; y</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.bound(x, y, true, true)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
        <tr class="c28">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii &gt; x &amp;&amp; &lt;= y</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.bound(x, y, true, false)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
        <tr class="c28">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii &gt;= x &amp;&amp;&lt; y</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.bound(x, y, false, true)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
        <tr class="c4">
            <td class="c26" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">Valoarea cheii = z</span></p>
            </td>
            <td class="c2" colspan="1" rowspan="1">
                <p class="c5"><span class="c6">IDBKeyRange.only(z)</span></p>
            </td>
            <td class="c17" colspan="1" rowspan="1">
                <p class="c5 c9"><span class="c6"></span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">De exemplu, ob&#539;inem toate obiectele, la care valoarea cheii nu este mai mare
            de 2:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.3cc02ea61b664d249130646b8175c5af7ddfa1ce"></a><a id="t.8"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c12">const</span><span class="c1">&nbsp;getRequest =
                        userStore.getAll(IDBKeyRange.upperBound(</span><span class="c10">2</span><span class="c1">));
                        &nbsp; <br>getRequest.onsuccess = () =&gt; {<br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;users = getRequest.result;<br> &nbsp;
                        &nbsp;</span><span class="c8">console</span><span class="c1">.log(users);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c19 c21">Ob&#539;inerea unui singur obiect dup&#259; cheie.</span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c16">Pentru a ob&#539;ine un singur obiect dup&#259; cheie se aplic&#259;
            metoda</span><span class="c14">&nbsp;get()</span><span class="c6">, &icirc;n care se transmite cheia
            obiectului:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.52cd5e807f1c81fe56eef4a194928fbdd57d4325"></a><a id="t.9"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c1">get(key)</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c16">Rezultatul metodei este un obiect </span><span
            class="c14">IDBRequest</span><span class="c16">. &Icirc;n cazul unei ad&#259;ug&#259;ri de succes, la acest
            obiect se declan&#537;eaz&#259; evenimentul </span><span class="c14">success</span><span class="c16">, iar
            proprietatea sa </span><span class="c14">result </span><span class="c16">va con&#539;ine obiectul cu cheia
            specificat&#259;. &Icirc;n caz de eroare, se genereaz&#259; evenimentul </span><span class="c14">error
        </span><span class="c16">&icirc;mpreun&#259; cu o excep&#539;ie de tip </span><span
            class="c16 c29">DOMException</span><span class="c6">.</span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">De exemplu, s&#259; ob&#539;inem obiectul cu cheia 1:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.ba77a0581c2aac7a54fc09348144b131ab5af614"></a><a id="t.10"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c12">const</span><span class="c1">&nbsp;request = indexedDB.open(</span><span
                        class="c0">&quot;test&quot;</span><span class="c1">, </span><span class="c10">5</span><span
                        class="c1">); </span><span class="c7">// ne conect&#259;m la baza de date test</span><span
                        class="c1"><br><br></span><span class="c7">// la crearea sau modificarea versiunii bazei de
                        date, cre&#259;m &icirc;n ea un depozit users</span><span class="c1"><br>request.onupgradeneeded
                        = (event) =&gt; { <br> &nbsp; &nbsp;</span><span class="c12">const</span><span
                        class="c1">&nbsp;db = event.target.result; &nbsp;</span><span class="c7">// ob&#539;inem baza de
                        date</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c7">// cheia este proprietatea
                        id, &#537;i este autoincrementat&#259;</span><span class="c1"><br> &nbsp;
                        &nbsp;db.createObjectStore(</span><span class="c0">&quot;users&quot;</span><span class="c1">, {
                        keyPath: </span><span class="c0">&quot;id&quot;</span><span class="c1">, autoIncrement:
                    </span><span class="c12">true</span><span class="c1">&nbsp;});<br>};<br></span><span class="c7">//
                        la deschiderea bazei de date ob&#539;inem un singur obiect</span><span
                        class="c1"><br>request.onsuccess = (event) =&gt; { <br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;db = event.target.result; &nbsp;</span><span
                        class="c7">// ob&#539;inem baza de date</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;transaction = db.transaction([</span><span
                        class="c0">&quot;users&quot;</span><span class="c1">], </span><span
                        class="c0">&quot;readwrite&quot;</span><span class="c1">); </span><span class="c7">// cre&#259;m
                        o tranzac&#539;ie</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;userStore = transaction.objectStore(</span><span
                        class="c0">&quot;users&quot;</span><span class="c1">); &nbsp; </span><span class="c7">//
                        ob&#539;inem depozitul users</span><span class="c1"><br><br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;getRequest = userStore.get(</span><span
                        class="c10">1</span><span class="c1">); &nbsp; </span><span class="c7">// ob&#539;inem obiectul
                        dup&#259; cheia 1</span><span class="c1"><br> &nbsp; &nbsp;getRequest.onsuccess = () =&gt;
                    </span><span class="c8">console</span><span class="c1">.log(getRequest.result); </span><span
                        class="c7">// afi&#537;&#259;m obiectul ob&#539;inut</span><span class="c1"><br> &nbsp;
                        &nbsp;getRequest.onerror = (e) =&gt; &nbsp;</span><span class="c8">console</span><span
                        class="c1">.log(e.target.error.message); </span><span class="c7">// afi&#537;&#259;m mesajul de
                        eroare</span><span class="c1"><br>};</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">Rezultatul &icirc;n cazul meu este:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.948665052b260aa6cd453173aecf7d4294f488ef"></a><a id="t.11"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c8">Object</span><span class="c1"><br> &nbsp; &nbsp;age: </span><span
                        class="c10">39</span><span class="c1"><br> &nbsp; &nbsp;id: </span><span
                        class="c10">1</span><span class="c1"><br> &nbsp; &nbsp;name: </span><span
                        class="c0">&quot;Tom&quot;</span><span class="c1"><br> &nbsp; &nbsp;[[Prototype]]: </span><span
                        class="c8">Object</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c6">De asemenea, obiectul extras &icirc;l putem ob&#539;ine prin parametrul
            handlerului evenimentului - prin proprietatea sa event.target.result:</span></p>
    <p class="c3"><span class="c6"></span></p><a id="t.51d7c115696b5d2b1b11b84ecdbb38839e92953e"></a><a id="t.12"></a>
    <table class="c15">
        <tr class="c13">
            <td class="c22" colspan="1" rowspan="1">
                <p class="c5"><span class="c12">const</span><span class="c1">&nbsp;getRequest =
                        userStore.get(</span><span class="c10">1</span><span class="c1">); &nbsp; </span><span
                        class="c7">// ob&#539;inem obiectul dup&#259; cheia 1</span><span
                        class="c1"><br>getRequest.onsuccess = (e) =&gt; {<br> &nbsp; &nbsp;</span><span
                        class="c12">const</span><span class="c1">&nbsp;user = e.target.result; </span><span
                        class="c7">// obiectul ob&#539;inut</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c8">console</span><span class="c1">.log(user.name);<br> &nbsp; &nbsp;</span><span
                        class="c8">console</span><span class="c1">.log(user.age);<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c3"><span class="c6"></span></p>
    <p class="c5 c11"><span class="c16">Dac&#259; &icirc;ncerc&#259;m s&#259; g&#259;sim un obiect cu o cheie
            inexistent&#259;, atunci proprietatea result va fi egal&#259; cu </span><span
            class="c16 c29">undefined</span><span class="c6">.</span></p>
    <p class="c3"><span class="c6"></span></p>
</body>

</html>