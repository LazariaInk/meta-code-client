<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <style type="text/css">
        @import url(https://themes.googleusercontent.com/fonts/css?kit=iMc4-4exjgqA-toZgqqJBf35jAjY-31lSKWZb9Fa77M);

        .lst-kix_v5mf2i2ykodk-5>li:before {
            content: "\0025a0   "
        }

        .lst-kix_v5mf2i2ykodk-7>li:before {
            content: "\0025cb   "
        }

        .lst-kix_v5mf2i2ykodk-8>li:before {
            content: "\0025a0   "
        }

        .lst-kix_v5mf2i2ykodk-4>li:before {
            content: "\0025cb   "
        }

        li.li-bullet-0:before {
            margin-left: -18pt;
            white-space: nowrap;
            display: inline-block;
            min-width: 18pt
        }

        .lst-kix_v5mf2i2ykodk-6>li:before {
            content: "\0025cf   "
        }

        ul.lst-kix_v5mf2i2ykodk-6 {
            list-style-type: none
        }

        ul.lst-kix_v5mf2i2ykodk-7 {
            list-style-type: none
        }

        ul.lst-kix_v5mf2i2ykodk-4 {
            list-style-type: none
        }

        ul.lst-kix_v5mf2i2ykodk-5 {
            list-style-type: none
        }

        ul.lst-kix_v5mf2i2ykodk-2 {
            list-style-type: none
        }

        ul.lst-kix_v5mf2i2ykodk-3 {
            list-style-type: none
        }

        ul.lst-kix_v5mf2i2ykodk-0 {
            list-style-type: none
        }

        .lst-kix_v5mf2i2ykodk-0>li:before {
            content: "\0025cf   "
        }

        ul.lst-kix_v5mf2i2ykodk-1 {
            list-style-type: none
        }

        .lst-kix_v5mf2i2ykodk-1>li:before {
            content: "\0025cb   "
        }

        .lst-kix_v5mf2i2ykodk-3>li:before {
            content: "\0025cf   "
        }

        ul.lst-kix_v5mf2i2ykodk-8 {
            list-style-type: none
        }

        .lst-kix_v5mf2i2ykodk-2>li:before {
            content: "\0025a0   "
        }

        ol {
            margin: 0;
            padding: 0
        }

        table td,
        table th {
            padding: 0
        }

        .c14 {
            border-right-style: solid;
            padding: 5pt 5pt 5pt 5pt;
            border-bottom-color: #000000;
            border-top-width: 0pt;
            border-right-width: 0pt;
            border-left-color: #000000;
            vertical-align: top;
            border-right-color: #000000;
            border-left-width: 0pt;
            border-top-style: solid;
            background-color: #333333;
            border-left-style: solid;
            border-bottom-width: 0pt;
            width: 468pt;
            border-top-color: #000000;
            border-bottom-style: solid
        }

        .c24 {
            color: #000000;
            font-weight: 700;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 27pt;
            font-family: "Open Sans";
            font-style: normal
        }

        .c23 {
            color: #000000;
            font-weight: 400;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 15pt;
            font-family: "Open Sans";
            font-style: normal
        }

        .c15 {
            color: #000000;
            font-weight: 700;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 15pt;
            font-family: "Open Sans";
            font-style: normal
        }

        .c2 {
            color: #000000;
            font-weight: 400;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 12pt;
            font-family: "Open Sans";
            font-style: normal
        }

        .c8 {
            padding-top: 0pt;
            padding-bottom: 0pt;
            line-height: 1.5;
            orphans: 2;
            widows: 2;
            text-align: left;
            height: 11pt
        }

        .c11 {
            color: #000000;
            font-weight: 700;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 12pt;
            font-family: "Open Sans";
            font-style: normal
        }

        .c9 {
            padding-top: 0pt;
            padding-bottom: 0pt;
            line-height: 1.5;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        .c5 {
            background-color: #333333;
            font-size: 12pt;
            font-family: "Open Sans";
            color: #888888;
            font-weight: 400
        }

        .c0 {
            background-color: #333333;
            font-size: 12pt;
            font-family: "Open Sans";
            color: #fcc28c;
            font-weight: 400
        }

        .c1 {
            background-color: #333333;
            font-size: 12pt;
            font-family: "Open Sans";
            color: #ffffff;
            font-weight: 400
        }

        .c4 {
            background-color: #333333;
            font-size: 12pt;
            font-family: "Open Sans";
            color: #ffffaa;
            font-weight: 400
        }

        .c7 {
            background-color: #333333;
            font-size: 12pt;
            font-family: "Open Sans";
            color: #d36363;
            font-weight: 400
        }

        .c3 {
            background-color: #333333;
            font-size: 12pt;
            font-family: "Open Sans";
            color: #a2fca2;
            font-weight: 400
        }

        .c17 {
            padding-top: 0pt;
            padding-bottom: 0pt;
            line-height: 1.5;
            text-align: left
        }

        .c10 {
            border-spacing: 0;
            border-collapse: collapse;
            margin-right: auto
        }

        .c6 {
            font-size: 12pt;
            font-family: "Open Sans";
            font-style: italic;
            font-weight: 400
        }

        .c18 {
            font-size: 12pt;
            font-family: "Open Sans";
            font-weight: 700
        }

        .c21 {
            background-color: #ffffff;
            max-width: 468pt;
            padding: 72pt 72pt 72pt 72pt
        }

        .c13 {
            font-size: 12pt;
            font-family: "Open Sans";
            font-weight: 400
        }

        .c12 {
            margin-left: 36pt;
            padding-left: 0pt
        }

        .c19 {
            padding: 0;
            margin: 0
        }

        .c20 {
            background-color: #333333;
            color: #c6b4f0
        }

        .c16 {
            height: 0pt
        }

        .c22 {
            margin-left: 36pt
        }

        .title {
            padding-top: 0pt;
            color: #000000;
            font-size: 26pt;
            padding-bottom: 3pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        .subtitle {
            padding-top: 0pt;
            color: #666666;
            font-size: 15pt;
            padding-bottom: 16pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        li {
            color: #000000;
            font-size: 11pt;
            font-family: "Arial"
        }

        p {
            margin: 0;
            color: #000000;
            font-size: 11pt;
            font-family: "Arial"
        }

        h1 {
            padding-top: 20pt;
            color: #000000;
            font-size: 20pt;
            padding-bottom: 6pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h2 {
            padding-top: 18pt;
            color: #000000;
            font-size: 16pt;
            padding-bottom: 6pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h3 {
            padding-top: 16pt;
            color: #434343;
            font-size: 14pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h4 {
            padding-top: 14pt;
            color: #666666;
            font-size: 12pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h5 {
            padding-top: 12pt;
            color: #666666;
            font-size: 11pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h6 {
            padding-top: 12pt;
            color: #666666;
            font-size: 11pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            font-style: italic;
            orphans: 2;
            widows: 2;
            text-align: left
        }
    </style>
</head>

<body class="c21 doc-content">
    <h1 class="c9 c24">Crearea unui client pentru REST API. </h1>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">Folosind</span><span class="c18">&nbsp;Fetch API</span><span
            class="c2">&nbsp;&icirc;n JavaScript, se poate implementa un client complet pentru Web API &icirc;n stil
            REST pentru interac&#539;iunea cu utilizatorul. Arhitectura REST presupune utilizarea urm&#259;toarelor
            metode sau tipuri de cereri HTTP pentru interac&#539;iunea cu serverul:</span></p>
    <p class="c8"><span class="c2"></span></p>
    <ul class="c19 lst-kix_v5mf2i2ykodk-0 start">
        <li class="c9 c12 li-bullet-0"><span class="c2">GET</span></li>
    </ul>
    <p class="c8 c22"><span class="c2"></span></p>
    <ul class="c19 lst-kix_v5mf2i2ykodk-0">
        <li class="c9 c12 li-bullet-0"><span class="c2">POST</span></li>
    </ul>
    <p class="c8 c22"><span class="c2"></span></p>
    <ul class="c19 lst-kix_v5mf2i2ykodk-0">
        <li class="c9 c12 li-bullet-0"><span class="c2">PUT</span></li>
    </ul>
    <p class="c8 c22"><span class="c2"></span></p>
    <ul class="c19 lst-kix_v5mf2i2ykodk-0">
        <li class="c9 c12 li-bullet-0"><span class="c2">DELETE</span></li>
    </ul>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">S&#259; examin&#259;m cum s&#259; cre&#259;m propriul client &icirc;n JavaScript
            pentru API.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c15">Crearea unui server pe node.js.</span></p>
    <p class="c8"><span class="c11"></span></p>
    <p class="c9"><span class="c13">Pentru &icirc;nceput, vom defini serverul care va reprezenta de fapt Web API. Ca
            exemplu, vom folosi Node.js. Pentru a procesa cererile, vom defini urm&#259;torul fi&#537;ier </span><span
            class="c18">server.js</span><span class="c2">:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.12f6b785663057b4d315bf511bc45d301f5c8ba7"></a><a id="t.0"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">const</span><span class="c1">&nbsp;http = </span><span
                        class="c4">require</span><span class="c1">(</span><span class="c3">&quot;http&quot;</span><span
                        class="c1">);<br></span><span class="c0">const</span><span class="c1">&nbsp;fs = </span><span
                        class="c4">require</span><span class="c1">(</span><span class="c3">&quot;fs&quot;</span><span
                        class="c1">);<br> <br></span><span class="c5">// datele cu care lucreaz&#259;
                        clientul</span><span class="c1"><br></span><span class="c0">const</span><span
                        class="c1">&nbsp;users = [<br> &nbsp; &nbsp;{ id:</span><span class="c7">1</span><span
                        class="c1">, name:</span><span class="c3">&quot;Tom&quot;</span><span class="c1">,
                        age:</span><span class="c7">24</span><span class="c1">}, <br> &nbsp; &nbsp;{ id:</span><span
                        class="c7">2</span><span class="c1">, name:</span><span class="c3">&quot;Bob&quot;</span><span
                        class="c1">, age:</span><span class="c7">27</span><span class="c1">},<br> &nbsp; &nbsp;{
                        id:</span><span class="c7">3</span><span class="c1">, name:</span><span
                        class="c3">&quot;Alice&quot;</span><span class="c1">, age:</span><span class="c7">23</span><span
                        class="c1">}<br>]<br></span><span class="c5">// proces&#259;m datele primite de la
                        client</span><span class="c1"><br></span><span class="c0">function</span><span
                        class="c1">&nbsp;</span><span class="c4">getReqData</span><span class="c1">(req) {<br> &nbsp;
                        &nbsp;</span><span class="c0">return</span><span class="c1">&nbsp;</span><span
                        class="c0">new</span><span class="c1">&nbsp;</span><span class="c4">Promise</span><span
                        class="c1">(</span><span class="c0">async</span><span class="c1">&nbsp;(resolve, reject) =&gt;
                        {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">try</span><span class="c1">&nbsp;{<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span
                        class="c1">&nbsp;buffers = [];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">for</span><span class="c1">&nbsp;</span><span class="c0">await</span><span
                        class="c1">&nbsp;(</span><span class="c0">const</span><span class="c1">&nbsp;chunk </span><span
                        class="c0">of</span><span class="c1">&nbsp;req) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;buffers.push(chunk);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span
                        class="c1">&nbsp;data = </span><span class="c4">JSON</span><span
                        class="c1">.parse(Buffer.concat(buffers).toString());<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;resolve(data);<br> &nbsp; &nbsp; &nbsp; &nbsp;} </span><span class="c0">catch</span><span
                        class="c1">&nbsp;(error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;reject(error);<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;});<br>}<br> <br>http.createServer(</span><span
                        class="c0">async</span><span class="c1">&nbsp;(request, response) =&gt; {<br> &nbsp; &nbsp;
                        &nbsp;<br> &nbsp; &nbsp; </span><span class="c5">// ob&#539;inerea tuturor
                        utilizatorilor</span><span class="c1"><br> &nbsp; &nbsp; </span><span class="c0">if</span><span
                        class="c1">&nbsp;(request.url === </span><span class="c3">&quot;/api/users&quot;</span><span
                        class="c1">&nbsp;&amp;&amp; request.method === </span><span
                        class="c3">&quot;GET&quot;</span><span class="c1">) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify(users));<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c5">// ob&#539;inerea unui singur utilizator
                        dup&#259; id</span><span class="c1"><br> &nbsp; &nbsp; </span><span class="c0">else</span><span
                        class="c1">&nbsp;</span><span class="c0">if</span><span
                        class="c1">&nbsp;(request.url.match(</span><span
                        class="c13 c20">/\/api\/users\/([0-9]+)/</span><span class="c1">) &amp;&amp; request.method ===
                    </span><span class="c3">&quot;GET&quot;</span><span class="c1">) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// ob&#539;inem id din adresa url</span><span class="c1"><br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;id =
                        request.url.split(</span><span class="c3">&quot;/&quot;</span><span class="c1">)[</span><span
                        class="c7">3</span><span class="c1">];<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">//
                        ob&#539;inem utilizatorul dup&#259; id</span><span class="c1"><br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;user = users.find((u) =&gt;
                        u.id === </span><span class="c4">parseInt</span><span class="c1">(id));<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// dac&#259; utilizatorul este g&#259;sit, &icirc;l
                        trimitem</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">if</span><span class="c1">(user) <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify(user));<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// dac&#259; nu este g&#259;sit, trimitem
                        codul de stare &#537;i mesajul de eroare</span><span class="c1"><br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c0">else</span><span class="c1">{<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;response.writeHead(</span><span class="c7">404</span><span class="c1">, {
                    </span><span class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify({ message: </span><span class="c3">&quot;Utilizatorul nu a fost
                        g&#259;sit&quot;</span><span class="c1">&nbsp;}));<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp;</span><span class="c5">// &#537;tergerea utilizatorului dup&#259; id
                        &nbsp;</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c0">else</span><span
                        class="c1">&nbsp;</span><span class="c0">if</span><span
                        class="c1">&nbsp;(request.url.match(</span><span
                        class="c13 c20">/\/api\/users\/([0-9]+)/</span><span class="c1">) &amp;&amp; request.method ===
                    </span><span class="c3">&quot;DELETE&quot;</span><span class="c1">) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// ob&#539;inem id din adresa url</span><span class="c1"><br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;id =
                        request.url.split(</span><span class="c3">&quot;/&quot;</span><span class="c1">)[</span><span
                        class="c7">3</span><span class="c1">];<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">//
                        ob&#539;inem indexul utilizatorului dup&#259; id</span><span class="c1"><br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;userIndex =
                        users.findIndex((u) =&gt; u.id === </span><span class="c4">parseInt</span><span
                        class="c1">(id));<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// dac&#259;
                        utilizatorul este g&#259;sit, &icirc;l &#537;tergem din array &#537;i &icirc;l trimitem
                        clientului</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">if</span><span class="c1">(userIndex &gt; </span><span class="c7">-1</span><span
                        class="c1">) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;user = users.splice(userIndex, </span><span
                        class="c7">1</span><span class="c1">)[</span><span class="c7">0</span><span class="c1">];<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify(user));<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// dac&#259; nu este g&#259;sit, trimitem codul de stare &#537;i
                        mesajul de eroare</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">else</span><span class="c1">{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;response.writeHead(</span><span class="c7">404</span><span class="c1">, { </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify({ message: </span><span class="c3">&quot;Utilizatorul nu a fost
                        g&#259;sit&quot;</span><span class="c1">&nbsp;}));<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp;</span><span class="c5">// ad&#259;ugarea unui utilizator</span><span
                        class="c1"><br> &nbsp; &nbsp;</span><span class="c0">else</span><span
                        class="c1">&nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;(request.url ===
                    </span><span class="c3">&quot;/api/users&quot;</span><span class="c1">&nbsp;&amp;&amp;
                        request.method === </span><span class="c3">&quot;POST&quot;</span><span class="c1">) {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">try</span><span class="c1">{<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// ob&#539;inem datele
                        utilizatorului</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;userData = </span><span
                        class="c0">await</span><span class="c1">&nbsp;getReqData(request);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c5">// cre&#259;m un nou utilizator</span><span
                        class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;user = {name: userData.name, age:
                        userData.age};<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">//
                        g&#259;sim cel mai mare id</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;id = </span><span
                        class="c4">Math</span><span class="c1">.max.apply(</span><span class="c4">Math</span><span
                        class="c1">,users.map(</span><span class="c0">function</span><span class="c1">(u){</span><span
                        class="c0">return</span><span class="c1">&nbsp;u.id;}))<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// &icirc;l m&#259;rim cu o unitate</span><span class="c1"><br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;user.id = id + </span><span class="c7">1</span><span
                        class="c1">;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">//
                        ad&#259;ug&#259;m utilizatorul &icirc;n array</span><span class="c1"><br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;users.push(user);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify(user));<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">catch</span><span class="c1">(error){<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;response.writeHead(</span><span class="c7">400</span><span class="c1">, { </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify({ message: </span><span class="c3">&quot;Cerere
                        incorect&#259;&quot;</span><span class="c1">&nbsp;}));<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c5">// modificarea unui
                        utilizator</span><span class="c1"><br> &nbsp; &nbsp;</span><span class="c0">else</span><span
                        class="c1">&nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;(request.url ===
                    </span><span class="c3">&quot;/api/users&quot;</span><span class="c1">&nbsp;&amp;&amp;
                        request.method === </span><span class="c3">&quot;PUT&quot;</span><span class="c1">) {<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c0">try</span><span class="c1">{<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;userData =
                    </span><span class="c0">await</span><span class="c1">&nbsp;getReqData(request);<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// ob&#539;inem utilizatorul dup&#259;
                        id</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;user = users.find((u) =&gt; u.id === </span><span
                        class="c4">parseInt</span><span class="c1">(userData.id));<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c5">// dac&#259; utilizatorul este g&#259;sit, &icirc;i
                        modific&#259;m datele &#537;i &icirc;l trimitem &icirc;napoi clientului</span><span
                        class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">if</span><span
                        class="c1">(user) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;user.age =
                        userData.age;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;user.name =
                        userData.name;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify(user));<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// dac&#259; nu este g&#259;sit, trimitem codul de stare &#537;i
                        mesajul de eroare</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c0">else</span><span class="c1">{<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;response.writeHead(</span><span class="c7">404</span><span
                        class="c1">, { </span><span class="c3">&quot;Content-Type&quot;</span><span class="c1">:
                    </span><span class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;response.end(</span><span
                        class="c4">JSON</span><span class="c1">.stringify({ message: </span><span
                        class="c3">&quot;Utilizatorul nu a fost g&#259;sit&quot;</span><span class="c1">&nbsp;}));<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c0">catch</span><span class="c1">(error){<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;response.writeHead(</span><span class="c7">400</span><span
                        class="c1">, { </span><span class="c3">&quot;Content-Type&quot;</span><span class="c1">:
                    </span><span class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify({ message: </span><span class="c3">&quot;Cerere
                        incorect&#259;&quot;</span><span class="c1">&nbsp;}));<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c0">else</span><span
                        class="c1">&nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;(request.url ===
                    </span><span class="c3">&quot;/&quot;</span><span class="c1">&nbsp;|| request.url === </span><span
                        class="c3">&quot;/index.html&quot;</span><span class="c1">) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;fs.readFile(</span><span class="c3">&quot;index.html&quot;</span><span class="c1">,
                        (error, data) =&gt; response.end(data));<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span
                        class="c0">else</span><span class="c1">{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;response.writeHead(</span><span class="c7">404</span><span class="c1">, { </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify({
                        message: </span><span class="c3">&quot;Resursa nu a fost g&#259;sit&#259;&quot;</span><span
                        class="c1">&nbsp;}));<br> &nbsp; &nbsp;}<br>}).listen(</span><span class="c7">3000</span><span
                        class="c1">, ()=&gt;</span><span class="c4">console</span><span class="c1">.log(</span><span
                        class="c3">&quot;Serverul a fost lansat la adresa http://localhost:3000&quot;</span><span
                        class="c1">));</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">S&#259; examin&#259;m &icirc;n linii generale acest cod. La &icirc;nceput, sunt
            definite datele cu care va lucra clientul:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.34a585f51bc3053d25f2e9d263f35d28e81fca43"></a><a id="t.1"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">const</span><span class="c1">&nbsp;users = [<br> &nbsp; &nbsp;{
                        id:</span><span class="c7">1</span><span class="c1">, name:</span><span
                        class="c3">&quot;Tom&quot;</span><span class="c1">, age:</span><span class="c7">24</span><span
                        class="c1">}, <br> &nbsp; &nbsp;{ id:</span><span class="c7">2</span><span class="c1">,
                        name:</span><span class="c3">&quot;Bob&quot;</span><span class="c1">, age:</span><span
                        class="c7">27</span><span class="c1">},<br> &nbsp; &nbsp;{ id:</span><span
                        class="c7">3</span><span class="c1">, name:</span><span class="c3">&quot;Alice&quot;</span><span
                        class="c1">, age:</span><span class="c7">23</span><span class="c1">}<br>]</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Pentru simplificare, datele sunt definite sub form&#259; de un array obi&#537;nuit de
            obiecte, dar &icirc;ntr-o situa&#539;ie real&#259;, de obicei, aceste date sunt extrase dintr-o anumit&#259;
            baz&#259; de date.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">Apoi este definit&#259; func&#539;ia </span><span
            class="c6">getReqData()</span><span class="c2">, care extrage din cererea trimis&#259; de client datele
            &#537;i le converte&#537;te &icirc;n format JSON (se presupune c&#259; clientul va trimite date &icirc;n
            format JSON):</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.7e7610a828a71ddee43604df48a286e133d6ce0b"></a><a id="t.2"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">function</span><span class="c1">&nbsp;</span><span
                        class="c4">getReqData</span><span class="c1">(req) {<br> &nbsp; &nbsp;</span><span
                        class="c0">return</span><span class="c1">&nbsp;</span><span class="c0">new</span><span
                        class="c1">&nbsp;</span><span class="c4">Promise</span><span class="c1">(</span><span
                        class="c0">async</span><span class="c1">&nbsp;(resolve, reject) =&gt; {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c0">try</span><span class="c1">&nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;buffers = [];<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">for</span><span
                        class="c1">&nbsp;</span><span class="c0">await</span><span class="c1">&nbsp;(</span><span
                        class="c0">const</span><span class="c1">&nbsp;chunk </span><span class="c0">of</span><span
                        class="c1">&nbsp;req) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;buffers.push(chunk);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;data =
                    </span><span class="c4">JSON</span><span class="c1">.parse(Buffer.concat(buffers).toString());<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;resolve(data);<br> &nbsp; &nbsp; &nbsp; &nbsp;}
                    </span><span class="c0">catch</span><span class="c1">&nbsp;(error) {<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;reject(error);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;});<br>}</span>
                </p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Rezultatul func&#539;iei este definit sub form&#259; de promisiune. Dac&#259; datele
            sunt analizate cu succes, atunci transmitem prin promisiune obiectul analizat. Dac&#259; apare o eroare,
            atunci transmitem mesajul de eroare.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Apoi, pentru fiecare tip de cerere, este definit un scenariu specific.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">C&acirc;nd aplica&#539;ia prime&#537;te o cerere de tip GET la adresa
            &quot;api/users&quot;, se execut&#259; urm&#259;torul cod:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.d69cf6891cfa7a93301cf697949f25e038bcf8ea"></a><a id="t.3"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">if</span><span class="c1">&nbsp;(request.url === </span><span
                        class="c3">&quot;/api/users&quot;</span><span class="c1">&nbsp;&amp;&amp; request.method ===
                    </span><span class="c3">&quot;GET&quot;</span><span class="c1">) {<br> &nbsp;
                        &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify(users));<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Aici pur &#537;i simplu trimitem array-ul users definit mai sus.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">C&acirc;nd clientul acceseaz&#259; aplica&#539;ia pentru a ob&#539;ine un singur
            obiect dup&#259; id &icirc;ntr-o cerere de tip GET la adresa &quot;api/users/&quot;, se execut&#259;
            urm&#259;torul cod:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.b55b9c8abf78b7458a185676c10ce25e705d8ec2"></a><a id="t.4"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">else</span><span class="c1">&nbsp;</span><span class="c0">if</span><span
                        class="c1">&nbsp;(request.url.match(</span><span
                        class="c13 c20">/\/api\/users\/([0-9]+)/</span><span class="c1">) &amp;&amp; request.method ===
                    </span><span class="c3">&quot;GET&quot;</span><span class="c1">) {<br> &nbsp; &nbsp;</span><span
                        class="c5">// ob&#539;inem id din adresa url</span><span class="c1"><br> &nbsp;
                        &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;id =
                        request.url.split(</span><span class="c3">&quot;/&quot;</span><span class="c1">)[</span><span
                        class="c7">3</span><span class="c1">];<br> &nbsp; &nbsp;</span><span class="c5">// ob&#539;inem
                        utilizatorul dup&#259; id</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;user = users.find((u) =&gt; u.id === </span><span
                        class="c4">parseInt</span><span class="c1">(id));<br> &nbsp; &nbsp;</span><span class="c5">//
                        dac&#259; utilizatorul este g&#259;sit, &icirc;l trimitem</span><span class="c1"><br> &nbsp;
                        &nbsp;</span><span class="c0">if</span><span class="c1">(user) <br> &nbsp; &nbsp; &nbsp;
                        &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify(user));<br>
                        &nbsp; &nbsp;</span><span class="c5">// dac&#259; nu este g&#259;sit, trimitem codul de stare
                        &#537;i mesajul de eroare</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c0">else</span><span class="c1">{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;response.writeHead(</span><span class="c7">404</span><span class="c1">, { </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify({
                        message: </span><span class="c3">&quot;Utilizatorul nu a fost g&#259;sit&quot;</span><span
                        class="c1">&nbsp;}));<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">&Icirc;n acest caz, trebuie s&#259; g&#259;sim utilizatorul necesar dup&#259; id
            &icirc;n array, iar dac&#259; nu este g&#259;sit, return&#259;m codul de stare 404 cu un anumit mesaj
            &icirc;n format JSON.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">La primirea unei cereri DELETE la adresa &quot;/api/users/:id&quot;, g&#259;sim
            indexul obiectului &icirc;n array. Dac&#259; obiectul este g&#259;sit, &icirc;l &#537;tergem din array
            &#537;i &icirc;l trimitem clientului:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.2c670d0e7fd28cfc2dfbfd9ace6ff5d7f233810a"></a><a id="t.5"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c1">&nbsp;</span><span class="c5">// &#537;tergem utilizatorul dup&#259;
                        id</span><span class="c1"><br></span><span class="c0">else</span><span
                        class="c1">&nbsp;</span><span class="c0">if</span><span
                        class="c1">&nbsp;(request.url.match(</span><span
                        class="c13 c20">/\/api\/users\/([0-9]+)/</span><span class="c1">) &amp;&amp; request.method ===
                    </span><span class="c3">&quot;DELETE&quot;</span><span class="c1">) {<br> &nbsp; &nbsp;</span><span
                        class="c5">// ob&#539;inem id din adresa url</span><span class="c1"><br> &nbsp;
                        &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;id =
                        request.url.split(</span><span class="c3">&quot;/&quot;</span><span class="c1">)[</span><span
                        class="c7">3</span><span class="c1">];<br> &nbsp; &nbsp;</span><span class="c5">// ob&#539;inem
                        indexul utilizatorului dup&#259; id</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;userIndex = users.findIndex((u) =&gt; u.id ===
                    </span><span class="c4">parseInt</span><span class="c1">(id));<br> &nbsp; &nbsp;</span><span
                        class="c5">// dac&#259; utilizatorul este g&#259;sit, &icirc;l &#537;tergem din array &#537;i
                        &icirc;l trimitem clientului</span><span class="c1"><br> &nbsp; &nbsp;</span><span
                        class="c0">if</span><span class="c1">(userIndex &gt; </span><span class="c7">-1</span><span
                        class="c1">) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span
                        class="c1">&nbsp;user = users.splice(userIndex, </span><span class="c7">1</span><span
                        class="c1">)[</span><span class="c7">0</span><span class="c1">];<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify(user));<br>
                        &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span class="c5">// dac&#259; nu este g&#259;sit,
                        trimitem codul de stare &#537;i mesajul de eroare</span><span class="c1"><br> &nbsp;
                        &nbsp;</span><span class="c0">else</span><span class="c1">{<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;response.writeHead(</span><span class="c7">404</span><span class="c1">, { </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify({
                        message: </span><span class="c3">&quot;Utilizatorul nu a fost g&#259;sit&quot;</span><span
                        class="c1">&nbsp;}));<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Dac&#259; obiectul nu este g&#259;sit, return&#259;m codul de stare 404.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">La primirea unei cereri cu metoda POST la adresa &quot;/api/users&quot;, folosim
            func&#539;ia</span><span class="c6">&nbsp;getReqData() </span><span class="c2">pentru a extrage datele din
            cerere:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.60f76e427b64ef59847f04b60e45306ca65f22d9"></a><a id="t.6"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">else</span><span class="c1">&nbsp;</span><span class="c0">if</span><span
                        class="c1">&nbsp;(request.url === </span><span class="c3">&quot;/api/users&quot;</span><span
                        class="c1">&nbsp;&#537;i request.method === </span><span class="c3">&quot;POST&quot;</span><span
                        class="c1">) {<br> &nbsp; &nbsp;</span><span class="c0">try</span><span class="c1">{<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c5">// ob&#539;inem datele utilizatorului</span><span
                        class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span
                        class="c1">&nbsp;userData = </span><span class="c0">await</span><span
                        class="c1">&nbsp;getReqData(request);<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">//
                        cre&#259;m un nou utilizator</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;user = {name: userData.name, age:
                        userData.age};<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// g&#259;sim cel mai mare
                        id</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;id = </span><span class="c4">Math</span><span
                        class="c1">.max.apply(</span><span class="c4">Math</span><span
                        class="c1">,users.map(</span><span class="c0">function</span><span class="c1">(u){</span><span
                        class="c0">return</span><span class="c1">&nbsp;u.id;}))<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// &icirc;l m&#259;rim cu o unitate</span><span class="c1"><br>
                        &nbsp; &nbsp; &nbsp; &nbsp;user.id = id + </span><span class="c7">1</span><span class="c1">;<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// ad&#259;ug&#259;m utilizatorul &icirc;n
                        array</span><span class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;users.push(user);<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify(user));<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;</span><span
                        class="c0">catch</span><span class="c1">(error){<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;response.writeHead(</span><span class="c7">400</span><span class="c1">, { </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify({
                        message: </span><span class="c3">&quot;Cerere incorect&#259;&quot;</span><span
                        class="c1">&nbsp;}));<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">Deoarece la executarea func&#539;iei promisiunea poate transmite o eroare (de
            exemplu, &icirc;n rezultatul analizei &icirc;n JSON), &icirc;nv&#259;luim &icirc;ntregul cod &icirc;n
        </span><span class="c6">try..catch</span><span class="c2">. Dup&#259; ob&#539;inerea datelor, trebuie s&#259;
            cre&#259;m un nou obiect &#537;i s&#259;-l ad&#259;ug&#259;m &icirc;n array-ul de obiecte.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">Dac&#259; aplica&#539;iei i se trimite o cerere PUT, atunci de asemenea, cu ajutorul
            func&#539;iei </span><span class="c6">getReqData</span><span class="c2">, ob&#539;inem datele trimise de
            client. Dac&#259; obiectul este g&#259;sit &icirc;n array, &icirc;l modific&#259;m, altfel trimitem codul de
            stare 404:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.aea442b337d1f9b2cd1e5bece72ddb8a7b2792d3"></a><a id="t.7"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">else</span><span class="c1">&nbsp;</span><span class="c0">if</span><span
                        class="c1">&nbsp;(request.url === </span><span class="c3">&quot;/api/users&quot;</span><span
                        class="c1">&nbsp;&#537;i request.method === </span><span class="c3">&quot;PUT&quot;</span><span
                        class="c1">) {<br> &nbsp; &nbsp;</span><span class="c0">try</span><span class="c1">{<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;userData =
                    </span><span class="c0">await</span><span class="c1">&nbsp;getReqData(request);<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c5">// ob&#539;inem utilizatorul dup&#259; id</span><span
                        class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">const</span><span
                        class="c1">&nbsp;user = users.find((u) =&gt; u.id === </span><span
                        class="c4">parseInt</span><span class="c1">(userData.id));<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c5">// dac&#259; utilizatorul este g&#259;sit, &icirc;i modific&#259;m
                        datele &#537;i &icirc;l trimitem &icirc;napoi clientului</span><span class="c1"><br> &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c0">if</span><span class="c1">(user) {<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;user.age = userData.age;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;user.name = userData.name;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;response.end(</span><span class="c4">JSON</span><span class="c1">.stringify(user));<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c5">// dac&#259;
                        nu este g&#259;sit, trimitem codul de stare &#537;i mesajul de eroare</span><span
                        class="c1"><br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c0">else</span><span
                        class="c1">{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;response.writeHead(</span><span
                        class="c7">404</span><span class="c1">, { </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify({ message: </span><span class="c3">&quot;Utilizatorul nu a fost
                        g&#259;sit&quot;</span><span class="c1">&nbsp;}));<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp;
                        &nbsp;}<br> &nbsp; &nbsp;</span><span class="c0">catch</span><span class="c1">(error){<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;response.writeHead(</span><span class="c7">400</span><span
                        class="c1">, { </span><span class="c3">&quot;Content-Type&quot;</span><span class="c1">:
                    </span><span class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;});<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;response.end(</span><span class="c4">JSON</span><span
                        class="c1">.stringify({ message: </span><span class="c3">&quot;Cerere
                        incorect&#259;&quot;</span><span class="c1">&nbsp;}));<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Astfel, am definit cea mai simpl&#259; API. Acum s&#259; ad&#259;ug&#259;m codul
            clientului.</span></p>
    <p class="c8"><span class="c23"></span></p>
    <p class="c9"><span class="c15">Definirea clientului.</span></p>
    <p class="c8"><span class="c11"></span></p>
    <p class="c9"><span class="c13">C&acirc;nd se acceseaz&#259; r&#259;d&#259;cina aplica&#539;iei web sau la adresa
            &quot;/index.html&quot;, serverul va returna fi&#537;ierul index.html. Prin urmare, &icirc;n aceea&#537;i
            folder&#259; cu fi&#537;ierul serverului, definim fi&#537;ierul </span><span
            class="c18">index.html</span><span class="c2">&nbsp;cu urm&#259;torul cod:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.c8499928020b29eaf0fe6383beac7f47c51a2a92"></a><a id="t.8"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c1">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br> &nbsp;
                        &nbsp;&lt;meta charset=&quot;utf-8&quot; /&gt;<br> &nbsp; &nbsp;&lt;meta
                        name=&quot;viewport&quot; content=&quot;width=device-width&quot; /&gt;<br> &nbsp;
                        &nbsp;&lt;title&gt;FDC.COM&lt;/title&gt;<br> &nbsp; &nbsp;&lt;style&gt;<br> &nbsp;
                        &nbsp;tr{height:30px;}<br> &nbsp; &nbsp;td, th {min-width: 40px;text-align: left;}<br> &nbsp;
                        &nbsp;a {cursor:pointer; padding:5px;text-decoration: underline;color:navy;}<br> &nbsp;
                        &nbsp;input{width:180px;}<br> &nbsp; &nbsp;&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>
                        &nbsp; &nbsp;&lt;h2&gt;Lista utilizatorilor&lt;/h2&gt;<br> &nbsp; &nbsp;&lt;form
                        name=&quot;userForm&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p&gt;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;&lt;label for=&quot;name&quot;&gt;Nume:&lt;/label&gt;&lt;br&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input name=&quot;name&quot; /&gt;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;&lt;label for=&quot;age&quot;&gt;V&acirc;rst&#259;:&lt;/label&gt;&lt;br&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input name=&quot;age&quot; type=&quot;number&quot;
                        min=&quot;1&quot; max=&quot;110&quot; /&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/p&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;&lt;p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button
                        type=&quot;submit&quot;&gt;Salveaz&#259;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;&lt;button type=&quot;reset&quot;&gt;Reseteaz&#259;&lt;/button&gt;<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;&lt;/p&gt;<br> &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp;&lt;table&gt;<br> &nbsp;
                        &nbsp; &nbsp;
                        &nbsp;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Id&lt;/th&gt;&lt;th&gt;Nume&lt;/th&gt;&lt;th&gt;V&acirc;rst&#259;&lt;/th&gt;&lt;th&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;&lt;tbody&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/tbody&gt;<br>
                        &nbsp; &nbsp;&lt;/table&gt;<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;&lt;script&gt;<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;let userId = 0; &nbsp; &nbsp; // identificatorul utilizatorului care este
                        editat<br> &nbsp; &nbsp; &nbsp; &nbsp;const userForm = document.forms[&quot;userForm&quot;];
                        &nbsp; &nbsp;// formularul de introducere<br> &nbsp; &nbsp; &nbsp; &nbsp;// Ob&#539;inerea
                        tuturor utilizatorilor<br> &nbsp; &nbsp; &nbsp; &nbsp;async function getUsers() {<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// trimite cererea &#537;i prime&#537;te r&#259;spunsul<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const response = await fetch(&quot;/api/users&quot;,
                        {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;method: &quot;GET&quot;,<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;headers: { &quot;Accept&quot;:
                        &quot;application/json&quot; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// dac&#259; cererea a trecut normal<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;if (response.ok === true) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;// prime&#537;te datele<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;const users = await response.json();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;const rows = document.querySelector(&quot;tbody&quot;); <br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;// adaug&#259; elementele primite &icirc;n tabel<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;users.forEach(user =&gt; rows.append(row(user)));<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;// Ob&#539;inerea unui singur utilizator<br> &nbsp; &nbsp; &nbsp; &nbsp;async
                        function getUser(id) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const response = await
                        fetch(&quot;/api/users/&quot; + id, {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;method: &quot;GET&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;headers: { &quot;Accept&quot;: &quot;application/json&quot; }<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (response.ok === true)
                        {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const user = await
                        response.json();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userId =
                        user.id;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;userForm.elements[&quot;name&quot;].value = user.name;<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;userForm.elements[&quot;age&quot;].value = user.age;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;// Ad&#259;ugarea unui utilizator<br> &nbsp; &nbsp; &nbsp; &nbsp;async function
                        createUser(userName, userAge) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const response =
                        await fetch(&quot;api/users&quot;, {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;method: &quot;POST&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;headers: { &quot;Accept&quot;: &quot;application/json&quot;, &quot;Content-Type&quot;:
                        &quot;application/json&quot; },<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;body:
                        JSON.stringify({<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name:
                        userName,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;age:
                        parseInt(userAge, 10)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;})<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if
                        (response.ok === true) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const user =
                        await response.json();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;reset();<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;document.querySelector(&quot;tbody&quot;).append(row(user));<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;//
                        Modificarea unui utilizator<br> &nbsp; &nbsp; &nbsp; &nbsp;async function editUser(userId,
                        userName, userAge) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const response = await
                        fetch(&quot;api/users&quot;, {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;method: &quot;PUT&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;headers: { &quot;Accept&quot;: &quot;application/json&quot;, &quot;Content-Type&quot;:
                        &quot;application/json&quot; },<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;body:
                        JSON.stringify({<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;id:
                        userId,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name:
                        userName,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;age:
                        parseInt(userAge, 10)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;})<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if
                        (response.ok === true) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const user =
                        await response.json();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;reset();<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;document.querySelector(&quot;tr[data-rowid=&#39;&quot; + user.id +
                        &quot;&#39;]&quot;).replaceWith(row(user));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br>
                        &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;// &#536;tergerea unui
                        utilizator<br> &nbsp; &nbsp; &nbsp; &nbsp;async function deleteUser(id) {<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;const response = await fetch(&quot;/api/users/&quot; + id, {<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;method: &quot;DELETE&quot;,<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;headers: { &quot;Accept&quot;:
                        &quot;application/json&quot; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (response.ok === true) {<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;const user = await response.json();<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;document.querySelector(&quot;tr[data-rowid=&#39;&quot; + user.id +
                        &quot;&#39;]&quot;).remove();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;}<br> &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp;// resetarea formularului &#537;i a
                        identificatorului curent al<br><br> utilizatorului<br> &nbsp; &nbsp; &nbsp; &nbsp;function
                        reset() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userForm.reset();<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;userId = 0;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;// crearea unui r&acirc;nd pentru tabel<br> &nbsp; &nbsp; &nbsp; &nbsp;function row(user)
                        {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const tr =
                        document.createElement(&quot;tr&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;tr.setAttribute(&quot;data-rowid&quot;, user.id);<br> &nbsp; <br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;const idTd = document.createElement(&quot;td&quot;);<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;idTd.append(user.id);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;tr.append(idTd);<br> &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const nameTd =
                        document.createElement(&quot;td&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;nameTd.append(user.name);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;tr.append(nameTd);<br> &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const ageTd =
                        document.createElement(&quot;td&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;ageTd.append(user.age);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tr.append(ageTd);<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;const linksTd = document.createElement(&quot;td&quot;);<br> &nbsp; <br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;const editLink = document.createElement(&quot;a&quot;);<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;editLink.setAttribute(&quot;data-id&quot;, user.id);<br>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;editLink.append(&quot;Modific&#259;&quot;);<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;editLink.addEventListener(&quot;click&quot;, async e =&gt;
                        {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.preventDefault();<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await getUser(user.id);<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;linksTd.append(editLink);<br> &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const
                        removeLink = document.createElement(&quot;a&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;removeLink.setAttribute(&quot;data-id&quot;, user.id);<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;removeLink.append(&quot;&#536;terge&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;removeLink.addEventListener(&quot;click&quot;, async e =&gt; {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;await deleteUser(user.id);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;});<br> &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;linksTd.append(removeLink);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;tr.appendChild(linksTd);<br> &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return
                        tr;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;// resetarea valorilor
                        formularului<br> &nbsp; &nbsp; &nbsp; &nbsp;userForm.addEventListener(&quot;reset&quot;, e =&gt;
                        reset());<br> &nbsp; <br> &nbsp; &nbsp; &nbsp; &nbsp;// trimiterea formularului<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;userForm.addEventListener(&quot;submit&quot;, e =&gt; {<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;e.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;const name = userForm.elements[&quot;name&quot;].value;<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;const age = userForm.elements[&quot;age&quot;].value;<br> <br> &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;if (userId === 0) createUser(name, age);<br> &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp;else editUser(userId, name, age);<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp;
                        <br> &nbsp; &nbsp; &nbsp; &nbsp;// &icirc;nc&#259;rcarea utilizatorilor<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;getUsers();<br> &nbsp; &nbsp;&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Logica principal&#259; este &icirc;ncapsulat&#259; &icirc;n codul JavaScript. La
            &icirc;nceput, sunt definite datele globale:</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">- Identificatorul utilizatorului care este editat </span><span class="c18">(userId =
            0</span><span class="c2">).</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">- Formularul de introducere (</span><span class="c18">const userForm =
            document.forms[&quot;userForm&quot;]</span><span class="c2">).</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Constanta userForm reprezint&#259; formularul pentru ad&#259;ugarea sau editarea unui
            obiect. Cu ajutorul variabilei userId urm&#259;rim identificatorul utilizatorului &icirc;nc&#259;rcat.
            Dac&#259; este egal cu 0, atunci utilizatorul este creat. La &icirc;nc&#259;rcarea paginii, aceast&#259;
            variabil&#259; este 0, deoarece niciun utilizator nu este &icirc;nc&#259;rcat pe formular. Dac&#259; userId
            nu este egal cu 0, atunci utilizatorul a fost anterior &icirc;nc&#259;rcat cu ajutorul func&#539;iei
            getUser, &#537;i inten&#539;ion&#259;m s&#259; edit&#259;m acest utilizator.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">La &icirc;nc&#259;rcarea paginii &icirc;n browser, ob&#539;inem toate obiectele din
            baza de date cu ajutorul func&#539;iei getUsers, folosind cereri la serverul nostru prin API pentru a
            interac&#539;iona cu datele utilizatorilor.</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.ba9f8979d81799a1c62e8aa961448a7702866b04"></a><a id="t.9"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">async</span><span class="c1">&nbsp;</span><span
                        class="c0">function</span><span class="c1">&nbsp;</span><span class="c4">getUser</span><span
                        class="c1">(id) {<br> &nbsp; &nbsp;</span><span class="c0">const</span><span
                        class="c1">&nbsp;response = </span><span class="c0">await</span><span
                        class="c1">&nbsp;fetch(</span><span class="c3">&quot;/api/users/&quot;</span><span
                        class="c1">&nbsp;+ id, {<br> &nbsp; &nbsp; &nbsp; &nbsp;method: </span><span
                        class="c3">&quot;GET&quot;</span><span class="c1">,<br> &nbsp; &nbsp; &nbsp; &nbsp;headers: {
                    </span><span class="c3">&quot;Accept&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;}<br> &nbsp; &nbsp;});<br>
                        &nbsp; &nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;(response.ok ===
                    </span><span class="c0">true</span><span class="c1">) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;user = </span><span class="c0">await</span><span
                        class="c1">&nbsp;response.json();<br> &nbsp; &nbsp; &nbsp; &nbsp;userId = user.id;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp;userForm.elements[</span><span class="c3">&quot;name&quot;</span><span
                        class="c1">].value = user.name;<br> &nbsp; &nbsp; &nbsp; &nbsp;userForm.elements[</span><span
                        class="c3">&quot;age&quot;</span><span class="c1">].value = user.age;<br> &nbsp;
                        &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">Pentru a ad&#259;uga r&acirc;nduri &icirc;n tabel se folose&#537;te func&#539;ia
        </span><span class="c6">row()</span><span class="c2">, care returneaz&#259; un r&acirc;nd. &Icirc;n acest
            r&acirc;nd vor fi definite linkuri pentru modificarea &#537;i &#537;tergerea utilizatorului.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">Linkul pentru modificarea utilizatorului cu ajutorul func&#539;iei</span><span
            class="c6">&nbsp;getUser()</span><span class="c2">&nbsp;,ob&#539;ine de pe server utilizatorul
            selectat:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.19d77a2649ad838cd9db59c2b989300e9e75009c"></a><a id="t.10"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">async</span><span class="c1">&nbsp;</span><span
                        class="c0">function</span><span class="c1">&nbsp;</span><span class="c4">createUser</span><span
                        class="c1">(userName, userAge) {<br> &nbsp; &nbsp;</span><span class="c0">const</span><span
                        class="c1">&nbsp;response = </span><span class="c0">await</span><span
                        class="c1">&nbsp;fetch(</span><span class="c3">&quot;api/users&quot;</span><span class="c1">,
                        {<br> &nbsp; &nbsp; &nbsp; &nbsp;method: </span><span class="c3">&quot;POST&quot;</span><span
                        class="c1">,<br> &nbsp; &nbsp; &nbsp; &nbsp;headers: { </span><span
                        class="c3">&quot;Accept&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">, </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;},<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;body: </span><span class="c4">JSON</span><span class="c1">.stringify({<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;name: userName,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;age:
                    </span><span class="c4">parseInt</span><span class="c1">(userAge, </span><span
                        class="c7">10</span><span class="c1">)<br> &nbsp; &nbsp; &nbsp; &nbsp;})<br> &nbsp;
                        &nbsp;});<br> &nbsp; &nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;(response.ok
                        === </span><span class="c0">true</span><span class="c1">) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;user = </span><span
                        class="c0">await</span><span class="c1">&nbsp;response.json();<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;reset();<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">document</span><span
                        class="c1">.querySelector(</span><span class="c3">&quot;tbody&quot;</span><span
                        class="c1">).append(row(user));<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">&#536;i utilizatorul selectat este ad&#259;ugat &icirc;n formularul de deasupra
            tabelului.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">Dac&#259; </span><span class="c6">userId </span><span class="c2">este egal cu 0,
            atunci se execut&#259; func&#539;ia createUser, care trimite datele &icirc;ntr-o cerere POST:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.19d77a2649ad838cd9db59c2b989300e9e75009c"></a><a id="t.11"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">async</span><span class="c1">&nbsp;</span><span
                        class="c0">function</span><span class="c1">&nbsp;</span><span class="c4">createUser</span><span
                        class="c1">(userName, userAge) {<br> &nbsp; &nbsp;</span><span class="c0">const</span><span
                        class="c1">&nbsp;response = </span><span class="c0">await</span><span
                        class="c1">&nbsp;fetch(</span><span class="c3">&quot;api/users&quot;</span><span class="c1">,
                        {<br> &nbsp; &nbsp; &nbsp; &nbsp;method: </span><span class="c3">&quot;POST&quot;</span><span
                        class="c1">,<br> &nbsp; &nbsp; &nbsp; &nbsp;headers: { </span><span
                        class="c3">&quot;Accept&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">, </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;},<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;body: </span><span class="c4">JSON</span><span class="c1">.stringify({<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;name: userName,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;age:
                    </span><span class="c4">parseInt</span><span class="c1">(userAge, </span><span
                        class="c7">10</span><span class="c1">)<br> &nbsp; &nbsp; &nbsp; &nbsp;})<br> &nbsp;
                        &nbsp;});<br> &nbsp; &nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;(response.ok
                        === </span><span class="c0">true</span><span class="c1">) {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;</span><span class="c0">const</span><span class="c1">&nbsp;user = </span><span
                        class="c0">await</span><span class="c1">&nbsp;response.json();<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;reset();<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c4">document</span><span
                        class="c1">.querySelector(</span><span class="c3">&quot;tbody&quot;</span><span
                        class="c1">).append(row(user));<br> &nbsp; &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">&Icirc;ns&#259;, dac&#259; anterior utilizatorul a fost &icirc;nc&#259;rcat pe
            formular, &#537;i &icirc;n variabila userId &nbsp;s-a p&#259;strat id-ul s&#259;u, atunci se execut&#259;
            func&#539;ia editUser, care trimite o cerere PUT:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.6c40ee4037574de1394c825b1b1b16385b2146fb"></a><a id="t.12"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c0">async</span><span class="c1">&nbsp;</span><span
                        class="c0">function</span><span class="c1">&nbsp;</span><span class="c4">editUser</span><span
                        class="c1">(userId, userName, userAge) {<br> &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;response = </span><span
                        class="c0">await</span><span class="c1">&nbsp;fetch(</span><span
                        class="c3">&quot;api/users&quot;</span><span class="c1">, {<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;method: </span><span class="c3">&quot;PUT&quot;</span><span class="c1">,<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;headers: { </span><span class="c3">&quot;Accept&quot;</span><span class="c1">:
                    </span><span class="c3">&quot;application/json&quot;</span><span class="c1">, </span><span
                        class="c3">&quot;Content-Type&quot;</span><span class="c1">: </span><span
                        class="c3">&quot;application/json&quot;</span><span class="c1">&nbsp;},<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;body: </span><span class="c4">JSON</span><span class="c1">.stringify({<br> &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp;id: userId,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name:
                        userName,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;age: </span><span
                        class="c4">parseInt</span><span class="c1">(userAge, </span><span class="c7">10</span><span
                        class="c1">)<br> &nbsp; &nbsp; &nbsp; &nbsp;})<br> &nbsp; &nbsp;});<br> &nbsp;
                        &nbsp;</span><span class="c0">if</span><span class="c1">&nbsp;(response.ok === </span><span
                        class="c0">true</span><span class="c1">) {<br> &nbsp; &nbsp; &nbsp; &nbsp;</span><span
                        class="c0">const</span><span class="c1">&nbsp;user = </span><span class="c0">await</span><span
                        class="c1">&nbsp;response.json();<br> &nbsp; &nbsp; &nbsp; &nbsp;reset();<br> &nbsp; &nbsp;
                        &nbsp; &nbsp;</span><span class="c4">document</span><span class="c1">.querySelector(</span><span
                        class="c3">&quot;tr[data-rowid=&#39;&quot;</span><span class="c1">&nbsp;+ user.id + </span><span
                        class="c3">&quot;&#39;]&quot;</span><span class="c1">).replaceWith(row(user));<br> &nbsp;
                        &nbsp;}<br>}</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c13">La final, vom lansa fi&#537;ierul server</span><span
            class="c18">&nbsp;server.js</span><span class="c2">&nbsp;cu comanda:</span></p>
    <p class="c8"><span class="c2"></span></p><a id="t.345208260810c584ceb64a3931bd385c5e67beff"></a><a id="t.13"></a>
    <table class="c10">
        <tr class="c16">
            <td class="c14" colspan="1" rowspan="1">
                <p class="c17"><span class="c1">node server.js</span></p>
            </td>
        </tr>
    </table>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 510.00px; height: 66.00px;"><img
                alt="" src="images/image1.png"
                style="width: 510.00px; height: 66.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span class="c2">Acces&#259;m &icirc;n browser adresa &quot;http://localhost:3000&quot; &#537;i vom
            putea gestiona utilizatorii care sunt stoca&#539;i &icirc;n fi&#537;ierul json.</span></p>
    <p class="c8"><span class="c2"></span></p>
    <p class="c9"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 463.00px; height: 565.00px;"><img
                alt="" src="images/image2.png"
                style="width: 463.00px; height: 565.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
</body>

</html>