<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c13 doc-content">
    <h1 class="c0 c14 c26">Web API Adăugătoare. </h1>
    <p class="c0 c10"><span class="c14 c12"></span></p>
    <p class="c0"><span class="c19">API de Geolocalizare.</span></p>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c18">Cu ajutorul </span><span class="c12">API-ului de Geolocalizare</span><span
            class="c18">&nbsp;putem ob&#539;ine &icirc;n codul JavaScript date despre pozi&#539;ia geografic&#259; a
            utilizatorului. Pentru a lucra cu API-ul de Geolocalizare, obiectul </span><span class="c9">navigator
        </span><span class="c18">define&#537;te proprietatea </span><span class="c12">geolocation</span><span
            class="c18">, care reprezint&#259; tipul </span><span class="c12">Geolocation</span><span class="c18">.
            Pentru a ob&#539;ine pozi&#539;ia, la obiectul Geolocation se aplic&#259; metoda </span><span
            class="c12">getCurrentPosition()</span><span class="c4">:</span></p>
    <p class="c0 c10"><span class="c4"></span></p><a id="t.527d5e16f6450cd0fae67351e957cdab145c4bc7"></a><a
        id="t.0"></a>
    <table class="c15">
        <tr class="c8">
            <td class="c23" colspan="1" rowspan="1">
                <p class="c24"><span class="c2">getCurrentPosition(success)<br>getCurrentPosition(success,
                        error)<br>getCurrentPosition(success, error, options)</span></p>
            </td>
        </tr>
    </table>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c4">Metoda poate accepta p&acirc;n&#259; la trei parametri:</span></p>
    <p class="c0 c10"><span class="c4"></span></p>
    <ul class="c16 lst-kix_rlgz8u59om7o-0 start">
        <li class="c0 c5 li-bullet-0"><span class="c9">succes</span><span class="c4">: func&#539;ia care este
                apelat&#259; la determinarea cu succes a coordonatelor utilizatorului</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_rlgz8u59om7o-0">
        <li class="c0 c5 li-bullet-0"><span class="c9">eroare</span><span class="c4">: func&#539;ia care este
                apelat&#259; &icirc;n cazul apari&#539;iei unei erori</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_rlgz8u59om7o-0">
        <li class="c0 c5 li-bullet-0"><span class="c9">op&#539;iuni</span><span class="c4">: parametri suplimentari de
                configurare</span></li>
    </ul>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c18">Deoarece pozi&#539;ia este determinat&#259; asincron, ca prim parametru </span><span
            class="c9">succes </span><span class="c18">&icirc;n metoda este transmis&#259; o func&#539;ie de callback,
            care este apelat&#259; de &icirc;ndat&#259; ce pozi&#539;ia este determinat&#259; cu </span><span
            class="c18">succes</span><span class="c18">. Ca parametru &icirc;n aceast&#259; func&#539;ie de callback
            este transmis obiectul </span><span class="c12">GeolocationPosition</span><span class="c18">. Proprietatea
            sa </span><span class="c9">coords </span><span class="c18">reprezint&#259; tipul </span><span
            class="c9">GeolocationCoordinates</span><span class="c4">, propriet&#259;&#539;ile c&#259;ruia de fapt
            stocheaz&#259; coordonatele utilizatorului:</span></p>
    <p class="c0 c10"><span class="c4"></span></p>
    <ul class="c16 lst-kix_slsc2b9kxc4i-0 start">
        <li class="c0 c5 li-bullet-0"><span class="c9">latitude</span><span class="c4">: latitudine
                geografic&#259;</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_slsc2b9kxc4i-0">
        <li class="c0 c5 li-bullet-0"><span class="c9">longitude</span><span class="c4">: longitudine
                geografic&#259;</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_slsc2b9kxc4i-0">
        <li class="c0 c5 li-bullet-0"><span class="c9">altitude</span><span class="c4">: altitudine deasupra nivelului
                m&#259;rii &icirc;n metri</span></li>
        <li class="c0 c5 c10 li-bullet-0"><span class="c4"></span></li>
        <li class="c0 c5 li-bullet-0"><span class="c9">speed</span><span class="c4">: viteza cu care se deplaseaz&#259;
                utilizatorul (de exemplu, dac&#259; merge pe jos sau se deplaseaz&#259; cu transportul)</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_slsc2b9kxc4i-0">
        <li class="c0 c5 li-bullet-0"><span class="c9">accuracy</span><span class="c4">: acurate&#539;ea
                determin&#259;rii latitudinii &#537;i longitudinii &icirc;n metri</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_slsc2b9kxc4i-0">
        <li class="c0 c5 li-bullet-0"><span class="c9">altitudeAccuracy</span><span class="c4">: acurate&#539;ea
                determin&#259;rii altitudinii deasupra nivelului m&#259;rii &icirc;n metri</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_slsc2b9kxc4i-0">
        <li class="c0 c5 li-bullet-0"><span class="c9">heading</span><span class="c4">: direc&#539;ia &icirc;n care este
                orientat dispozitivul utilizatorului. 0 grade corespunde nordului, iar direc&#539;ia este
                determinat&#259; &icirc;n sensul acelor de ceasornic (aceasta &icirc;nseamn&#259; c&#259; estul este
                egal cu 90 de grade, iar vestul - 270 de grade). Dac&#259; viteza (proprietatea speed) este egal&#259;
                cu 0, aceast&#259; proprietate este egal&#259; cu NaN. Dac&#259; dispozitivul nu poate furniza
                informa&#539;ii despre direc&#539;ie, aceast&#259; proprietate este egal&#259; cu zero.</span></li>
    </ul>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c4">De exemplu, s&#259; ob&#539;inem datele geografice ale utilizatorului:</span></p>
    <p class="c0 c10"><span class="c4"></span></p><a id="t.538b3863d3b449c700fc770ef5633ad60843d7e7"></a><a
        id="t.1"></a>
    <table class="c15">
        <tr class="c8">
            <td class="c23" colspan="1" rowspan="1">
                <p class="c24"><span class="c18 c25">function</span><span class="c2">&nbsp;</span><span
                        class="c18 c21">success</span><span class="c2">(position) {<br> &nbsp; &nbsp;</span><span
                        class="c18 c21">console</span><span class="c2">.log(</span><span class="c3">&quot;Latitudine:
                        &quot;</span><span class="c2">, position.coords.latitude);<br> &nbsp; &nbsp;</span><span
                        class="c18 c21">console</span><span class="c2">.log(</span><span class="c3">&quot;Longitudine:
                        &quot;</span><span class="c2">, position.coords.longitude);<br> &nbsp; &nbsp;</span><span
                        class="c18 c21">console</span><span class="c2">.log(</span><span class="c3">&quot;Altitudine:
                        &quot;</span><span class="c2">, position.coords.altitude);<br> &nbsp; &nbsp;</span><span
                        class="c18 c21">console</span><span class="c2">.log(</span><span class="c3">&quot;Viteza de
                        deplasare: &quot;</span><span class="c2">, position.coords.speed);<br> &nbsp; &nbsp;</span><span
                        class="c18 c21">console</span><span class="c2">.log(</span><span
                        class="c3">&quot;Acurate&#539;e: &quot;</span><span class="c2">, position.coords.accuracy);<br>
                        &nbsp; &nbsp;</span><span class="c18 c21">console</span><span class="c2">.log(</span><span
                        class="c3">&quot;Direc&#539;ie: &quot;</span><span class="c2">,
                        position.coords.heading);<br>};<br>navigator.geolocation.getCurrentPosition(success);</span></p>
            </td>
        </tr>
    </table>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c18">Trebuie s&#259; lu&#259;m &icirc;n considerare c&#259;, &icirc;n browsere,
            exist&#259; o politic&#259; de securitate care, atunci c&acirc;nd se apeleaz&#259; metoda</span><span
            class="c9">&nbsp;geolocation.getCurrentPosition()</span><span class="c4">, afi&#537;eaz&#259; un mesaj
            utilizatorului, &icirc;n care acesta poate confirma trimiterea coordonatelor geografice.</span></p>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 611.00px; height: 332.00px;"><img
                alt="" src="images/image1.png"
                style="width: 611.00px; height: 332.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c11">Ob&#539;inerea informa&#539;iilor despre eroare.</span></p>
    <p class="c0 c10"><span class="c14 c12"></span></p>
    <p class="c0"><span class="c18">Dar dac&#259; utilizatorul refuz&#259; s&#259; ofere acces la datele geografice
            &icirc;n browser, va fi activat&#259; func&#539;ia de eroare, care este transmis&#259; ca al doilea
            parametru. Aceast&#259; func&#539;ie prime&#537;te informa&#539;ii despre eroare sub forma unui obiect
            GeolocationPositionError. Prin proprietatea </span><span class="c9">message </span><span class="c18">se
            poate ob&#539;ine mesajul de eroare. &Icirc;n plus, prin proprietatea </span><span class="c9">code
        </span><span class="c4">se poate ob&#539;ine codul erorii, care poate avea urm&#259;toarele valori:</span></p>
    <p class="c0 c10"><span class="c4"></span></p>
    <ul class="c16 lst-kix_dd8cnx5yn0xp-0 start">
        <li class="c0 c5 li-bullet-0"><span class="c4">1 (PERMISSION_DENIED): lipsesc permisiunile pentru ob&#539;inerea
                datelor geografice</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_dd8cnx5yn0xp-0">
        <li class="c0 c5 li-bullet-0"><span class="c4">2 (POSITION_UNAVAILABLE): nu s-a putut stabili
                pozi&#539;ia</span></li>
    </ul>
    <p class="c0 c10 c20"><span class="c4"></span></p>
    <ul class="c16 lst-kix_dd8cnx5yn0xp-0">
        <li class="c0 c5 li-bullet-0"><span class="c4">3 (TIMEOUT): timpul permis a expirat &icirc;nainte de
                ob&#539;inerea pozi&#539;iei utilizatorului</span></li>
    </ul>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c4">Aplic&#259;m handlerul de eroare:</span></p>
    <p class="c0 c10"><span class="c4"></span></p><a id="t.8e53015d3c36e697a0d2546c8d143d1bec083b5e"></a><a
        id="t.2"></a>
    <table class="c15">
        <tr class="c8">
            <td class="c23" colspan="1" rowspan="1">
                <p class="c24"><span class="c18 c25">function</span><span class="c2">&nbsp;</span><span
                        class="c18 c21">successHandler</span><span class="c2">(position) {<br> &nbsp; &nbsp;</span><span
                        class="c18 c21">console</span><span class="c2">.log(</span><span class="c3">&quot;Latitudine:
                        &quot;</span><span class="c2">, position.coords.latitude);<br> &nbsp; &nbsp;</span><span
                        class="c18 c21">console</span><span class="c2">.log(</span><span class="c3">&quot;Longitudine:
                        &quot;</span><span class="c2">, position.coords.longitude);<br>};<br></span><span
                        class="c18 c25">function</span><span class="c2">&nbsp;</span><span
                        class="c18 c21">errorHandler</span><span class="c2">(error) { &nbsp;<br> &nbsp;
                        &nbsp;</span><span class="c18 c21">console</span><span class="c2">.log(error.message); &nbsp;
                        &nbsp;</span><span class="c18 c22">// afi&#537;&#259;m mesajul de eroare</span><span
                        class="c2"><br> &nbsp; &nbsp;</span><span class="c18 c21">console</span><span
                        class="c2">.log(error.code); &nbsp; &nbsp;</span><span class="c18 c22">// afi&#537;&#259;m codul
                        erorii</span><span class="c2"><br>}<br>navigator.geolocation.getCurrentPosition(successHandler,
                        errorHandler);</span></p>
            </td>
        </tr>
    </table>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c4">&#536;i &icirc;n cazul &icirc;n care permisiunea pentru ob&#539;inerea datelor
            lipse&#537;te, vom ob&#539;ine urm&#259;torul output &icirc;n consol&#259;:</span></p>
    <p class="c0 c10"><span class="c4"></span></p><a id="t.f92af563ff25373dfc8f67674c962dcd4b593064"></a><a
        id="t.3"></a>
    <table class="c15">
        <tr class="c8">
            <td class="c23" colspan="1" rowspan="1">
                <p class="c24"><span class="c2">User denied Geolocation<br></span><span class="c6">1</span></p>
            </td>
        </tr>
    </table>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c11">Urm&#259;rirea schimb&#259;rii pozi&#539;iei.</span></p>
    <p class="c0 c10"><span class="c14 c12"></span></p>
    <p class="c0"><span class="c18">Metoda</span><span class="c12">&nbsp;watchPosition()</span><span class="c18">&nbsp;a
            obiectului </span><span class="c9">Geolocation </span><span class="c18">permite &icirc;nregistrarea unei
            func&#539;ii-handler, care va fi apelat&#259; automat de fiecare dat&#259; c&acirc;nd se schimb&#259;
            pozi&#539;ia dispozitivului. Aceast&#259; metod&#259; accept&#259; acelea&#537;i parametri ca
            &#537;i</span><span class="c9">&nbsp;getCurrentPosition()</span><span class="c4">:</span></p>
    <p class="c0 c10"><span class="c4"></span></p><a id="t.bd67a62541a7e71d36a8d39b5bf0d40666298021"></a><a
        id="t.4"></a>
    <table class="c15">
        <tr class="c8">
            <td class="c23" colspan="1" rowspan="1">
                <p class="c24"><span class="c2">watchPosition(success)<br>watchPosition(success,
                        error)<br>watchPosition(success, error, options)</span></p>
            </td>
        </tr>
    </table>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0"><span class="c18">Ca rezultat, metoda returneaz&#259; un identificator, care poate fi transmis
            metodei</span><span class="c12">&nbsp;clearWatch()</span><span class="c4">&nbsp;a obiectului Geolocation
            pentru oprirea urm&#259;ririi. De exemplu:</span></p>
    <p class="c0 c10"><span class="c4"></span></p><a id="t.17287917b7c41f646d76561b41f560616d33af9a"></a><a
        id="t.5"></a>
    <table class="c15">
        <tr class="c8">
            <td class="c23" colspan="1" rowspan="1">
                <p class="c24"><span class="c2">&lt;!DOCTYPE html&gt;<br></span><span class="c1">&lt;</span><span
                        class="c7">html</span><span class="c1">&gt;</span><span class="c2"><br></span><span
                        class="c1">&lt;</span><span class="c7">head</span><span class="c1">&gt;</span><span
                        class="c2"><br> &nbsp; &nbsp;</span><span class="c1">&lt;</span><span
                        class="c7">meta</span><span class="c1">&nbsp;charset=</span><span
                        class="c3">&quot;utf-8&quot;</span><span class="c1">&nbsp;/&gt;</span><span class="c2"><br>
                        &nbsp; &nbsp;</span><span class="c1">&lt;</span><span class="c7">title</span><span
                        class="c1">&gt;</span><span class="c2">FDC.COM</span><span class="c1">&lt;/</span><span
                        class="c7">title</span><span class="c1">&gt;</span><span class="c2"><br></span><span
                        class="c1">&lt;/</span><span class="c7">head</span><span class="c1">&gt;</span><span
                        class="c2"><br></span><span class="c1">&lt;</span><span class="c7">body</span><span
                        class="c1">&gt;</span><span class="c2"><br></span><span class="c1">&lt;</span><span
                        class="c7">button</span><span class="c1">&nbsp;id=</span><span
                        class="c3">&quot;btn&quot;</span><span class="c1">&gt;</span><span class="c2">Stop
                        watching</span><span class="c1">&lt;/</span><span class="c7">button</span><span
                        class="c1">&gt;</span><span class="c2"><br></span><span class="c1">&lt;</span><span
                        class="c7">script</span><span class="c1">&gt;</span><span class="c2"><br> <br>function
                        successHandler(position) {<br> &nbsp; &nbsp;console.log(&quot;<br><br>Latitudine: &quot;,
                        position.coords.latitude);<br> &nbsp; &nbsp;console.log(&quot;Longitudine: &quot;,
                        position.coords.longitude);<br>};<br>function errorHandler(error) { &nbsp;<br> &nbsp;
                        &nbsp;console.log(error.message);<br>}<br> <br>const geolocation =
                        navigator.geolocation;<br>const watchID = geolocation.watchPosition(successHandler,
                        errorHandler);<br>// la ap&#259;sarea butonului, oprim urm&#259;rirea
                        pozi&#539;iei<br>document.getElementById(&quot;btn&quot;).addEventListener(&quot;click&quot;,
                        ()=&gt;geolocation.clearWatch(watchID));<br></span><span class="c1">&lt;/</span><span
                        class="c7">script</span><span class="c1">&gt;</span><span class="c2"><br></span><span
                        class="c1">&lt;/</span><span class="c7">body</span><span class="c1">&gt;</span><span
                        class="c2"><br></span><span class="c1">&lt;/</span><span class="c7">html</span><span
                        class="c1">&gt;</span></p>
            </td>
        </tr>
    </table>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0 c10"><span class="c4"></span></p>
    <p class="c0 c10"><span class="c12 c14"></span></p>
</body>

</html>