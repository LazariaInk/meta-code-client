<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="/lessons/styles.css">
</head>

<body class="c18 doc-content">
    <h1 class="c5 c19">Lucrul cu XML. </h1>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c2">Unul dintre formatele populare pentru descrierea datelor este formatul XML. &#536;i
            limbajul JavaScript ofer&#259; unelte pentru lucrul cu XML.</span></p>
    <p class="c0"><span class="c12"></span></p>
    <p class="c5"><span class="c15">Transformarea din &#537;ir &icirc;n XML.</span></p>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c13">Pentru crearea obiectelor XML pe baza unui &#537;ir care con&#539;ine date &icirc;n
            format XML, se folose&#537;te obiectul </span><span class="c14">DOMParser</span><span class="c13">. Metodei
        </span><span class="c14">parseFromString()</span><span class="c13">&nbsp;i se poate transmite &#537;irul
            corespunz&#259;tor ca prim argument &#537;i tipul MIME (de obicei text/xml) ca al doilea argument. Dac&#259;
            &#537;irul transmis con&#539;ine cod XML corect, atunci metoda va returna un obiect de tip </span><span
            class="c14">Document</span><span class="c13">, care va con&#539;ine XML-ul analizat. &#536;i pentru a
            selecta date specifice din documentul XML ob&#539;inut, se pot folosi metodele standard de selectare a
            elementelor DOM, de exemplu,</span><span class="c14">&nbsp;querySelector()</span><span class="c2">.</span>
    </p>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c2">De exemplu, s&#259; lu&#259;m &icirc;n considerare urm&#259;torul program:</span></p>
    <p class="c0"><span class="c2"></span></p><a id="t.ee641ebb52891c11e43dbf5ece7818f0f3de35dc"></a><a id="t.0"></a>
    <table class="c11">
        <tr class="c17">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c8"><span class="c3">const</span><span class="c1">&nbsp;xmlString = </span><span
                        class="c4">`&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; <br> &nbsp;
                        &nbsp;&lt;users&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;user name=&quot;Tom&quot;
                        age=&quot;39&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;company&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;title&gt;Microsoft&lt;/title&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/company&gt;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;&lt;/user&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;user name=&quot;Bob&quot;
                        age=&quot;43&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;company&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;title&gt;Google&lt;/title&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/company&gt;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;&lt;/user&gt;<br> &nbsp; &nbsp;&lt;/users&gt;`</span><span class="c1">;<br>
                        <br></span><span class="c3">const</span><span class="c1">&nbsp;domParser = </span><span
                        class="c3">new</span><span class="c1">&nbsp;DOMParser();<br></span><span
                        class="c3">const</span><span class="c1">&nbsp;xmlDOM = domParser.parseFromString(xmlString,
                    </span><span class="c4">&quot;text/xml&quot;</span><span class="c1">);<br></span><span class="c9">//
                        acces&#259;m primul element user</span><span class="c1"><br></span><span
                        class="c3">const</span><span class="c1">&nbsp;firstUser = xmlDOM.querySelector(</span><span
                        class="c4">&quot;user&quot;</span><span class="c1">);<br></span><span
                        class="c6">console</span><span class="c1">.log(firstUser.getAttribute(</span><span
                        class="c4">&quot;name&quot;</span><span class="c1">)); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c9">// Tom</span><span class="c1"><br></span><span
                        class="c6">console</span><span class="c1">.log(firstUser.getAttribute(</span><span
                        class="c4">&quot;age&quot;</span><span class="c1">)); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c9">// 39</span><span class="c1"><br></span><span
                        class="c6">console</span><span class="c1">.log(firstUser.querySelector(</span><span
                        class="c4">&quot;title&quot;</span><span class="c1">).textContent); &nbsp; &nbsp;</span><span
                        class="c9">// Microsoft</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c13">Aici documentul xml este dat ca &#537;ir xmlString. Dar deocamdat&#259; este doar un
            &#537;ir, nu un document xml. &#536;i pentru parsarea &#537;irului &icirc;n document xml se creeaz&#259;
            obiectul </span><span class="c14">DOMParser </span><span class="c13">&#537;i se execut&#259; metoda sa
        </span><span class="c13 c16">parseFromString()</span><span class="c2">, &icirc;n care se transmite &#537;irul
            nostru:</span></p>
    <p class="c0"><span class="c2"></span></p><a id="t.473d7855e75dbcd5ce5f3b8979d6bec144088482"></a><a id="t.1"></a>
    <table class="c11">
        <tr class="c17">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c8"><span class="c3">const</span><span class="c1">&nbsp;domParser = </span><span
                        class="c3">new</span><span class="c1">&nbsp;DOMParser();<br></span><span
                        class="c3">const</span><span class="c1">&nbsp;xmlDOM = domParser.parseFromString(xmlString,
                    </span><span class="c4">&quot;text/xml&quot;</span><span class="c1">);</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c13">Dup&#259; ce ob&#539;inem documentul xml, select&#259;m primul element user cu
            ajutorul metodei </span><span class="c10">querySelector</span></p>
    <p class="c0"><span class="c2"></span></p><a id="t.aec6d35ffcadd06cfec4825fc8d03e704c20174a"></a><a id="t.2"></a>
    <table class="c11">
        <tr class="c17">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c8"><span class="c3">const</span><span class="c1">&nbsp;firstUser =
                        xmlDOM.querySelector(</span><span class="c4">&quot;user&quot;</span><span class="c1">);</span>
                </p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c2">Apoi putem accesa con&#539;inutul elementului user - la elementele &#537;i atributele
            &icirc;ncorporate</span></p>
    <p class="c0"><span class="c2"></span></p><a id="t.80469f32855a32643ec07ab3c639bd6387fb647b"></a><a id="t.3"></a>
    <table class="c11">
        <tr class="c17">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c8"><span class="c6">console</span><span class="c1">.log(firstUser.getAttribute(</span><span
                        class="c4">&quot;name&quot;</span><span class="c1">)); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c9">// Tom</span><span class="c1"><br></span><span
                        class="c6">console</span><span class="c1">.log(firstUser.getAttribute(</span><span
                        class="c4">&quot;age&quot;</span><span class="c1">)); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp;</span><span class="c9">// 39</span><span class="c1"><br></span><span
                        class="c6">console</span><span class="c1">.log(firstUser.querySelector(</span><span
                        class="c4">&quot;title&quot;</span><span class="c1">).textContent); &nbsp; &nbsp;</span><span
                        class="c9">// Microsoft</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c12"></span></p>
    <p class="c5"><span class="c15">Serializarea documentului xml &icirc;n &#537;ir.</span></p>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c13">Pentru transformarea invers&#259; - din document xml &icirc;n &#537;ir, se
            folose&#537;te obiectul </span><span class="c14">XMLSerializer</span><span class="c13">. Acest obiect
            ofer&#259; metoda </span><span class="c14">serializeToString()</span><span class="c2">, care prime&#537;te
            obiectul XML &#537;i returneaz&#259; obiectul XML sub form&#259; de &#537;ir. De exemplu:</span></p>
    <p class="c0"><span class="c2"></span></p><a id="t.f4b0985efb3eddd5911b2fe3e5fd06842209d0f7"></a><a id="t.4"></a>
    <table class="c11">
        <tr class="c17">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c8"><span class="c3">const</span><span class="c1">&nbsp;xmlString = </span><span
                        class="c4">`&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; <br> &nbsp;
                        &nbsp;&lt;users&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;user name=&quot;Tom&quot;
                        age=&quot;39&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;company&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;title&gt;Microsoft&lt;/title&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/company&gt;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;&lt;/user&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;user name=&quot;Bob&quot;
                        age=&quot;43&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;company&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;title&gt;Google&lt;/title&gt;<br> &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/company&gt;<br> &nbsp; &nbsp; &nbsp;
                        &nbsp;&lt;/user&gt;<br> &nbsp; &nbsp;&lt;/users&gt;`</span><span class="c1">;<br>
                        <br></span><span class="c9">// transform&#259;m &#537;irul &icirc;n XML</span><span
                        class="c1"><br></span><span class="c3">const</span><span class="c1">&nbsp;domParser =
                    </span><span class="c3">new</span><span class="c1">&nbsp;DOMParser();<br></span><span
                        class="c3">const</span><span class="c1">&nbsp;xmlDOM = domParser.parseFromString(xmlString,
                    </span><span class="c4">&quot;text/xml&quot;</span><span class="c1">);<br></span><span class="c9">//
                        transform&#259;m &icirc;napoi din XML &icirc;n &#537;ir</span><span class="c1"><br></span><span
                        class="c3">const</span><span class="c1">&nbsp;xmlSerializer = </span><span
                        class="c3">new</span><span class="c1">&nbsp;XMLSerializer();<br></span><span
                        class="c3">const</span><span class="c1">&nbsp;xmlString2 =
                        xmlSerializer.serializeToString(xmlDOM);<br></span><span class="c6">console</span><span
                        class="c1">.log(xmlString2);</span></p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c2">&Icirc;n final, vom ob&#539;ine &icirc;napoi &#537;irul ini&#539;ial
            xmlString.</span></p>
    <p class="c0"><span class="c2"></span></p>
    <p class="c5"><span class="c2">Deoarece documentul html este de fapt &#537;i el un document xml, putem serializa
            &icirc;n &#537;ir &#537;i o pagin&#259; web sau o parte din ea. De exemplu, transform&#259;m &icirc;n
            &#537;ir pagina web curent&#259;:</span></p>
    <p class="c0"><span class="c2"></span></p><a id="t.ae7abf31b88b9fef5c0cb87c3093c57f8ad60837"></a><a id="t.5"></a>
    <table class="c11">
        <tr class="c17">
            <td class="c7" colspan="1" rowspan="1">
                <p class="c8"><span class="c3">const</span><span class="c1">&nbsp;xmlSerializer = </span><span
                        class="c3">new</span><span class="c1">&nbsp;XMLSerializer();<br></span><span
                        class="c3">const</span><span class="c1">&nbsp;htmlString =
                        xmlSerializer.serializeToString(</span><span class="c6">document</span><span
                        class="c1">);<br></span><span class="c6">console</span><span class="c1">.log(htmlString);</span>
                </p>
            </td>
        </tr>
    </table>
    <p class="c0"><span class="c2"></span></p>
    <p class="c0"><span class="c2"></span></p>
</body>

</html>